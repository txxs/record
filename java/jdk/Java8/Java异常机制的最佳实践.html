<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Record</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/record/mlogo.svg">
    <link rel="manifest" href="/record/manifest.json">
    <meta name="description" content="本博客主要是用来记录系统化的知识，内容部分来自github上的其他开源仓库，如有问题联系sdlyjhm01@sina.com">
    
    <link rel="preload" href="/record/assets/css/0.styles.0d67cf55.css" as="style"><link rel="preload" href="/record/assets/js/app.b3b2136c.js" as="script"><link rel="preload" href="/record/assets/js/2.8ec10a4b.js" as="script"><link rel="preload" href="/record/assets/js/652.20ff4afc.js" as="script"><link rel="preload" href="/record/assets/js/5.82344924.js" as="script"><link rel="prefetch" href="/record/assets/js/10.efbebd86.js"><link rel="prefetch" href="/record/assets/js/100.c7b3a714.js"><link rel="prefetch" href="/record/assets/js/1000.1d314a52.js"><link rel="prefetch" href="/record/assets/js/1001.08570d40.js"><link rel="prefetch" href="/record/assets/js/1002.793b8a8b.js"><link rel="prefetch" href="/record/assets/js/1003.f4769969.js"><link rel="prefetch" href="/record/assets/js/1004.221aeeee.js"><link rel="prefetch" href="/record/assets/js/1005.e6d7709e.js"><link rel="prefetch" href="/record/assets/js/1006.ca5b862e.js"><link rel="prefetch" href="/record/assets/js/1007.ddaee3aa.js"><link rel="prefetch" href="/record/assets/js/1008.37c67948.js"><link rel="prefetch" href="/record/assets/js/1009.553cc901.js"><link rel="prefetch" href="/record/assets/js/101.0c6e5802.js"><link rel="prefetch" href="/record/assets/js/1010.31b61309.js"><link rel="prefetch" href="/record/assets/js/1011.84ca68e7.js"><link rel="prefetch" href="/record/assets/js/1012.486bf049.js"><link rel="prefetch" href="/record/assets/js/1013.ae635fa5.js"><link rel="prefetch" href="/record/assets/js/1014.6a39ce57.js"><link rel="prefetch" href="/record/assets/js/1015.1bc2594d.js"><link rel="prefetch" href="/record/assets/js/1016.ac619883.js"><link rel="prefetch" href="/record/assets/js/1017.bb107393.js"><link rel="prefetch" href="/record/assets/js/1018.e2dbdab1.js"><link rel="prefetch" href="/record/assets/js/1019.1d7856e3.js"><link rel="prefetch" href="/record/assets/js/102.6d9387da.js"><link rel="prefetch" href="/record/assets/js/1020.c4c0e091.js"><link rel="prefetch" href="/record/assets/js/1021.2c8b92a5.js"><link rel="prefetch" href="/record/assets/js/1022.44cea5d1.js"><link rel="prefetch" href="/record/assets/js/1023.c39a516e.js"><link rel="prefetch" href="/record/assets/js/1024.d2f5200c.js"><link rel="prefetch" href="/record/assets/js/1025.f0a7d60c.js"><link rel="prefetch" href="/record/assets/js/1026.34a6a9aa.js"><link rel="prefetch" href="/record/assets/js/1027.295c8458.js"><link rel="prefetch" href="/record/assets/js/1028.f5f2d8c0.js"><link rel="prefetch" href="/record/assets/js/1029.46a99313.js"><link rel="prefetch" href="/record/assets/js/103.e5d8bf9f.js"><link rel="prefetch" href="/record/assets/js/1030.d780e739.js"><link rel="prefetch" href="/record/assets/js/1031.67c29429.js"><link rel="prefetch" href="/record/assets/js/1032.8514912e.js"><link rel="prefetch" href="/record/assets/js/1033.cc23c329.js"><link rel="prefetch" href="/record/assets/js/1034.e189f823.js"><link rel="prefetch" href="/record/assets/js/1035.0770902c.js"><link rel="prefetch" href="/record/assets/js/1036.29dc314c.js"><link rel="prefetch" href="/record/assets/js/1037.8d9109ce.js"><link rel="prefetch" href="/record/assets/js/1038.08c846cf.js"><link rel="prefetch" href="/record/assets/js/1039.070219ff.js"><link rel="prefetch" href="/record/assets/js/104.3ef07e6d.js"><link rel="prefetch" href="/record/assets/js/1040.e111aa34.js"><link rel="prefetch" href="/record/assets/js/1041.102a60d5.js"><link rel="prefetch" href="/record/assets/js/1042.f8fc961d.js"><link rel="prefetch" href="/record/assets/js/1043.78caade1.js"><link rel="prefetch" href="/record/assets/js/1044.1a53b2e5.js"><link rel="prefetch" href="/record/assets/js/1045.e4021045.js"><link rel="prefetch" href="/record/assets/js/1046.5ad56f24.js"><link rel="prefetch" href="/record/assets/js/1047.d0aa6ec7.js"><link rel="prefetch" href="/record/assets/js/1048.8acf0137.js"><link rel="prefetch" href="/record/assets/js/1049.76fca331.js"><link rel="prefetch" href="/record/assets/js/105.c48caa8b.js"><link rel="prefetch" href="/record/assets/js/1050.6e907883.js"><link rel="prefetch" href="/record/assets/js/1051.982f0835.js"><link rel="prefetch" href="/record/assets/js/1052.8ab0b8a7.js"><link rel="prefetch" href="/record/assets/js/1053.ad613194.js"><link rel="prefetch" href="/record/assets/js/1054.5b140ada.js"><link rel="prefetch" href="/record/assets/js/1055.171a6362.js"><link rel="prefetch" href="/record/assets/js/1056.d7d4b0e5.js"><link rel="prefetch" href="/record/assets/js/1057.4c5ae6d6.js"><link rel="prefetch" href="/record/assets/js/1058.d0162539.js"><link rel="prefetch" href="/record/assets/js/1059.b01af535.js"><link rel="prefetch" href="/record/assets/js/106.046c1d44.js"><link rel="prefetch" href="/record/assets/js/1060.d064676c.js"><link rel="prefetch" href="/record/assets/js/1061.faf41acc.js"><link rel="prefetch" href="/record/assets/js/1062.6f067438.js"><link rel="prefetch" href="/record/assets/js/1063.7ee050c6.js"><link rel="prefetch" href="/record/assets/js/1064.1b7663fb.js"><link rel="prefetch" href="/record/assets/js/1065.3cb5da93.js"><link rel="prefetch" href="/record/assets/js/1066.bc2fd7bb.js"><link rel="prefetch" href="/record/assets/js/1067.cd5d2245.js"><link rel="prefetch" href="/record/assets/js/1068.9e691fed.js"><link rel="prefetch" href="/record/assets/js/1069.fcf9f79b.js"><link rel="prefetch" href="/record/assets/js/107.bc5cff9b.js"><link rel="prefetch" href="/record/assets/js/1070.cd0868be.js"><link rel="prefetch" href="/record/assets/js/1071.0975a2cd.js"><link rel="prefetch" href="/record/assets/js/1072.009967ea.js"><link rel="prefetch" href="/record/assets/js/1073.a5c80926.js"><link rel="prefetch" href="/record/assets/js/1074.38269b7e.js"><link rel="prefetch" href="/record/assets/js/1075.b50942d2.js"><link rel="prefetch" href="/record/assets/js/1076.3965f8a4.js"><link rel="prefetch" href="/record/assets/js/1077.b1ea22ee.js"><link rel="prefetch" href="/record/assets/js/1078.f8f46822.js"><link rel="prefetch" href="/record/assets/js/1079.dd2f40de.js"><link rel="prefetch" href="/record/assets/js/108.c3fa6a4e.js"><link rel="prefetch" href="/record/assets/js/1080.00c94c56.js"><link rel="prefetch" href="/record/assets/js/1081.586c3b9a.js"><link rel="prefetch" href="/record/assets/js/1082.ee2c3334.js"><link rel="prefetch" href="/record/assets/js/1083.f9fc91ed.js"><link rel="prefetch" href="/record/assets/js/1084.e3b9dba7.js"><link rel="prefetch" href="/record/assets/js/1085.9fb6f4a5.js"><link rel="prefetch" href="/record/assets/js/1086.84ff1321.js"><link rel="prefetch" href="/record/assets/js/1087.360e9383.js"><link rel="prefetch" href="/record/assets/js/1088.ad71b95a.js"><link rel="prefetch" href="/record/assets/js/1089.38a33c1a.js"><link rel="prefetch" href="/record/assets/js/109.a942a87f.js"><link rel="prefetch" href="/record/assets/js/1090.446e21c5.js"><link rel="prefetch" href="/record/assets/js/1091.91cffea2.js"><link rel="prefetch" href="/record/assets/js/1092.d2ef6d5c.js"><link rel="prefetch" href="/record/assets/js/1093.6c11a6e4.js"><link rel="prefetch" href="/record/assets/js/1094.5202cb5d.js"><link rel="prefetch" href="/record/assets/js/1095.4b021428.js"><link rel="prefetch" href="/record/assets/js/1096.ded9697c.js"><link rel="prefetch" href="/record/assets/js/1097.670b7643.js"><link rel="prefetch" href="/record/assets/js/1098.32367389.js"><link rel="prefetch" href="/record/assets/js/1099.4353f094.js"><link rel="prefetch" href="/record/assets/js/11.05d4bb60.js"><link rel="prefetch" href="/record/assets/js/110.6365ebda.js"><link rel="prefetch" href="/record/assets/js/1100.063accbc.js"><link rel="prefetch" href="/record/assets/js/1101.c3068e45.js"><link rel="prefetch" href="/record/assets/js/1102.60a0c053.js"><link rel="prefetch" href="/record/assets/js/1103.0bf78e69.js"><link rel="prefetch" href="/record/assets/js/1104.09621d8f.js"><link rel="prefetch" href="/record/assets/js/1105.89718e20.js"><link rel="prefetch" href="/record/assets/js/1106.282eea3e.js"><link rel="prefetch" href="/record/assets/js/1107.f3fa65b4.js"><link rel="prefetch" href="/record/assets/js/1108.f0ce515c.js"><link rel="prefetch" href="/record/assets/js/1109.eedd769c.js"><link rel="prefetch" href="/record/assets/js/111.10be776e.js"><link rel="prefetch" href="/record/assets/js/1110.dfe1798f.js"><link rel="prefetch" href="/record/assets/js/1111.79482575.js"><link rel="prefetch" href="/record/assets/js/1112.450018db.js"><link rel="prefetch" href="/record/assets/js/1113.e535445e.js"><link rel="prefetch" href="/record/assets/js/1114.e6c296de.js"><link rel="prefetch" href="/record/assets/js/1115.552a2b49.js"><link rel="prefetch" href="/record/assets/js/1116.bf768edc.js"><link rel="prefetch" href="/record/assets/js/1117.3b33a5e2.js"><link rel="prefetch" href="/record/assets/js/1118.d7b0273d.js"><link rel="prefetch" href="/record/assets/js/1119.7ae0d47b.js"><link rel="prefetch" href="/record/assets/js/112.7114d9b1.js"><link rel="prefetch" href="/record/assets/js/1120.742503be.js"><link rel="prefetch" href="/record/assets/js/1121.82e30ef9.js"><link rel="prefetch" href="/record/assets/js/1122.db055a07.js"><link rel="prefetch" href="/record/assets/js/1123.ba0e5b22.js"><link rel="prefetch" href="/record/assets/js/1124.1b78001d.js"><link rel="prefetch" href="/record/assets/js/1125.03e9aff0.js"><link rel="prefetch" href="/record/assets/js/1126.c4a65f90.js"><link rel="prefetch" href="/record/assets/js/1127.1fb539d5.js"><link rel="prefetch" href="/record/assets/js/1128.be1f08d8.js"><link rel="prefetch" href="/record/assets/js/1129.f18cb22d.js"><link rel="prefetch" href="/record/assets/js/113.c716ea9a.js"><link rel="prefetch" href="/record/assets/js/1130.7581b630.js"><link rel="prefetch" href="/record/assets/js/1131.3a1c77c3.js"><link rel="prefetch" href="/record/assets/js/1132.c6a5eaaa.js"><link rel="prefetch" href="/record/assets/js/1133.c1e0c7ed.js"><link rel="prefetch" href="/record/assets/js/1134.d09230f9.js"><link rel="prefetch" href="/record/assets/js/1135.8e210302.js"><link rel="prefetch" href="/record/assets/js/1136.0953e6f9.js"><link rel="prefetch" href="/record/assets/js/1137.1bdcb9d6.js"><link rel="prefetch" href="/record/assets/js/1138.424ec96a.js"><link rel="prefetch" href="/record/assets/js/1139.4fad722c.js"><link rel="prefetch" href="/record/assets/js/114.1d6c8a8a.js"><link rel="prefetch" href="/record/assets/js/1140.d9d98916.js"><link rel="prefetch" href="/record/assets/js/1141.5bed21f9.js"><link rel="prefetch" href="/record/assets/js/1142.0fd942e7.js"><link rel="prefetch" href="/record/assets/js/1143.f45e2fd3.js"><link rel="prefetch" href="/record/assets/js/1144.23fad44c.js"><link rel="prefetch" href="/record/assets/js/1145.62d2fecf.js"><link rel="prefetch" href="/record/assets/js/1146.5a6a539e.js"><link rel="prefetch" href="/record/assets/js/1147.947147ae.js"><link rel="prefetch" href="/record/assets/js/1148.ea4d4abb.js"><link rel="prefetch" href="/record/assets/js/1149.6452061f.js"><link rel="prefetch" href="/record/assets/js/115.0cb7ebd4.js"><link rel="prefetch" href="/record/assets/js/1150.2a2919a3.js"><link rel="prefetch" href="/record/assets/js/1151.fbcec8e2.js"><link rel="prefetch" href="/record/assets/js/1152.51ba6968.js"><link rel="prefetch" href="/record/assets/js/1153.fd8d5963.js"><link rel="prefetch" href="/record/assets/js/1154.e5ec345e.js"><link rel="prefetch" href="/record/assets/js/1155.609a2c7a.js"><link rel="prefetch" href="/record/assets/js/1156.6783fb51.js"><link rel="prefetch" href="/record/assets/js/1157.1c54328e.js"><link rel="prefetch" href="/record/assets/js/1158.e81c1c11.js"><link rel="prefetch" href="/record/assets/js/1159.03e28b6c.js"><link rel="prefetch" href="/record/assets/js/116.6bce2ecd.js"><link rel="prefetch" href="/record/assets/js/1160.5f92ec35.js"><link rel="prefetch" href="/record/assets/js/1161.8d64dd0e.js"><link rel="prefetch" href="/record/assets/js/1162.1c5c1499.js"><link rel="prefetch" href="/record/assets/js/1163.b2f8e193.js"><link rel="prefetch" href="/record/assets/js/1164.2fed98e9.js"><link rel="prefetch" href="/record/assets/js/1165.0288ad02.js"><link rel="prefetch" href="/record/assets/js/1166.840e7c83.js"><link rel="prefetch" href="/record/assets/js/1167.6ececbb6.js"><link rel="prefetch" href="/record/assets/js/1168.52655d5d.js"><link rel="prefetch" href="/record/assets/js/1169.75f42d1b.js"><link rel="prefetch" href="/record/assets/js/117.3cda02ce.js"><link rel="prefetch" href="/record/assets/js/1170.40410f68.js"><link rel="prefetch" href="/record/assets/js/1171.fb07d5f7.js"><link rel="prefetch" href="/record/assets/js/1172.49e432d4.js"><link rel="prefetch" href="/record/assets/js/1173.40b32309.js"><link rel="prefetch" href="/record/assets/js/1174.34b05137.js"><link rel="prefetch" href="/record/assets/js/1175.8e44aee9.js"><link rel="prefetch" href="/record/assets/js/1176.ba96a2e8.js"><link rel="prefetch" href="/record/assets/js/1177.16e21435.js"><link rel="prefetch" href="/record/assets/js/1178.6fdf810a.js"><link rel="prefetch" href="/record/assets/js/1179.515c1973.js"><link rel="prefetch" href="/record/assets/js/118.675e5c06.js"><link rel="prefetch" href="/record/assets/js/1180.e02a1d06.js"><link rel="prefetch" href="/record/assets/js/1181.a8062226.js"><link rel="prefetch" href="/record/assets/js/1182.800eee9a.js"><link rel="prefetch" href="/record/assets/js/1183.f869c078.js"><link rel="prefetch" href="/record/assets/js/1184.6488a933.js"><link rel="prefetch" href="/record/assets/js/1185.fee4646f.js"><link rel="prefetch" href="/record/assets/js/1186.fb8a55e6.js"><link rel="prefetch" href="/record/assets/js/1187.9b4894f4.js"><link rel="prefetch" href="/record/assets/js/1188.33a1d8d1.js"><link rel="prefetch" href="/record/assets/js/1189.f0a6c994.js"><link rel="prefetch" href="/record/assets/js/119.f432d037.js"><link rel="prefetch" href="/record/assets/js/1190.2e342fe0.js"><link rel="prefetch" href="/record/assets/js/1191.110c3fc7.js"><link rel="prefetch" href="/record/assets/js/1192.21060e9c.js"><link rel="prefetch" href="/record/assets/js/1193.fa03527c.js"><link rel="prefetch" href="/record/assets/js/1194.0147ebba.js"><link rel="prefetch" href="/record/assets/js/1195.f6196778.js"><link rel="prefetch" href="/record/assets/js/1196.c6dba4e3.js"><link rel="prefetch" href="/record/assets/js/1197.610e2fd4.js"><link rel="prefetch" href="/record/assets/js/1198.265a721a.js"><link rel="prefetch" href="/record/assets/js/1199.e3afa959.js"><link rel="prefetch" href="/record/assets/js/12.d0bea4a2.js"><link rel="prefetch" href="/record/assets/js/120.2d06e882.js"><link rel="prefetch" href="/record/assets/js/1200.0fa427f4.js"><link rel="prefetch" href="/record/assets/js/1201.653ba35b.js"><link rel="prefetch" href="/record/assets/js/1202.d70b701f.js"><link rel="prefetch" href="/record/assets/js/1203.8ec214ab.js"><link rel="prefetch" href="/record/assets/js/1204.aaa4512d.js"><link rel="prefetch" href="/record/assets/js/1205.649168af.js"><link rel="prefetch" href="/record/assets/js/1206.793a1ada.js"><link rel="prefetch" href="/record/assets/js/1207.efd080c3.js"><link rel="prefetch" href="/record/assets/js/1208.5e6e2119.js"><link rel="prefetch" href="/record/assets/js/1209.68492d67.js"><link rel="prefetch" href="/record/assets/js/121.ee4ecf5a.js"><link rel="prefetch" href="/record/assets/js/1210.0692db63.js"><link rel="prefetch" href="/record/assets/js/1211.20e5c15c.js"><link rel="prefetch" href="/record/assets/js/1212.9c8de5d7.js"><link rel="prefetch" href="/record/assets/js/1213.5b9e1897.js"><link rel="prefetch" href="/record/assets/js/1214.3b971896.js"><link rel="prefetch" href="/record/assets/js/1215.4017cd35.js"><link rel="prefetch" href="/record/assets/js/1216.e2abee07.js"><link rel="prefetch" href="/record/assets/js/1217.814809dd.js"><link rel="prefetch" href="/record/assets/js/1218.dc7966b3.js"><link rel="prefetch" href="/record/assets/js/1219.91520ea8.js"><link rel="prefetch" href="/record/assets/js/122.48e8ea50.js"><link rel="prefetch" href="/record/assets/js/1220.4cd4d209.js"><link rel="prefetch" href="/record/assets/js/1221.88ee0191.js"><link rel="prefetch" href="/record/assets/js/1222.6668a4cf.js"><link rel="prefetch" href="/record/assets/js/1223.69990c9a.js"><link rel="prefetch" href="/record/assets/js/1224.a78d5a35.js"><link rel="prefetch" href="/record/assets/js/1225.5c2748a1.js"><link rel="prefetch" href="/record/assets/js/1226.968510e4.js"><link rel="prefetch" href="/record/assets/js/1227.0141d87a.js"><link rel="prefetch" href="/record/assets/js/1228.fed34582.js"><link rel="prefetch" href="/record/assets/js/1229.ca53d367.js"><link rel="prefetch" href="/record/assets/js/123.ad5baf5f.js"><link rel="prefetch" href="/record/assets/js/1230.56f63040.js"><link rel="prefetch" href="/record/assets/js/1231.00e88c75.js"><link rel="prefetch" href="/record/assets/js/1232.91986f96.js"><link rel="prefetch" href="/record/assets/js/1233.5d06849d.js"><link rel="prefetch" href="/record/assets/js/1234.3dcfbc9d.js"><link rel="prefetch" href="/record/assets/js/1235.68552733.js"><link rel="prefetch" href="/record/assets/js/1236.c3e009d1.js"><link rel="prefetch" href="/record/assets/js/1237.5939f823.js"><link rel="prefetch" href="/record/assets/js/1238.519ab8ab.js"><link rel="prefetch" href="/record/assets/js/1239.84df67d3.js"><link rel="prefetch" href="/record/assets/js/124.d6e2bd5b.js"><link rel="prefetch" href="/record/assets/js/1240.5e0af8c1.js"><link rel="prefetch" href="/record/assets/js/1241.b72c2a82.js"><link rel="prefetch" href="/record/assets/js/1242.1faf2684.js"><link rel="prefetch" href="/record/assets/js/1243.13d4fe0c.js"><link rel="prefetch" href="/record/assets/js/1244.a3e55b3a.js"><link rel="prefetch" href="/record/assets/js/1245.23b4939a.js"><link rel="prefetch" href="/record/assets/js/1246.d4e1452f.js"><link rel="prefetch" href="/record/assets/js/1247.6724bd71.js"><link rel="prefetch" href="/record/assets/js/1248.ba5ddccd.js"><link rel="prefetch" href="/record/assets/js/1249.d7248c46.js"><link rel="prefetch" href="/record/assets/js/125.99ef0b71.js"><link rel="prefetch" href="/record/assets/js/1250.1ec0828b.js"><link rel="prefetch" href="/record/assets/js/1251.f0d9ebdc.js"><link rel="prefetch" href="/record/assets/js/1252.b66915cc.js"><link rel="prefetch" href="/record/assets/js/1253.6692c845.js"><link rel="prefetch" href="/record/assets/js/1254.2f831be5.js"><link rel="prefetch" href="/record/assets/js/1255.437772bc.js"><link rel="prefetch" href="/record/assets/js/1256.e3190e4d.js"><link rel="prefetch" href="/record/assets/js/1257.8cb75d45.js"><link rel="prefetch" href="/record/assets/js/1258.ad1829ab.js"><link rel="prefetch" href="/record/assets/js/1259.8aa98c08.js"><link rel="prefetch" href="/record/assets/js/126.94f40334.js"><link rel="prefetch" href="/record/assets/js/1260.46399027.js"><link rel="prefetch" href="/record/assets/js/1261.eabe8daa.js"><link rel="prefetch" href="/record/assets/js/1262.4f1531d2.js"><link rel="prefetch" href="/record/assets/js/1263.fd6d1647.js"><link rel="prefetch" href="/record/assets/js/1264.5c302d1a.js"><link rel="prefetch" href="/record/assets/js/1265.61f331ec.js"><link rel="prefetch" href="/record/assets/js/1266.65c45513.js"><link rel="prefetch" href="/record/assets/js/1267.af9fdb99.js"><link rel="prefetch" href="/record/assets/js/1268.90e3ab7e.js"><link rel="prefetch" href="/record/assets/js/1269.6b15cf5e.js"><link rel="prefetch" href="/record/assets/js/127.85e80e75.js"><link rel="prefetch" href="/record/assets/js/1270.7c3e0e32.js"><link rel="prefetch" href="/record/assets/js/1271.0ffd8d9b.js"><link rel="prefetch" href="/record/assets/js/1272.fb46819e.js"><link rel="prefetch" href="/record/assets/js/1273.63fc7cf2.js"><link rel="prefetch" href="/record/assets/js/1274.cd6617dc.js"><link rel="prefetch" href="/record/assets/js/1275.f14be758.js"><link rel="prefetch" href="/record/assets/js/1276.ca24fcfd.js"><link rel="prefetch" href="/record/assets/js/1277.95d3a850.js"><link rel="prefetch" href="/record/assets/js/1278.5d881af2.js"><link rel="prefetch" href="/record/assets/js/1279.a0b8f7fc.js"><link rel="prefetch" href="/record/assets/js/128.df6bcd7b.js"><link rel="prefetch" href="/record/assets/js/1280.c5d2cc6c.js"><link rel="prefetch" href="/record/assets/js/1281.9876f492.js"><link rel="prefetch" href="/record/assets/js/1282.1cd16d59.js"><link rel="prefetch" href="/record/assets/js/1283.449d88bb.js"><link rel="prefetch" href="/record/assets/js/1284.ed3164e9.js"><link rel="prefetch" href="/record/assets/js/1285.d7a7cd97.js"><link rel="prefetch" href="/record/assets/js/1286.0cb2e710.js"><link rel="prefetch" href="/record/assets/js/1287.a4ad1fbc.js"><link rel="prefetch" href="/record/assets/js/1288.db505ddb.js"><link rel="prefetch" href="/record/assets/js/1289.b30db76e.js"><link rel="prefetch" href="/record/assets/js/129.f9151dae.js"><link rel="prefetch" href="/record/assets/js/1290.e0624ebf.js"><link rel="prefetch" href="/record/assets/js/1291.cb504821.js"><link rel="prefetch" href="/record/assets/js/1292.0b5a3240.js"><link rel="prefetch" href="/record/assets/js/1293.d566d0fd.js"><link rel="prefetch" href="/record/assets/js/1294.56cd9419.js"><link rel="prefetch" href="/record/assets/js/1295.7b1e5264.js"><link rel="prefetch" href="/record/assets/js/1296.fe6689a9.js"><link rel="prefetch" href="/record/assets/js/1297.4b4bf0a3.js"><link rel="prefetch" href="/record/assets/js/1298.491b5118.js"><link rel="prefetch" href="/record/assets/js/1299.f3abe2ec.js"><link rel="prefetch" href="/record/assets/js/13.15098364.js"><link rel="prefetch" href="/record/assets/js/130.4903a6d5.js"><link rel="prefetch" href="/record/assets/js/1300.3a15820c.js"><link rel="prefetch" href="/record/assets/js/1301.9a425a41.js"><link rel="prefetch" href="/record/assets/js/1302.30a3e8ea.js"><link rel="prefetch" href="/record/assets/js/1303.39f34c2a.js"><link rel="prefetch" href="/record/assets/js/1304.13688ef7.js"><link rel="prefetch" href="/record/assets/js/1305.9e0a1f05.js"><link rel="prefetch" href="/record/assets/js/1306.fc9b7a56.js"><link rel="prefetch" href="/record/assets/js/1307.1493dae9.js"><link rel="prefetch" href="/record/assets/js/1308.0a2fda35.js"><link rel="prefetch" href="/record/assets/js/1309.a5cf932c.js"><link rel="prefetch" href="/record/assets/js/131.766509ba.js"><link rel="prefetch" href="/record/assets/js/1310.609bf048.js"><link rel="prefetch" href="/record/assets/js/1311.ecba46a2.js"><link rel="prefetch" href="/record/assets/js/1312.bbfc59da.js"><link rel="prefetch" href="/record/assets/js/1313.6b856b62.js"><link rel="prefetch" href="/record/assets/js/1314.972efb78.js"><link rel="prefetch" href="/record/assets/js/1315.512a6540.js"><link rel="prefetch" href="/record/assets/js/1316.da9bc51f.js"><link rel="prefetch" href="/record/assets/js/1317.fc66d988.js"><link rel="prefetch" href="/record/assets/js/1318.b73fe5fe.js"><link rel="prefetch" href="/record/assets/js/1319.758f408c.js"><link rel="prefetch" href="/record/assets/js/132.4f5176cc.js"><link rel="prefetch" href="/record/assets/js/1320.0eda5f9a.js"><link rel="prefetch" href="/record/assets/js/1321.e39b0359.js"><link rel="prefetch" href="/record/assets/js/1322.183aa494.js"><link rel="prefetch" href="/record/assets/js/1323.13b221d8.js"><link rel="prefetch" href="/record/assets/js/1324.73d3a950.js"><link rel="prefetch" href="/record/assets/js/1325.18579128.js"><link rel="prefetch" href="/record/assets/js/1326.6464eacb.js"><link rel="prefetch" href="/record/assets/js/1327.adfcbb0c.js"><link rel="prefetch" href="/record/assets/js/1328.d4bcf5ed.js"><link rel="prefetch" href="/record/assets/js/1329.80801037.js"><link rel="prefetch" href="/record/assets/js/133.52393df3.js"><link rel="prefetch" href="/record/assets/js/1330.fd953312.js"><link rel="prefetch" href="/record/assets/js/1331.9790ca31.js"><link rel="prefetch" href="/record/assets/js/1332.0c38666d.js"><link rel="prefetch" href="/record/assets/js/1333.10dda06e.js"><link rel="prefetch" href="/record/assets/js/1334.256c2004.js"><link rel="prefetch" href="/record/assets/js/1335.3bc4b4be.js"><link rel="prefetch" href="/record/assets/js/1336.f1e92bda.js"><link rel="prefetch" href="/record/assets/js/1337.a118bae4.js"><link rel="prefetch" href="/record/assets/js/1338.380e8d5d.js"><link rel="prefetch" href="/record/assets/js/1339.e9b3c92b.js"><link rel="prefetch" href="/record/assets/js/134.f1e27e0e.js"><link rel="prefetch" href="/record/assets/js/1340.ac7e2d73.js"><link rel="prefetch" href="/record/assets/js/1341.1bd14dc0.js"><link rel="prefetch" href="/record/assets/js/1342.b9d2dbf6.js"><link rel="prefetch" href="/record/assets/js/1343.c33828d6.js"><link rel="prefetch" href="/record/assets/js/1344.8c1eca55.js"><link rel="prefetch" href="/record/assets/js/1345.459f824b.js"><link rel="prefetch" href="/record/assets/js/1346.98b96df8.js"><link rel="prefetch" href="/record/assets/js/1347.93bcbcc1.js"><link rel="prefetch" href="/record/assets/js/1348.618551ee.js"><link rel="prefetch" href="/record/assets/js/1349.0f4e4dfb.js"><link rel="prefetch" href="/record/assets/js/135.7bcb30aa.js"><link rel="prefetch" href="/record/assets/js/1350.bbddf7de.js"><link rel="prefetch" href="/record/assets/js/1351.2d7938f4.js"><link rel="prefetch" href="/record/assets/js/1352.7d19139d.js"><link rel="prefetch" href="/record/assets/js/1353.8cf38d46.js"><link rel="prefetch" href="/record/assets/js/1354.1640b0f2.js"><link rel="prefetch" href="/record/assets/js/1355.047539bf.js"><link rel="prefetch" href="/record/assets/js/1356.b5e187b4.js"><link rel="prefetch" href="/record/assets/js/1357.458be03e.js"><link rel="prefetch" href="/record/assets/js/1358.94d85306.js"><link rel="prefetch" href="/record/assets/js/1359.f7ca8644.js"><link rel="prefetch" href="/record/assets/js/136.0098f5c1.js"><link rel="prefetch" href="/record/assets/js/1360.7d09c2af.js"><link rel="prefetch" href="/record/assets/js/1361.5e57759f.js"><link rel="prefetch" href="/record/assets/js/1362.7a7a355d.js"><link rel="prefetch" href="/record/assets/js/1363.6d2143b0.js"><link rel="prefetch" href="/record/assets/js/1364.1553ad4d.js"><link rel="prefetch" href="/record/assets/js/1365.5fbe271b.js"><link rel="prefetch" href="/record/assets/js/1366.6b7fe9e9.js"><link rel="prefetch" href="/record/assets/js/1367.0f7e2418.js"><link rel="prefetch" href="/record/assets/js/1368.d551ef26.js"><link rel="prefetch" href="/record/assets/js/1369.82fee56c.js"><link rel="prefetch" href="/record/assets/js/137.51cf468b.js"><link rel="prefetch" href="/record/assets/js/1370.939a094a.js"><link rel="prefetch" href="/record/assets/js/1371.f1c60c63.js"><link rel="prefetch" href="/record/assets/js/1372.7838f793.js"><link rel="prefetch" href="/record/assets/js/1373.28ed1343.js"><link rel="prefetch" href="/record/assets/js/1374.4a1bfa5c.js"><link rel="prefetch" href="/record/assets/js/1375.4b349c9e.js"><link rel="prefetch" href="/record/assets/js/1376.517a2919.js"><link rel="prefetch" href="/record/assets/js/1377.f33c3c8c.js"><link rel="prefetch" href="/record/assets/js/1378.c3ef14d1.js"><link rel="prefetch" href="/record/assets/js/1379.2ec9c136.js"><link rel="prefetch" href="/record/assets/js/138.8d377b2b.js"><link rel="prefetch" href="/record/assets/js/1380.4179d20c.js"><link rel="prefetch" href="/record/assets/js/1381.1ced1165.js"><link rel="prefetch" href="/record/assets/js/1382.0c5f8a7d.js"><link rel="prefetch" href="/record/assets/js/1383.8c563d21.js"><link rel="prefetch" href="/record/assets/js/1384.28a29787.js"><link rel="prefetch" href="/record/assets/js/1385.625d9b2b.js"><link rel="prefetch" href="/record/assets/js/1386.e09ff0a7.js"><link rel="prefetch" href="/record/assets/js/1387.61017b38.js"><link rel="prefetch" href="/record/assets/js/1388.025e30b6.js"><link rel="prefetch" href="/record/assets/js/1389.3b3650dc.js"><link rel="prefetch" href="/record/assets/js/139.f47b9976.js"><link rel="prefetch" href="/record/assets/js/1390.51d79f66.js"><link rel="prefetch" href="/record/assets/js/1391.af99f05b.js"><link rel="prefetch" href="/record/assets/js/1392.2b89fb85.js"><link rel="prefetch" href="/record/assets/js/1393.f57d362a.js"><link rel="prefetch" href="/record/assets/js/1394.5171f70d.js"><link rel="prefetch" href="/record/assets/js/1395.5e61c463.js"><link rel="prefetch" href="/record/assets/js/1396.d3974265.js"><link rel="prefetch" href="/record/assets/js/1397.7c7f67a5.js"><link rel="prefetch" href="/record/assets/js/1398.d1ef96c6.js"><link rel="prefetch" href="/record/assets/js/1399.9db29a39.js"><link rel="prefetch" href="/record/assets/js/14.581ee0b9.js"><link rel="prefetch" href="/record/assets/js/140.887045af.js"><link rel="prefetch" href="/record/assets/js/1400.5ba621d3.js"><link rel="prefetch" href="/record/assets/js/1401.00034ce6.js"><link rel="prefetch" href="/record/assets/js/1402.9e611759.js"><link rel="prefetch" href="/record/assets/js/1403.fc479beb.js"><link rel="prefetch" href="/record/assets/js/1404.3ded3bf2.js"><link rel="prefetch" href="/record/assets/js/1405.645984c5.js"><link rel="prefetch" href="/record/assets/js/1406.cc38f07d.js"><link rel="prefetch" href="/record/assets/js/1407.b50b3328.js"><link rel="prefetch" href="/record/assets/js/1408.61caed5c.js"><link rel="prefetch" href="/record/assets/js/1409.8cade362.js"><link rel="prefetch" href="/record/assets/js/141.0fd611a1.js"><link rel="prefetch" href="/record/assets/js/1410.3556ed54.js"><link rel="prefetch" href="/record/assets/js/1411.c03169c3.js"><link rel="prefetch" href="/record/assets/js/1412.c68f9776.js"><link rel="prefetch" href="/record/assets/js/1413.93c0d5ba.js"><link rel="prefetch" href="/record/assets/js/1414.20d5d06b.js"><link rel="prefetch" href="/record/assets/js/1415.4d395211.js"><link rel="prefetch" href="/record/assets/js/1416.19d4fe7a.js"><link rel="prefetch" href="/record/assets/js/142.c9d2d58f.js"><link rel="prefetch" href="/record/assets/js/143.6957dd2b.js"><link rel="prefetch" href="/record/assets/js/144.7b1ee56a.js"><link rel="prefetch" href="/record/assets/js/145.d0d258a1.js"><link rel="prefetch" href="/record/assets/js/146.83bef296.js"><link rel="prefetch" href="/record/assets/js/147.9af40e5d.js"><link rel="prefetch" href="/record/assets/js/148.e616ec01.js"><link rel="prefetch" href="/record/assets/js/149.d2637326.js"><link rel="prefetch" href="/record/assets/js/15.5d47c480.js"><link rel="prefetch" href="/record/assets/js/150.b6c3084c.js"><link rel="prefetch" href="/record/assets/js/151.f4b661fe.js"><link rel="prefetch" href="/record/assets/js/152.ba81bb86.js"><link rel="prefetch" href="/record/assets/js/153.fc171257.js"><link rel="prefetch" href="/record/assets/js/154.57982d14.js"><link rel="prefetch" href="/record/assets/js/155.c67ebbca.js"><link rel="prefetch" href="/record/assets/js/156.fe88ecec.js"><link rel="prefetch" href="/record/assets/js/157.24477e8e.js"><link rel="prefetch" href="/record/assets/js/158.f7693431.js"><link rel="prefetch" href="/record/assets/js/159.8c134f49.js"><link rel="prefetch" href="/record/assets/js/16.60e768c8.js"><link rel="prefetch" href="/record/assets/js/160.a3ef2f36.js"><link rel="prefetch" href="/record/assets/js/161.32c834be.js"><link rel="prefetch" href="/record/assets/js/162.ede9d842.js"><link rel="prefetch" href="/record/assets/js/163.3b705a37.js"><link rel="prefetch" href="/record/assets/js/164.d65d5b04.js"><link rel="prefetch" href="/record/assets/js/165.da0dc096.js"><link rel="prefetch" href="/record/assets/js/166.5a8fb738.js"><link rel="prefetch" href="/record/assets/js/167.da3ea357.js"><link rel="prefetch" href="/record/assets/js/168.f09badd7.js"><link rel="prefetch" href="/record/assets/js/169.5ed85f20.js"><link rel="prefetch" href="/record/assets/js/17.cb59d171.js"><link rel="prefetch" href="/record/assets/js/170.79ae6198.js"><link rel="prefetch" href="/record/assets/js/171.6ec67bd2.js"><link rel="prefetch" href="/record/assets/js/172.1c3dfb17.js"><link rel="prefetch" href="/record/assets/js/173.9031bb13.js"><link rel="prefetch" href="/record/assets/js/174.922e7582.js"><link rel="prefetch" href="/record/assets/js/175.54e256eb.js"><link rel="prefetch" href="/record/assets/js/176.e0b438a8.js"><link rel="prefetch" href="/record/assets/js/177.13f3bc61.js"><link rel="prefetch" href="/record/assets/js/178.0d44f698.js"><link rel="prefetch" href="/record/assets/js/179.f9a3b461.js"><link rel="prefetch" href="/record/assets/js/18.e86ee14f.js"><link rel="prefetch" href="/record/assets/js/180.5c8960c0.js"><link rel="prefetch" href="/record/assets/js/181.f1a77cc2.js"><link rel="prefetch" href="/record/assets/js/182.ea3b537f.js"><link rel="prefetch" href="/record/assets/js/183.4c7602ce.js"><link rel="prefetch" href="/record/assets/js/184.c252134a.js"><link rel="prefetch" href="/record/assets/js/185.a54ac446.js"><link rel="prefetch" href="/record/assets/js/186.20f359af.js"><link rel="prefetch" href="/record/assets/js/187.54710fdf.js"><link rel="prefetch" href="/record/assets/js/188.0b2e0c3a.js"><link rel="prefetch" href="/record/assets/js/189.92d25633.js"><link rel="prefetch" href="/record/assets/js/19.cf1cddee.js"><link rel="prefetch" href="/record/assets/js/190.a18c694a.js"><link rel="prefetch" href="/record/assets/js/191.54f12d13.js"><link rel="prefetch" href="/record/assets/js/192.b1431d47.js"><link rel="prefetch" href="/record/assets/js/193.9bfcc65d.js"><link rel="prefetch" href="/record/assets/js/194.6385f1fe.js"><link rel="prefetch" href="/record/assets/js/195.c09651af.js"><link rel="prefetch" href="/record/assets/js/196.11804eb1.js"><link rel="prefetch" href="/record/assets/js/197.d72f89d0.js"><link rel="prefetch" href="/record/assets/js/198.f3a93060.js"><link rel="prefetch" href="/record/assets/js/199.4a5180a8.js"><link rel="prefetch" href="/record/assets/js/20.f918639f.js"><link rel="prefetch" href="/record/assets/js/200.f68bcf86.js"><link rel="prefetch" href="/record/assets/js/201.d1905e22.js"><link rel="prefetch" href="/record/assets/js/202.8913bd39.js"><link rel="prefetch" href="/record/assets/js/203.27c8a7aa.js"><link rel="prefetch" href="/record/assets/js/204.469dc69f.js"><link rel="prefetch" href="/record/assets/js/205.a9442e13.js"><link rel="prefetch" href="/record/assets/js/206.790259f3.js"><link rel="prefetch" href="/record/assets/js/207.4433822c.js"><link rel="prefetch" href="/record/assets/js/208.c2ee97b2.js"><link rel="prefetch" href="/record/assets/js/209.5d0f32b4.js"><link rel="prefetch" href="/record/assets/js/21.29804543.js"><link rel="prefetch" href="/record/assets/js/210.42cd938b.js"><link rel="prefetch" href="/record/assets/js/211.2d665567.js"><link rel="prefetch" href="/record/assets/js/212.48369175.js"><link rel="prefetch" href="/record/assets/js/213.99680fac.js"><link rel="prefetch" href="/record/assets/js/214.609ff47e.js"><link rel="prefetch" href="/record/assets/js/215.119755f0.js"><link rel="prefetch" href="/record/assets/js/216.003d69fa.js"><link rel="prefetch" href="/record/assets/js/217.5a602151.js"><link rel="prefetch" href="/record/assets/js/218.f30d4480.js"><link rel="prefetch" href="/record/assets/js/219.f556ea81.js"><link rel="prefetch" href="/record/assets/js/22.6454c1c8.js"><link rel="prefetch" href="/record/assets/js/220.06ad9936.js"><link rel="prefetch" href="/record/assets/js/221.e5472b1c.js"><link rel="prefetch" href="/record/assets/js/222.eca0874e.js"><link rel="prefetch" href="/record/assets/js/223.2ad79f4b.js"><link rel="prefetch" href="/record/assets/js/224.3bfc677d.js"><link rel="prefetch" href="/record/assets/js/225.629bdf69.js"><link rel="prefetch" href="/record/assets/js/226.33a0733b.js"><link rel="prefetch" href="/record/assets/js/227.78ce55ad.js"><link rel="prefetch" href="/record/assets/js/228.c1be7d67.js"><link rel="prefetch" href="/record/assets/js/229.c0474374.js"><link rel="prefetch" href="/record/assets/js/23.b46cb835.js"><link rel="prefetch" href="/record/assets/js/230.c1ea91eb.js"><link rel="prefetch" href="/record/assets/js/231.00cfb4aa.js"><link rel="prefetch" href="/record/assets/js/232.8add370a.js"><link rel="prefetch" href="/record/assets/js/233.2c424b74.js"><link rel="prefetch" href="/record/assets/js/234.c35f0e5a.js"><link rel="prefetch" href="/record/assets/js/235.f8fb594a.js"><link rel="prefetch" href="/record/assets/js/236.9719cf76.js"><link rel="prefetch" href="/record/assets/js/237.1420b94f.js"><link rel="prefetch" href="/record/assets/js/238.554c6233.js"><link rel="prefetch" href="/record/assets/js/239.9db746b2.js"><link rel="prefetch" href="/record/assets/js/24.be498a19.js"><link rel="prefetch" href="/record/assets/js/240.bffc6fe6.js"><link rel="prefetch" href="/record/assets/js/241.1adaa9c6.js"><link rel="prefetch" href="/record/assets/js/242.c1229e5c.js"><link rel="prefetch" href="/record/assets/js/243.eddcc6e0.js"><link rel="prefetch" href="/record/assets/js/244.999ba72f.js"><link rel="prefetch" href="/record/assets/js/245.46f207d4.js"><link rel="prefetch" href="/record/assets/js/246.df59f48c.js"><link rel="prefetch" href="/record/assets/js/247.7e60ebe2.js"><link rel="prefetch" href="/record/assets/js/248.75eb4feb.js"><link rel="prefetch" href="/record/assets/js/249.f3a12bc8.js"><link rel="prefetch" href="/record/assets/js/25.05cf3a9e.js"><link rel="prefetch" href="/record/assets/js/250.fd8cdc6e.js"><link rel="prefetch" href="/record/assets/js/251.21abac3b.js"><link rel="prefetch" href="/record/assets/js/252.1c26596f.js"><link rel="prefetch" href="/record/assets/js/253.6eb3a63f.js"><link rel="prefetch" href="/record/assets/js/254.7d2dff94.js"><link rel="prefetch" href="/record/assets/js/255.f943787e.js"><link rel="prefetch" href="/record/assets/js/256.8b9d33a4.js"><link rel="prefetch" href="/record/assets/js/257.3c682b20.js"><link rel="prefetch" href="/record/assets/js/258.6ecdce6d.js"><link rel="prefetch" href="/record/assets/js/259.1469e60e.js"><link rel="prefetch" href="/record/assets/js/26.7325d066.js"><link rel="prefetch" href="/record/assets/js/260.ab44cbfe.js"><link rel="prefetch" href="/record/assets/js/261.b3318216.js"><link rel="prefetch" href="/record/assets/js/262.af684b53.js"><link rel="prefetch" href="/record/assets/js/263.e023219c.js"><link rel="prefetch" href="/record/assets/js/264.0141650f.js"><link rel="prefetch" href="/record/assets/js/265.62bc319e.js"><link rel="prefetch" href="/record/assets/js/266.9053dd0e.js"><link rel="prefetch" href="/record/assets/js/267.2a5bc014.js"><link rel="prefetch" href="/record/assets/js/268.8f2ace37.js"><link rel="prefetch" href="/record/assets/js/269.6fda2751.js"><link rel="prefetch" href="/record/assets/js/27.e3fa089e.js"><link rel="prefetch" href="/record/assets/js/270.da815e1c.js"><link rel="prefetch" href="/record/assets/js/271.d4d913c9.js"><link rel="prefetch" href="/record/assets/js/272.b6d8f83a.js"><link rel="prefetch" href="/record/assets/js/273.dbca5a12.js"><link rel="prefetch" href="/record/assets/js/274.f392b28f.js"><link rel="prefetch" href="/record/assets/js/275.aabd3750.js"><link rel="prefetch" href="/record/assets/js/276.1b4146e2.js"><link rel="prefetch" href="/record/assets/js/277.c4e0fcad.js"><link rel="prefetch" href="/record/assets/js/278.c3ae7ab1.js"><link rel="prefetch" href="/record/assets/js/279.7aabacad.js"><link rel="prefetch" href="/record/assets/js/28.a1d21d27.js"><link rel="prefetch" href="/record/assets/js/280.597a32bc.js"><link rel="prefetch" href="/record/assets/js/281.003da26f.js"><link rel="prefetch" href="/record/assets/js/282.be81e8d0.js"><link rel="prefetch" href="/record/assets/js/283.75503747.js"><link rel="prefetch" href="/record/assets/js/284.ab6d8695.js"><link rel="prefetch" href="/record/assets/js/285.96e2414a.js"><link rel="prefetch" href="/record/assets/js/286.4be9daf4.js"><link rel="prefetch" href="/record/assets/js/287.0ff8edec.js"><link rel="prefetch" href="/record/assets/js/288.dd078c21.js"><link rel="prefetch" href="/record/assets/js/289.6ba268fa.js"><link rel="prefetch" href="/record/assets/js/29.933c3015.js"><link rel="prefetch" href="/record/assets/js/290.6cfc6e8a.js"><link rel="prefetch" href="/record/assets/js/291.786d3b7b.js"><link rel="prefetch" href="/record/assets/js/292.f04d1647.js"><link rel="prefetch" href="/record/assets/js/293.c30fc2b3.js"><link rel="prefetch" href="/record/assets/js/294.c2d341e3.js"><link rel="prefetch" href="/record/assets/js/295.1212fe7e.js"><link rel="prefetch" href="/record/assets/js/296.251edd79.js"><link rel="prefetch" href="/record/assets/js/297.745ea47b.js"><link rel="prefetch" href="/record/assets/js/298.0c448ca7.js"><link rel="prefetch" href="/record/assets/js/299.83f8381e.js"><link rel="prefetch" href="/record/assets/js/3.2637eec6.js"><link rel="prefetch" href="/record/assets/js/30.a96c3ab2.js"><link rel="prefetch" href="/record/assets/js/300.85000d3b.js"><link rel="prefetch" href="/record/assets/js/301.acffb4e6.js"><link rel="prefetch" href="/record/assets/js/302.4ad721d8.js"><link rel="prefetch" href="/record/assets/js/303.e86b1418.js"><link rel="prefetch" href="/record/assets/js/304.b8f91b1e.js"><link rel="prefetch" href="/record/assets/js/305.fa8e56e2.js"><link rel="prefetch" href="/record/assets/js/306.aeab42db.js"><link rel="prefetch" href="/record/assets/js/307.6db9f828.js"><link rel="prefetch" href="/record/assets/js/308.5d7ec37e.js"><link rel="prefetch" href="/record/assets/js/309.bb7a58fb.js"><link rel="prefetch" href="/record/assets/js/31.88247d9d.js"><link rel="prefetch" href="/record/assets/js/310.57c585e0.js"><link rel="prefetch" href="/record/assets/js/311.2f497daa.js"><link rel="prefetch" href="/record/assets/js/312.d71ad657.js"><link rel="prefetch" href="/record/assets/js/313.76df0b13.js"><link rel="prefetch" href="/record/assets/js/314.016e3489.js"><link rel="prefetch" href="/record/assets/js/315.8261c8a0.js"><link rel="prefetch" href="/record/assets/js/316.0c0e71a9.js"><link rel="prefetch" href="/record/assets/js/317.00747d48.js"><link rel="prefetch" href="/record/assets/js/318.32ba77db.js"><link rel="prefetch" href="/record/assets/js/319.e2f81c41.js"><link rel="prefetch" href="/record/assets/js/32.de562f31.js"><link rel="prefetch" href="/record/assets/js/320.c4c791c2.js"><link rel="prefetch" href="/record/assets/js/321.194adf9a.js"><link rel="prefetch" href="/record/assets/js/322.5e840b01.js"><link rel="prefetch" href="/record/assets/js/323.9c93b90f.js"><link rel="prefetch" href="/record/assets/js/324.a461586b.js"><link rel="prefetch" href="/record/assets/js/325.cb89d99a.js"><link rel="prefetch" href="/record/assets/js/326.b5c590f4.js"><link rel="prefetch" href="/record/assets/js/327.26a4c6cc.js"><link rel="prefetch" href="/record/assets/js/328.8a5af0ff.js"><link rel="prefetch" href="/record/assets/js/329.fd06990b.js"><link rel="prefetch" href="/record/assets/js/33.bdefdae0.js"><link rel="prefetch" href="/record/assets/js/330.6e960eac.js"><link rel="prefetch" href="/record/assets/js/331.0ba2dbae.js"><link rel="prefetch" href="/record/assets/js/332.acdb3a81.js"><link rel="prefetch" href="/record/assets/js/333.8fdec189.js"><link rel="prefetch" href="/record/assets/js/334.9d42e9b9.js"><link rel="prefetch" href="/record/assets/js/335.a06165e8.js"><link rel="prefetch" href="/record/assets/js/336.b37347c5.js"><link rel="prefetch" href="/record/assets/js/337.9a5d5e8f.js"><link rel="prefetch" href="/record/assets/js/338.ce7acf74.js"><link rel="prefetch" href="/record/assets/js/339.63887ade.js"><link rel="prefetch" href="/record/assets/js/34.d002317d.js"><link rel="prefetch" href="/record/assets/js/340.13640b48.js"><link rel="prefetch" href="/record/assets/js/341.003c7b4a.js"><link rel="prefetch" href="/record/assets/js/342.c97ecffe.js"><link rel="prefetch" href="/record/assets/js/343.8a915361.js"><link rel="prefetch" href="/record/assets/js/344.0bd7be56.js"><link rel="prefetch" href="/record/assets/js/345.7a46a94e.js"><link rel="prefetch" href="/record/assets/js/346.70914db7.js"><link rel="prefetch" href="/record/assets/js/347.5cffe944.js"><link rel="prefetch" href="/record/assets/js/348.a1f9380e.js"><link rel="prefetch" href="/record/assets/js/349.55fe3d46.js"><link rel="prefetch" href="/record/assets/js/35.ff42fed4.js"><link rel="prefetch" href="/record/assets/js/350.c5188cc2.js"><link rel="prefetch" href="/record/assets/js/351.7e92a7de.js"><link rel="prefetch" href="/record/assets/js/352.941d5955.js"><link rel="prefetch" href="/record/assets/js/353.5faa15ee.js"><link rel="prefetch" href="/record/assets/js/354.126dc219.js"><link rel="prefetch" href="/record/assets/js/355.494dcc6d.js"><link rel="prefetch" href="/record/assets/js/356.499aaf8a.js"><link rel="prefetch" href="/record/assets/js/357.370563d8.js"><link rel="prefetch" href="/record/assets/js/358.963a24cd.js"><link rel="prefetch" href="/record/assets/js/359.fa28f257.js"><link rel="prefetch" href="/record/assets/js/36.de0055e8.js"><link rel="prefetch" href="/record/assets/js/360.8ded8183.js"><link rel="prefetch" href="/record/assets/js/361.eac0bd94.js"><link rel="prefetch" href="/record/assets/js/362.7070e01c.js"><link rel="prefetch" href="/record/assets/js/363.fc06e081.js"><link rel="prefetch" href="/record/assets/js/364.354f679d.js"><link rel="prefetch" href="/record/assets/js/365.2fcd8627.js"><link rel="prefetch" href="/record/assets/js/366.1aaa49be.js"><link rel="prefetch" href="/record/assets/js/367.27347f6f.js"><link rel="prefetch" href="/record/assets/js/368.fcafb993.js"><link rel="prefetch" href="/record/assets/js/369.30a7dd96.js"><link rel="prefetch" href="/record/assets/js/37.0e6f5e81.js"><link rel="prefetch" href="/record/assets/js/370.91838911.js"><link rel="prefetch" href="/record/assets/js/371.5d750ef3.js"><link rel="prefetch" href="/record/assets/js/372.3b56ae1c.js"><link rel="prefetch" href="/record/assets/js/373.4db9677d.js"><link rel="prefetch" href="/record/assets/js/374.d372d093.js"><link rel="prefetch" href="/record/assets/js/375.9444dda7.js"><link rel="prefetch" href="/record/assets/js/376.9e7c551e.js"><link rel="prefetch" href="/record/assets/js/377.c539d833.js"><link rel="prefetch" href="/record/assets/js/378.ce8429bc.js"><link rel="prefetch" href="/record/assets/js/379.bc227cf9.js"><link rel="prefetch" href="/record/assets/js/38.1e0d7d84.js"><link rel="prefetch" href="/record/assets/js/380.07c5a82a.js"><link rel="prefetch" href="/record/assets/js/381.ad988199.js"><link rel="prefetch" href="/record/assets/js/382.62e1713e.js"><link rel="prefetch" href="/record/assets/js/383.cff819e1.js"><link rel="prefetch" href="/record/assets/js/384.2288ca83.js"><link rel="prefetch" href="/record/assets/js/385.1d3cd3c0.js"><link rel="prefetch" href="/record/assets/js/386.cda6c4ed.js"><link rel="prefetch" href="/record/assets/js/387.c782c137.js"><link rel="prefetch" href="/record/assets/js/388.c68a3846.js"><link rel="prefetch" href="/record/assets/js/389.bac09e67.js"><link rel="prefetch" href="/record/assets/js/39.2a8c4c8f.js"><link rel="prefetch" href="/record/assets/js/390.3d7f669c.js"><link rel="prefetch" href="/record/assets/js/391.86aa7512.js"><link rel="prefetch" href="/record/assets/js/392.dc3c8036.js"><link rel="prefetch" href="/record/assets/js/393.2cb913f5.js"><link rel="prefetch" href="/record/assets/js/394.9747f5dd.js"><link rel="prefetch" href="/record/assets/js/395.cdaeacc0.js"><link rel="prefetch" href="/record/assets/js/396.dcbb2484.js"><link rel="prefetch" href="/record/assets/js/397.a0a12255.js"><link rel="prefetch" href="/record/assets/js/398.a0712957.js"><link rel="prefetch" href="/record/assets/js/399.6bcba568.js"><link rel="prefetch" href="/record/assets/js/4.affb7fc9.js"><link rel="prefetch" href="/record/assets/js/40.e7b38188.js"><link rel="prefetch" href="/record/assets/js/400.c8c945ff.js"><link rel="prefetch" href="/record/assets/js/401.96477311.js"><link rel="prefetch" href="/record/assets/js/402.da6f19d9.js"><link rel="prefetch" href="/record/assets/js/403.b6dde36f.js"><link rel="prefetch" href="/record/assets/js/404.d3ee3b56.js"><link rel="prefetch" href="/record/assets/js/405.d52e846e.js"><link rel="prefetch" href="/record/assets/js/406.fbf23c82.js"><link rel="prefetch" href="/record/assets/js/407.2b0f1fed.js"><link rel="prefetch" href="/record/assets/js/408.fc51a81f.js"><link rel="prefetch" href="/record/assets/js/409.27fd9980.js"><link rel="prefetch" href="/record/assets/js/41.3573775d.js"><link rel="prefetch" href="/record/assets/js/410.ad5017db.js"><link rel="prefetch" href="/record/assets/js/411.807da38d.js"><link rel="prefetch" href="/record/assets/js/412.31c58368.js"><link rel="prefetch" href="/record/assets/js/413.55c7a447.js"><link rel="prefetch" href="/record/assets/js/414.14855b79.js"><link rel="prefetch" href="/record/assets/js/415.4b6f9af9.js"><link rel="prefetch" href="/record/assets/js/416.a6813eec.js"><link rel="prefetch" href="/record/assets/js/417.6f7cd370.js"><link rel="prefetch" href="/record/assets/js/418.376c6e23.js"><link rel="prefetch" href="/record/assets/js/419.9dc31a68.js"><link rel="prefetch" href="/record/assets/js/42.23cff203.js"><link rel="prefetch" href="/record/assets/js/420.89efcf46.js"><link rel="prefetch" href="/record/assets/js/421.d7bfce03.js"><link rel="prefetch" href="/record/assets/js/422.52e3a875.js"><link rel="prefetch" href="/record/assets/js/423.62cfac8e.js"><link rel="prefetch" href="/record/assets/js/424.ecc6e00b.js"><link rel="prefetch" href="/record/assets/js/425.a158226b.js"><link rel="prefetch" href="/record/assets/js/426.68942932.js"><link rel="prefetch" href="/record/assets/js/427.465128f3.js"><link rel="prefetch" href="/record/assets/js/428.27d942a5.js"><link rel="prefetch" href="/record/assets/js/429.762d6b3d.js"><link rel="prefetch" href="/record/assets/js/43.367e12d0.js"><link rel="prefetch" href="/record/assets/js/430.0c6d35f4.js"><link rel="prefetch" href="/record/assets/js/431.b52a1ec6.js"><link rel="prefetch" href="/record/assets/js/432.3cb44eff.js"><link rel="prefetch" href="/record/assets/js/433.eeba90ff.js"><link rel="prefetch" href="/record/assets/js/434.ec86ac8d.js"><link rel="prefetch" href="/record/assets/js/435.aaa2033f.js"><link rel="prefetch" href="/record/assets/js/436.c622dd1b.js"><link rel="prefetch" href="/record/assets/js/437.f7df4336.js"><link rel="prefetch" href="/record/assets/js/438.772c38c4.js"><link rel="prefetch" href="/record/assets/js/439.dd249204.js"><link rel="prefetch" href="/record/assets/js/44.38ac60f3.js"><link rel="prefetch" href="/record/assets/js/440.0f1bc150.js"><link rel="prefetch" href="/record/assets/js/441.31ecd6ad.js"><link rel="prefetch" href="/record/assets/js/442.d869e5da.js"><link rel="prefetch" href="/record/assets/js/443.a82cd5d4.js"><link rel="prefetch" href="/record/assets/js/444.12ef7f19.js"><link rel="prefetch" href="/record/assets/js/445.e669e57b.js"><link rel="prefetch" href="/record/assets/js/446.72267293.js"><link rel="prefetch" href="/record/assets/js/447.85991f0b.js"><link rel="prefetch" href="/record/assets/js/448.d507e2e4.js"><link rel="prefetch" href="/record/assets/js/449.1aa5892f.js"><link rel="prefetch" href="/record/assets/js/45.a8f6e2e5.js"><link rel="prefetch" href="/record/assets/js/450.0e3120c3.js"><link rel="prefetch" href="/record/assets/js/451.a977a2e0.js"><link rel="prefetch" href="/record/assets/js/452.0b870bf9.js"><link rel="prefetch" href="/record/assets/js/453.ffc7f245.js"><link rel="prefetch" href="/record/assets/js/454.7d9d6576.js"><link rel="prefetch" href="/record/assets/js/455.b057aa34.js"><link rel="prefetch" href="/record/assets/js/456.a45f4775.js"><link rel="prefetch" href="/record/assets/js/457.79ffa2c6.js"><link rel="prefetch" href="/record/assets/js/458.6f6b9e22.js"><link rel="prefetch" href="/record/assets/js/459.bbf1f9cf.js"><link rel="prefetch" href="/record/assets/js/46.4a9c53f7.js"><link rel="prefetch" href="/record/assets/js/460.c0620db9.js"><link rel="prefetch" href="/record/assets/js/461.39eb5840.js"><link rel="prefetch" href="/record/assets/js/462.4d0515a6.js"><link rel="prefetch" href="/record/assets/js/463.19e4171b.js"><link rel="prefetch" href="/record/assets/js/464.95036073.js"><link rel="prefetch" href="/record/assets/js/465.b27d4fa5.js"><link rel="prefetch" href="/record/assets/js/466.a0247d26.js"><link rel="prefetch" href="/record/assets/js/467.ebd223ed.js"><link rel="prefetch" href="/record/assets/js/468.c697b611.js"><link rel="prefetch" href="/record/assets/js/469.3e85a3b4.js"><link rel="prefetch" href="/record/assets/js/47.2aa7d948.js"><link rel="prefetch" href="/record/assets/js/470.5d71923e.js"><link rel="prefetch" href="/record/assets/js/471.f084d3f3.js"><link rel="prefetch" href="/record/assets/js/472.98575541.js"><link rel="prefetch" href="/record/assets/js/473.f6b55c0c.js"><link rel="prefetch" href="/record/assets/js/474.5a4fb0c3.js"><link rel="prefetch" href="/record/assets/js/475.4d6f1590.js"><link rel="prefetch" href="/record/assets/js/476.12caef5c.js"><link rel="prefetch" href="/record/assets/js/477.ff88c4da.js"><link rel="prefetch" href="/record/assets/js/478.2dfac3ca.js"><link rel="prefetch" href="/record/assets/js/479.19458def.js"><link rel="prefetch" href="/record/assets/js/48.2454fdc0.js"><link rel="prefetch" href="/record/assets/js/480.53992965.js"><link rel="prefetch" href="/record/assets/js/481.41f6462a.js"><link rel="prefetch" href="/record/assets/js/482.64a60786.js"><link rel="prefetch" href="/record/assets/js/483.b2867727.js"><link rel="prefetch" href="/record/assets/js/484.792ceeee.js"><link rel="prefetch" href="/record/assets/js/485.c3b9a562.js"><link rel="prefetch" href="/record/assets/js/486.13aac49e.js"><link rel="prefetch" href="/record/assets/js/487.bd8952bd.js"><link rel="prefetch" href="/record/assets/js/488.e95ce373.js"><link rel="prefetch" href="/record/assets/js/489.b32259a5.js"><link rel="prefetch" href="/record/assets/js/49.6e1b9e9b.js"><link rel="prefetch" href="/record/assets/js/490.7195a09d.js"><link rel="prefetch" href="/record/assets/js/491.2213d4ba.js"><link rel="prefetch" href="/record/assets/js/492.61838452.js"><link rel="prefetch" href="/record/assets/js/493.ec1d5170.js"><link rel="prefetch" href="/record/assets/js/494.33ebb6ca.js"><link rel="prefetch" href="/record/assets/js/495.79fb0a0a.js"><link rel="prefetch" href="/record/assets/js/496.e76689c6.js"><link rel="prefetch" href="/record/assets/js/497.79563bad.js"><link rel="prefetch" href="/record/assets/js/498.73770c26.js"><link rel="prefetch" href="/record/assets/js/499.20a0fd7c.js"><link rel="prefetch" href="/record/assets/js/50.65d83733.js"><link rel="prefetch" href="/record/assets/js/500.5ca4c151.js"><link rel="prefetch" href="/record/assets/js/501.b81afb44.js"><link rel="prefetch" href="/record/assets/js/502.89566cb3.js"><link rel="prefetch" href="/record/assets/js/503.e107650b.js"><link rel="prefetch" href="/record/assets/js/504.0108159f.js"><link rel="prefetch" href="/record/assets/js/505.f1fd201d.js"><link rel="prefetch" href="/record/assets/js/506.b3f83e6c.js"><link rel="prefetch" href="/record/assets/js/507.48478e4c.js"><link rel="prefetch" href="/record/assets/js/508.47c14190.js"><link rel="prefetch" href="/record/assets/js/509.f406a87a.js"><link rel="prefetch" href="/record/assets/js/51.33a27a00.js"><link rel="prefetch" href="/record/assets/js/510.41223657.js"><link rel="prefetch" href="/record/assets/js/511.283c8b94.js"><link rel="prefetch" href="/record/assets/js/512.0de434ca.js"><link rel="prefetch" href="/record/assets/js/513.97140f4f.js"><link rel="prefetch" href="/record/assets/js/514.b36986c8.js"><link rel="prefetch" href="/record/assets/js/515.a2210923.js"><link rel="prefetch" href="/record/assets/js/516.edfd4ae9.js"><link rel="prefetch" href="/record/assets/js/517.345823f3.js"><link rel="prefetch" href="/record/assets/js/518.f27f27be.js"><link rel="prefetch" href="/record/assets/js/519.4f6c7a79.js"><link rel="prefetch" href="/record/assets/js/52.c9f03fd2.js"><link rel="prefetch" href="/record/assets/js/520.e3281f30.js"><link rel="prefetch" href="/record/assets/js/521.98a372ce.js"><link rel="prefetch" href="/record/assets/js/522.c0e3f0ee.js"><link rel="prefetch" href="/record/assets/js/523.6b1e1064.js"><link rel="prefetch" href="/record/assets/js/524.57323ac8.js"><link rel="prefetch" href="/record/assets/js/525.76808b7d.js"><link rel="prefetch" href="/record/assets/js/526.11cfb5ab.js"><link rel="prefetch" href="/record/assets/js/527.c36d0a3f.js"><link rel="prefetch" href="/record/assets/js/528.40c8ae0c.js"><link rel="prefetch" href="/record/assets/js/529.76cd4fc0.js"><link rel="prefetch" href="/record/assets/js/53.828f4a9b.js"><link rel="prefetch" href="/record/assets/js/530.d8987236.js"><link rel="prefetch" href="/record/assets/js/531.86ccf98c.js"><link rel="prefetch" href="/record/assets/js/532.66004fce.js"><link rel="prefetch" href="/record/assets/js/533.b5d53811.js"><link rel="prefetch" href="/record/assets/js/534.facd8405.js"><link rel="prefetch" href="/record/assets/js/535.122c5671.js"><link rel="prefetch" href="/record/assets/js/536.fe4fdaa6.js"><link rel="prefetch" href="/record/assets/js/537.4e433246.js"><link rel="prefetch" href="/record/assets/js/538.288c6973.js"><link rel="prefetch" href="/record/assets/js/539.b7ba9426.js"><link rel="prefetch" href="/record/assets/js/54.85b41edf.js"><link rel="prefetch" href="/record/assets/js/540.25e012c6.js"><link rel="prefetch" href="/record/assets/js/541.fec7f946.js"><link rel="prefetch" href="/record/assets/js/542.fe031590.js"><link rel="prefetch" href="/record/assets/js/543.cc6f8809.js"><link rel="prefetch" href="/record/assets/js/544.7e0df06e.js"><link rel="prefetch" href="/record/assets/js/545.ed712fe6.js"><link rel="prefetch" href="/record/assets/js/546.de557795.js"><link rel="prefetch" href="/record/assets/js/547.45b1c49f.js"><link rel="prefetch" href="/record/assets/js/548.cbf9d0d5.js"><link rel="prefetch" href="/record/assets/js/549.e5cc213a.js"><link rel="prefetch" href="/record/assets/js/55.9d60c3ee.js"><link rel="prefetch" href="/record/assets/js/550.8570ae4f.js"><link rel="prefetch" href="/record/assets/js/551.63c2a394.js"><link rel="prefetch" href="/record/assets/js/552.6bfae8a1.js"><link rel="prefetch" href="/record/assets/js/553.a26cf23f.js"><link rel="prefetch" href="/record/assets/js/554.84b1685d.js"><link rel="prefetch" href="/record/assets/js/555.59be1bbd.js"><link rel="prefetch" href="/record/assets/js/556.131fea71.js"><link rel="prefetch" href="/record/assets/js/557.2f0cd02d.js"><link rel="prefetch" href="/record/assets/js/558.48a6834d.js"><link rel="prefetch" href="/record/assets/js/559.6c26347b.js"><link rel="prefetch" href="/record/assets/js/56.66ebfcba.js"><link rel="prefetch" href="/record/assets/js/560.02eac24e.js"><link rel="prefetch" href="/record/assets/js/561.36d98e1f.js"><link rel="prefetch" href="/record/assets/js/562.65581fa4.js"><link rel="prefetch" href="/record/assets/js/563.c98c5cb2.js"><link rel="prefetch" href="/record/assets/js/564.0dcc8b3b.js"><link rel="prefetch" href="/record/assets/js/565.e2adaf31.js"><link rel="prefetch" href="/record/assets/js/566.cd054f0a.js"><link rel="prefetch" href="/record/assets/js/567.460c064f.js"><link rel="prefetch" href="/record/assets/js/568.2c4086da.js"><link rel="prefetch" href="/record/assets/js/569.c35f4c32.js"><link rel="prefetch" href="/record/assets/js/57.2a53015a.js"><link rel="prefetch" href="/record/assets/js/570.7c50098f.js"><link rel="prefetch" href="/record/assets/js/571.974a3469.js"><link rel="prefetch" href="/record/assets/js/572.472e6da8.js"><link rel="prefetch" href="/record/assets/js/573.23cd0fb1.js"><link rel="prefetch" href="/record/assets/js/574.14de9a63.js"><link rel="prefetch" href="/record/assets/js/575.5bc1027e.js"><link rel="prefetch" href="/record/assets/js/576.29c53b9e.js"><link rel="prefetch" href="/record/assets/js/577.7a2cab8c.js"><link rel="prefetch" href="/record/assets/js/578.f65ff19c.js"><link rel="prefetch" href="/record/assets/js/579.597363d4.js"><link rel="prefetch" href="/record/assets/js/58.4737740f.js"><link rel="prefetch" href="/record/assets/js/580.4ab66f65.js"><link rel="prefetch" href="/record/assets/js/581.346a4b1b.js"><link rel="prefetch" href="/record/assets/js/582.27964d8b.js"><link rel="prefetch" href="/record/assets/js/583.a772cce6.js"><link rel="prefetch" href="/record/assets/js/584.03c115bc.js"><link rel="prefetch" href="/record/assets/js/585.e3e97139.js"><link rel="prefetch" href="/record/assets/js/586.5d409556.js"><link rel="prefetch" href="/record/assets/js/587.2b47c2b1.js"><link rel="prefetch" href="/record/assets/js/588.514b8f76.js"><link rel="prefetch" href="/record/assets/js/589.c2ebb9d5.js"><link rel="prefetch" href="/record/assets/js/59.58b70b39.js"><link rel="prefetch" href="/record/assets/js/590.260f04b9.js"><link rel="prefetch" href="/record/assets/js/591.5a1de88b.js"><link rel="prefetch" href="/record/assets/js/592.8afdaf79.js"><link rel="prefetch" href="/record/assets/js/593.7b29b175.js"><link rel="prefetch" href="/record/assets/js/594.afec5f22.js"><link rel="prefetch" href="/record/assets/js/595.683ba1ae.js"><link rel="prefetch" href="/record/assets/js/596.8d22cd18.js"><link rel="prefetch" href="/record/assets/js/597.c1a6f149.js"><link rel="prefetch" href="/record/assets/js/598.3db11dbd.js"><link rel="prefetch" href="/record/assets/js/599.77dd260a.js"><link rel="prefetch" href="/record/assets/js/6.68a4fad5.js"><link rel="prefetch" href="/record/assets/js/60.0c13cb6b.js"><link rel="prefetch" href="/record/assets/js/600.0867785f.js"><link rel="prefetch" href="/record/assets/js/601.daf18bfb.js"><link rel="prefetch" href="/record/assets/js/602.c62a375c.js"><link rel="prefetch" href="/record/assets/js/603.367ded4c.js"><link rel="prefetch" href="/record/assets/js/604.69d1ccb0.js"><link rel="prefetch" href="/record/assets/js/605.7a7e3d51.js"><link rel="prefetch" href="/record/assets/js/606.72611ee6.js"><link rel="prefetch" href="/record/assets/js/607.df4fca50.js"><link rel="prefetch" href="/record/assets/js/608.cecad84b.js"><link rel="prefetch" href="/record/assets/js/609.ed6b85ad.js"><link rel="prefetch" href="/record/assets/js/61.ad47283c.js"><link rel="prefetch" href="/record/assets/js/610.2f5e8e88.js"><link rel="prefetch" href="/record/assets/js/611.e93b5690.js"><link rel="prefetch" href="/record/assets/js/612.c96f3172.js"><link rel="prefetch" href="/record/assets/js/613.261b2a5d.js"><link rel="prefetch" href="/record/assets/js/614.d583ea89.js"><link rel="prefetch" href="/record/assets/js/615.0362b865.js"><link rel="prefetch" href="/record/assets/js/616.233a007d.js"><link rel="prefetch" href="/record/assets/js/617.755e3a21.js"><link rel="prefetch" href="/record/assets/js/618.2059064e.js"><link rel="prefetch" href="/record/assets/js/619.4cba1b8d.js"><link rel="prefetch" href="/record/assets/js/62.80eff078.js"><link rel="prefetch" href="/record/assets/js/620.baddf980.js"><link rel="prefetch" href="/record/assets/js/621.df50054e.js"><link rel="prefetch" href="/record/assets/js/622.0f17d3e2.js"><link rel="prefetch" href="/record/assets/js/623.3989ab3a.js"><link rel="prefetch" href="/record/assets/js/624.2975bbd0.js"><link rel="prefetch" href="/record/assets/js/625.11754027.js"><link rel="prefetch" href="/record/assets/js/626.fc575ef7.js"><link rel="prefetch" href="/record/assets/js/627.a30d10c9.js"><link rel="prefetch" href="/record/assets/js/628.f580d738.js"><link rel="prefetch" href="/record/assets/js/629.bc0a0632.js"><link rel="prefetch" href="/record/assets/js/63.55ca0057.js"><link rel="prefetch" href="/record/assets/js/630.8c58e75e.js"><link rel="prefetch" href="/record/assets/js/631.cd33f026.js"><link rel="prefetch" href="/record/assets/js/632.fbdf335f.js"><link rel="prefetch" href="/record/assets/js/633.0b78e5cf.js"><link rel="prefetch" href="/record/assets/js/634.a9dcd1e2.js"><link rel="prefetch" href="/record/assets/js/635.9ca28724.js"><link rel="prefetch" href="/record/assets/js/636.ff8af63f.js"><link rel="prefetch" href="/record/assets/js/637.98dcdd27.js"><link rel="prefetch" href="/record/assets/js/638.988fce97.js"><link rel="prefetch" href="/record/assets/js/639.201df997.js"><link rel="prefetch" href="/record/assets/js/64.3c7cc6ac.js"><link rel="prefetch" href="/record/assets/js/640.440986a3.js"><link rel="prefetch" href="/record/assets/js/641.500bb3e9.js"><link rel="prefetch" href="/record/assets/js/642.fa574047.js"><link rel="prefetch" href="/record/assets/js/643.df0f43e9.js"><link rel="prefetch" href="/record/assets/js/644.ecb69bc8.js"><link rel="prefetch" href="/record/assets/js/645.006a4ae0.js"><link rel="prefetch" href="/record/assets/js/646.e1fc149f.js"><link rel="prefetch" href="/record/assets/js/647.5e9ee120.js"><link rel="prefetch" href="/record/assets/js/648.e7ee9ad8.js"><link rel="prefetch" href="/record/assets/js/649.6b8215f4.js"><link rel="prefetch" href="/record/assets/js/65.c369190f.js"><link rel="prefetch" href="/record/assets/js/650.063587c8.js"><link rel="prefetch" href="/record/assets/js/651.994d9d14.js"><link rel="prefetch" href="/record/assets/js/653.35b6db17.js"><link rel="prefetch" href="/record/assets/js/654.60833e8d.js"><link rel="prefetch" href="/record/assets/js/655.e8905e6a.js"><link rel="prefetch" href="/record/assets/js/656.5794c096.js"><link rel="prefetch" href="/record/assets/js/657.4a3216f9.js"><link rel="prefetch" href="/record/assets/js/658.52ae6261.js"><link rel="prefetch" href="/record/assets/js/659.0a6c791d.js"><link rel="prefetch" href="/record/assets/js/66.2348751f.js"><link rel="prefetch" href="/record/assets/js/660.c1a60d31.js"><link rel="prefetch" href="/record/assets/js/661.5acbac04.js"><link rel="prefetch" href="/record/assets/js/662.32af37c5.js"><link rel="prefetch" href="/record/assets/js/663.ee20f548.js"><link rel="prefetch" href="/record/assets/js/664.9721aa84.js"><link rel="prefetch" href="/record/assets/js/665.e998b7aa.js"><link rel="prefetch" href="/record/assets/js/666.0a137201.js"><link rel="prefetch" href="/record/assets/js/667.b9a87923.js"><link rel="prefetch" href="/record/assets/js/668.4192e76e.js"><link rel="prefetch" href="/record/assets/js/669.4568e2df.js"><link rel="prefetch" href="/record/assets/js/67.c0df52c9.js"><link rel="prefetch" href="/record/assets/js/670.127f5e90.js"><link rel="prefetch" href="/record/assets/js/671.9c6564d3.js"><link rel="prefetch" href="/record/assets/js/672.01e29046.js"><link rel="prefetch" href="/record/assets/js/673.2a1cc479.js"><link rel="prefetch" href="/record/assets/js/674.ca15a7f4.js"><link rel="prefetch" href="/record/assets/js/675.ec2758b1.js"><link rel="prefetch" href="/record/assets/js/676.0a0ab380.js"><link rel="prefetch" href="/record/assets/js/677.468cf8fd.js"><link rel="prefetch" href="/record/assets/js/678.128f2cce.js"><link rel="prefetch" href="/record/assets/js/679.740736c2.js"><link rel="prefetch" href="/record/assets/js/68.7ce90ec7.js"><link rel="prefetch" href="/record/assets/js/680.6d8ec945.js"><link rel="prefetch" href="/record/assets/js/681.4f3b4bec.js"><link rel="prefetch" href="/record/assets/js/682.553f01d1.js"><link rel="prefetch" href="/record/assets/js/683.e51a9567.js"><link rel="prefetch" href="/record/assets/js/684.e6487c6f.js"><link rel="prefetch" href="/record/assets/js/685.0a9d821c.js"><link rel="prefetch" href="/record/assets/js/686.88e3d0c4.js"><link rel="prefetch" href="/record/assets/js/687.917a9fcb.js"><link rel="prefetch" href="/record/assets/js/688.8a63bb98.js"><link rel="prefetch" href="/record/assets/js/689.20ef9d4d.js"><link rel="prefetch" href="/record/assets/js/69.6f2a9cd7.js"><link rel="prefetch" href="/record/assets/js/690.5b0fa45f.js"><link rel="prefetch" href="/record/assets/js/691.7b5a8e28.js"><link rel="prefetch" href="/record/assets/js/692.6c8e1601.js"><link rel="prefetch" href="/record/assets/js/693.57f23f31.js"><link rel="prefetch" href="/record/assets/js/694.7b2ef73c.js"><link rel="prefetch" href="/record/assets/js/695.98a23bbe.js"><link rel="prefetch" href="/record/assets/js/696.0686b689.js"><link rel="prefetch" href="/record/assets/js/697.7ba0afa3.js"><link rel="prefetch" href="/record/assets/js/698.0168eff6.js"><link rel="prefetch" href="/record/assets/js/699.3d0f175e.js"><link rel="prefetch" href="/record/assets/js/7.d1422b53.js"><link rel="prefetch" href="/record/assets/js/70.e3530170.js"><link rel="prefetch" href="/record/assets/js/700.203d59a0.js"><link rel="prefetch" href="/record/assets/js/701.9ebabb93.js"><link rel="prefetch" href="/record/assets/js/702.209dd902.js"><link rel="prefetch" href="/record/assets/js/703.e169874f.js"><link rel="prefetch" href="/record/assets/js/704.6b5eeca7.js"><link rel="prefetch" href="/record/assets/js/705.3d9a4213.js"><link rel="prefetch" href="/record/assets/js/706.d2b73116.js"><link rel="prefetch" href="/record/assets/js/707.8573d1be.js"><link rel="prefetch" href="/record/assets/js/708.e78f1494.js"><link rel="prefetch" href="/record/assets/js/709.fd7b71e0.js"><link rel="prefetch" href="/record/assets/js/71.b6b2b43b.js"><link rel="prefetch" href="/record/assets/js/710.8adfbfb9.js"><link rel="prefetch" href="/record/assets/js/711.62bb8b55.js"><link rel="prefetch" href="/record/assets/js/712.012f7bb2.js"><link rel="prefetch" href="/record/assets/js/713.b55991f0.js"><link rel="prefetch" href="/record/assets/js/714.56ecdd50.js"><link rel="prefetch" href="/record/assets/js/715.51dedbe6.js"><link rel="prefetch" href="/record/assets/js/716.c85e399d.js"><link rel="prefetch" href="/record/assets/js/717.358ff7ea.js"><link rel="prefetch" href="/record/assets/js/718.cfa5cb1d.js"><link rel="prefetch" href="/record/assets/js/719.00a52c90.js"><link rel="prefetch" href="/record/assets/js/72.12626a3e.js"><link rel="prefetch" href="/record/assets/js/720.ee550f14.js"><link rel="prefetch" href="/record/assets/js/721.8961b97b.js"><link rel="prefetch" href="/record/assets/js/722.961b6ad3.js"><link rel="prefetch" href="/record/assets/js/723.17bff2d5.js"><link rel="prefetch" href="/record/assets/js/724.7f0b96a1.js"><link rel="prefetch" href="/record/assets/js/725.a2063df9.js"><link rel="prefetch" href="/record/assets/js/726.011f6f74.js"><link rel="prefetch" href="/record/assets/js/727.c184721a.js"><link rel="prefetch" href="/record/assets/js/728.9da1e130.js"><link rel="prefetch" href="/record/assets/js/729.462c455b.js"><link rel="prefetch" href="/record/assets/js/73.2acf4667.js"><link rel="prefetch" href="/record/assets/js/730.6c14cfac.js"><link rel="prefetch" href="/record/assets/js/731.2b8fb399.js"><link rel="prefetch" href="/record/assets/js/732.7376bfe5.js"><link rel="prefetch" href="/record/assets/js/733.10dac317.js"><link rel="prefetch" href="/record/assets/js/734.bf1ae21c.js"><link rel="prefetch" href="/record/assets/js/735.3743e866.js"><link rel="prefetch" href="/record/assets/js/736.bb12cf78.js"><link rel="prefetch" href="/record/assets/js/737.cbe4f92f.js"><link rel="prefetch" href="/record/assets/js/738.6980317e.js"><link rel="prefetch" href="/record/assets/js/739.35b98f9d.js"><link rel="prefetch" href="/record/assets/js/74.f97c5ad2.js"><link rel="prefetch" href="/record/assets/js/740.30715f43.js"><link rel="prefetch" href="/record/assets/js/741.e3f29d77.js"><link rel="prefetch" href="/record/assets/js/742.7816af43.js"><link rel="prefetch" href="/record/assets/js/743.2ae44586.js"><link rel="prefetch" href="/record/assets/js/744.8ccd149b.js"><link rel="prefetch" href="/record/assets/js/745.60cffed8.js"><link rel="prefetch" href="/record/assets/js/746.15a8288a.js"><link rel="prefetch" href="/record/assets/js/747.af40cf93.js"><link rel="prefetch" href="/record/assets/js/748.44940f36.js"><link rel="prefetch" href="/record/assets/js/749.3d3618b6.js"><link rel="prefetch" href="/record/assets/js/75.7e745984.js"><link rel="prefetch" href="/record/assets/js/750.62614f7a.js"><link rel="prefetch" href="/record/assets/js/751.19593ed1.js"><link rel="prefetch" href="/record/assets/js/752.7b6c020d.js"><link rel="prefetch" href="/record/assets/js/753.971df9e2.js"><link rel="prefetch" href="/record/assets/js/754.be7620d5.js"><link rel="prefetch" href="/record/assets/js/755.30071bd7.js"><link rel="prefetch" href="/record/assets/js/756.07426e26.js"><link rel="prefetch" href="/record/assets/js/757.e4c1e469.js"><link rel="prefetch" href="/record/assets/js/758.e0806fb0.js"><link rel="prefetch" href="/record/assets/js/759.e216ab22.js"><link rel="prefetch" href="/record/assets/js/76.79b9805c.js"><link rel="prefetch" href="/record/assets/js/760.dee41228.js"><link rel="prefetch" href="/record/assets/js/761.84db804f.js"><link rel="prefetch" href="/record/assets/js/762.e94eb365.js"><link rel="prefetch" href="/record/assets/js/763.cf6398f8.js"><link rel="prefetch" href="/record/assets/js/764.85f44902.js"><link rel="prefetch" href="/record/assets/js/765.ba14f4fa.js"><link rel="prefetch" href="/record/assets/js/766.1cff9022.js"><link rel="prefetch" href="/record/assets/js/767.d2da209f.js"><link rel="prefetch" href="/record/assets/js/768.38be2dd2.js"><link rel="prefetch" href="/record/assets/js/769.b7ca5dbf.js"><link rel="prefetch" href="/record/assets/js/77.8373421b.js"><link rel="prefetch" href="/record/assets/js/770.594c0bce.js"><link rel="prefetch" href="/record/assets/js/771.dd8b1e89.js"><link rel="prefetch" href="/record/assets/js/772.774714b9.js"><link rel="prefetch" href="/record/assets/js/773.10d362f5.js"><link rel="prefetch" href="/record/assets/js/774.99358d14.js"><link rel="prefetch" href="/record/assets/js/775.7b4f5492.js"><link rel="prefetch" href="/record/assets/js/776.febfae9b.js"><link rel="prefetch" href="/record/assets/js/777.6a928fa8.js"><link rel="prefetch" href="/record/assets/js/778.a6b21adc.js"><link rel="prefetch" href="/record/assets/js/779.8a1c4af7.js"><link rel="prefetch" href="/record/assets/js/78.ff15740a.js"><link rel="prefetch" href="/record/assets/js/780.6a073fea.js"><link rel="prefetch" href="/record/assets/js/781.952bbe1a.js"><link rel="prefetch" href="/record/assets/js/782.77684be9.js"><link rel="prefetch" href="/record/assets/js/783.8e014662.js"><link rel="prefetch" href="/record/assets/js/784.31f4e5b1.js"><link rel="prefetch" href="/record/assets/js/785.141b26f1.js"><link rel="prefetch" href="/record/assets/js/786.cf03bf67.js"><link rel="prefetch" href="/record/assets/js/787.fb0f6141.js"><link rel="prefetch" href="/record/assets/js/788.cd4a0f85.js"><link rel="prefetch" href="/record/assets/js/789.657e6d07.js"><link rel="prefetch" href="/record/assets/js/79.0738362d.js"><link rel="prefetch" href="/record/assets/js/790.11e1d0d7.js"><link rel="prefetch" href="/record/assets/js/791.4222c59b.js"><link rel="prefetch" href="/record/assets/js/792.2443c8a2.js"><link rel="prefetch" href="/record/assets/js/793.1ff53625.js"><link rel="prefetch" href="/record/assets/js/794.1c9e7ff9.js"><link rel="prefetch" href="/record/assets/js/795.66da3957.js"><link rel="prefetch" href="/record/assets/js/796.34e7094a.js"><link rel="prefetch" href="/record/assets/js/797.c2164e1d.js"><link rel="prefetch" href="/record/assets/js/798.321873cc.js"><link rel="prefetch" href="/record/assets/js/799.1abefe08.js"><link rel="prefetch" href="/record/assets/js/8.7347f746.js"><link rel="prefetch" href="/record/assets/js/80.e578f917.js"><link rel="prefetch" href="/record/assets/js/800.5c0f8715.js"><link rel="prefetch" href="/record/assets/js/801.74aa3915.js"><link rel="prefetch" href="/record/assets/js/802.934e3b8d.js"><link rel="prefetch" href="/record/assets/js/803.5bdec9ae.js"><link rel="prefetch" href="/record/assets/js/804.f28ac4b9.js"><link rel="prefetch" href="/record/assets/js/805.fd556604.js"><link rel="prefetch" href="/record/assets/js/806.69b3af6f.js"><link rel="prefetch" href="/record/assets/js/807.8eff37ad.js"><link rel="prefetch" href="/record/assets/js/808.0e71c572.js"><link rel="prefetch" href="/record/assets/js/809.227f1b16.js"><link rel="prefetch" href="/record/assets/js/81.f983e2b3.js"><link rel="prefetch" href="/record/assets/js/810.9e3386e9.js"><link rel="prefetch" href="/record/assets/js/811.8175e776.js"><link rel="prefetch" href="/record/assets/js/812.95be92fa.js"><link rel="prefetch" href="/record/assets/js/813.89b94fac.js"><link rel="prefetch" href="/record/assets/js/814.7d335c6a.js"><link rel="prefetch" href="/record/assets/js/815.42605a44.js"><link rel="prefetch" href="/record/assets/js/816.227d866c.js"><link rel="prefetch" href="/record/assets/js/817.8897077a.js"><link rel="prefetch" href="/record/assets/js/818.27d88273.js"><link rel="prefetch" href="/record/assets/js/819.e7d8d06b.js"><link rel="prefetch" href="/record/assets/js/82.24ec3997.js"><link rel="prefetch" href="/record/assets/js/820.3e1d47e7.js"><link rel="prefetch" href="/record/assets/js/821.f8618de5.js"><link rel="prefetch" href="/record/assets/js/822.ef4b7495.js"><link rel="prefetch" href="/record/assets/js/823.2a17e79f.js"><link rel="prefetch" href="/record/assets/js/824.34378df8.js"><link rel="prefetch" href="/record/assets/js/825.a7c49fcf.js"><link rel="prefetch" href="/record/assets/js/826.131d5ec5.js"><link rel="prefetch" href="/record/assets/js/827.7e407e96.js"><link rel="prefetch" href="/record/assets/js/828.31df3cd1.js"><link rel="prefetch" href="/record/assets/js/829.017c0ff4.js"><link rel="prefetch" href="/record/assets/js/83.c453f524.js"><link rel="prefetch" href="/record/assets/js/830.7e47d1b0.js"><link rel="prefetch" href="/record/assets/js/831.8e50d16c.js"><link rel="prefetch" href="/record/assets/js/832.350dc28e.js"><link rel="prefetch" href="/record/assets/js/833.d2571dd0.js"><link rel="prefetch" href="/record/assets/js/834.1879380a.js"><link rel="prefetch" href="/record/assets/js/835.60546596.js"><link rel="prefetch" href="/record/assets/js/836.0eacb6e2.js"><link rel="prefetch" href="/record/assets/js/837.8b166aae.js"><link rel="prefetch" href="/record/assets/js/838.df642306.js"><link rel="prefetch" href="/record/assets/js/839.96e65be9.js"><link rel="prefetch" href="/record/assets/js/84.56de9889.js"><link rel="prefetch" href="/record/assets/js/840.56a63211.js"><link rel="prefetch" href="/record/assets/js/841.c0e2034b.js"><link rel="prefetch" href="/record/assets/js/842.beb5bc98.js"><link rel="prefetch" href="/record/assets/js/843.a8e09677.js"><link rel="prefetch" href="/record/assets/js/844.5e4c2a32.js"><link rel="prefetch" href="/record/assets/js/845.c985e2a8.js"><link rel="prefetch" href="/record/assets/js/846.b9f78d64.js"><link rel="prefetch" href="/record/assets/js/847.548c2251.js"><link rel="prefetch" href="/record/assets/js/848.c4528de0.js"><link rel="prefetch" href="/record/assets/js/849.58631c19.js"><link rel="prefetch" href="/record/assets/js/85.a9854dab.js"><link rel="prefetch" href="/record/assets/js/850.1a2b03ab.js"><link rel="prefetch" href="/record/assets/js/851.d23a0ed1.js"><link rel="prefetch" href="/record/assets/js/852.1d5812a5.js"><link rel="prefetch" href="/record/assets/js/853.6f50d462.js"><link rel="prefetch" href="/record/assets/js/854.ef677ad7.js"><link rel="prefetch" href="/record/assets/js/855.2fab1b8f.js"><link rel="prefetch" href="/record/assets/js/856.40d6b3b7.js"><link rel="prefetch" href="/record/assets/js/857.c0ec9239.js"><link rel="prefetch" href="/record/assets/js/858.7aff369d.js"><link rel="prefetch" href="/record/assets/js/859.add4c03f.js"><link rel="prefetch" href="/record/assets/js/86.5385b48c.js"><link rel="prefetch" href="/record/assets/js/860.ce7a4b76.js"><link rel="prefetch" href="/record/assets/js/861.5db8ae3f.js"><link rel="prefetch" href="/record/assets/js/862.e37d3ba5.js"><link rel="prefetch" href="/record/assets/js/863.2b0462ea.js"><link rel="prefetch" href="/record/assets/js/864.0d4e4b08.js"><link rel="prefetch" href="/record/assets/js/865.56d9df09.js"><link rel="prefetch" href="/record/assets/js/866.07444b69.js"><link rel="prefetch" href="/record/assets/js/867.5b62e6bc.js"><link rel="prefetch" href="/record/assets/js/868.b10a8516.js"><link rel="prefetch" href="/record/assets/js/869.2fdae5a7.js"><link rel="prefetch" href="/record/assets/js/87.ca8c0499.js"><link rel="prefetch" href="/record/assets/js/870.5881d693.js"><link rel="prefetch" href="/record/assets/js/871.0e8e6282.js"><link rel="prefetch" href="/record/assets/js/872.df3f518e.js"><link rel="prefetch" href="/record/assets/js/873.6fac2c48.js"><link rel="prefetch" href="/record/assets/js/874.78005f94.js"><link rel="prefetch" href="/record/assets/js/875.0518b0e5.js"><link rel="prefetch" href="/record/assets/js/876.acb5752f.js"><link rel="prefetch" href="/record/assets/js/877.ce014d02.js"><link rel="prefetch" href="/record/assets/js/878.c1ee0fbb.js"><link rel="prefetch" href="/record/assets/js/879.320a0e74.js"><link rel="prefetch" href="/record/assets/js/88.d1be30ec.js"><link rel="prefetch" href="/record/assets/js/880.9a93a8e9.js"><link rel="prefetch" href="/record/assets/js/881.50a3ce06.js"><link rel="prefetch" href="/record/assets/js/882.197f936f.js"><link rel="prefetch" href="/record/assets/js/883.9763d158.js"><link rel="prefetch" href="/record/assets/js/884.8a59f61d.js"><link rel="prefetch" href="/record/assets/js/885.785197ac.js"><link rel="prefetch" href="/record/assets/js/886.0731acad.js"><link rel="prefetch" href="/record/assets/js/887.e70e9f6c.js"><link rel="prefetch" href="/record/assets/js/888.414a9221.js"><link rel="prefetch" href="/record/assets/js/889.6a318198.js"><link rel="prefetch" href="/record/assets/js/89.64b0ef7e.js"><link rel="prefetch" href="/record/assets/js/890.68373df9.js"><link rel="prefetch" href="/record/assets/js/891.533706a9.js"><link rel="prefetch" href="/record/assets/js/892.2efde888.js"><link rel="prefetch" href="/record/assets/js/893.32070e68.js"><link rel="prefetch" href="/record/assets/js/894.30038b74.js"><link rel="prefetch" href="/record/assets/js/895.c045bade.js"><link rel="prefetch" href="/record/assets/js/896.b56fd350.js"><link rel="prefetch" href="/record/assets/js/897.a271ab56.js"><link rel="prefetch" href="/record/assets/js/898.70620275.js"><link rel="prefetch" href="/record/assets/js/899.a2848490.js"><link rel="prefetch" href="/record/assets/js/9.386fe4d6.js"><link rel="prefetch" href="/record/assets/js/90.c7f53dfa.js"><link rel="prefetch" href="/record/assets/js/900.f1905002.js"><link rel="prefetch" href="/record/assets/js/901.7955d021.js"><link rel="prefetch" href="/record/assets/js/902.e43413e1.js"><link rel="prefetch" href="/record/assets/js/903.c953a224.js"><link rel="prefetch" href="/record/assets/js/904.ba760b04.js"><link rel="prefetch" href="/record/assets/js/905.39140dd2.js"><link rel="prefetch" href="/record/assets/js/906.d1d3bf16.js"><link rel="prefetch" href="/record/assets/js/907.b9377364.js"><link rel="prefetch" href="/record/assets/js/908.30346af5.js"><link rel="prefetch" href="/record/assets/js/909.37bf2025.js"><link rel="prefetch" href="/record/assets/js/91.70ce029e.js"><link rel="prefetch" href="/record/assets/js/910.45e87140.js"><link rel="prefetch" href="/record/assets/js/911.9145f6fe.js"><link rel="prefetch" href="/record/assets/js/912.6d8f70e2.js"><link rel="prefetch" href="/record/assets/js/913.5d4bd67f.js"><link rel="prefetch" href="/record/assets/js/914.e8bac23c.js"><link rel="prefetch" href="/record/assets/js/915.dfe96a53.js"><link rel="prefetch" href="/record/assets/js/916.b4222d78.js"><link rel="prefetch" href="/record/assets/js/917.d2ddc9a3.js"><link rel="prefetch" href="/record/assets/js/918.0df5d56d.js"><link rel="prefetch" href="/record/assets/js/919.c39c8dbd.js"><link rel="prefetch" href="/record/assets/js/92.d414e22b.js"><link rel="prefetch" href="/record/assets/js/920.cafcbc12.js"><link rel="prefetch" href="/record/assets/js/921.0ec550ac.js"><link rel="prefetch" href="/record/assets/js/922.c5641571.js"><link rel="prefetch" href="/record/assets/js/923.8c9dbcd6.js"><link rel="prefetch" href="/record/assets/js/924.195ab0ea.js"><link rel="prefetch" href="/record/assets/js/925.ade5ed6d.js"><link rel="prefetch" href="/record/assets/js/926.c48648ee.js"><link rel="prefetch" href="/record/assets/js/927.d0478d03.js"><link rel="prefetch" href="/record/assets/js/928.8465feb4.js"><link rel="prefetch" href="/record/assets/js/929.b56f268a.js"><link rel="prefetch" href="/record/assets/js/93.93580ad0.js"><link rel="prefetch" href="/record/assets/js/930.07cbc683.js"><link rel="prefetch" href="/record/assets/js/931.ed943423.js"><link rel="prefetch" href="/record/assets/js/932.ebb54556.js"><link rel="prefetch" href="/record/assets/js/933.d5765528.js"><link rel="prefetch" href="/record/assets/js/934.bdee04bb.js"><link rel="prefetch" href="/record/assets/js/935.2f0ee3df.js"><link rel="prefetch" href="/record/assets/js/936.b6db959f.js"><link rel="prefetch" href="/record/assets/js/937.227f5549.js"><link rel="prefetch" href="/record/assets/js/938.6aaa32ca.js"><link rel="prefetch" href="/record/assets/js/939.c1ad4ea9.js"><link rel="prefetch" href="/record/assets/js/94.a0738a48.js"><link rel="prefetch" href="/record/assets/js/940.541de53a.js"><link rel="prefetch" href="/record/assets/js/941.cd793ba8.js"><link rel="prefetch" href="/record/assets/js/942.7532dc45.js"><link rel="prefetch" href="/record/assets/js/943.38559870.js"><link rel="prefetch" href="/record/assets/js/944.16dc3c43.js"><link rel="prefetch" href="/record/assets/js/945.5e07b835.js"><link rel="prefetch" href="/record/assets/js/946.68c0182d.js"><link rel="prefetch" href="/record/assets/js/947.d1fb52ed.js"><link rel="prefetch" href="/record/assets/js/948.e6c7c3e3.js"><link rel="prefetch" href="/record/assets/js/949.02618dfe.js"><link rel="prefetch" href="/record/assets/js/95.3403b601.js"><link rel="prefetch" href="/record/assets/js/950.3ab0dd01.js"><link rel="prefetch" href="/record/assets/js/951.734ab7b8.js"><link rel="prefetch" href="/record/assets/js/952.8e3fa239.js"><link rel="prefetch" href="/record/assets/js/953.bc5452d6.js"><link rel="prefetch" href="/record/assets/js/954.4ec6d1cb.js"><link rel="prefetch" href="/record/assets/js/955.63373206.js"><link rel="prefetch" href="/record/assets/js/956.d962be0e.js"><link rel="prefetch" href="/record/assets/js/957.0ed7cba6.js"><link rel="prefetch" href="/record/assets/js/958.c4d099df.js"><link rel="prefetch" href="/record/assets/js/959.63463c41.js"><link rel="prefetch" href="/record/assets/js/96.954bfdd4.js"><link rel="prefetch" href="/record/assets/js/960.b58efb9b.js"><link rel="prefetch" href="/record/assets/js/961.ed853164.js"><link rel="prefetch" href="/record/assets/js/962.7aaa459e.js"><link rel="prefetch" href="/record/assets/js/963.eb5326c1.js"><link rel="prefetch" href="/record/assets/js/964.b4c92ea3.js"><link rel="prefetch" href="/record/assets/js/965.8ace5cce.js"><link rel="prefetch" href="/record/assets/js/966.0fa3fc40.js"><link rel="prefetch" href="/record/assets/js/967.65bf3ee6.js"><link rel="prefetch" href="/record/assets/js/968.658e45d1.js"><link rel="prefetch" href="/record/assets/js/969.171373a0.js"><link rel="prefetch" href="/record/assets/js/97.2c77c180.js"><link rel="prefetch" href="/record/assets/js/970.44bb52c1.js"><link rel="prefetch" href="/record/assets/js/971.e9f13af6.js"><link rel="prefetch" href="/record/assets/js/972.07ee0eb6.js"><link rel="prefetch" href="/record/assets/js/973.30c76dee.js"><link rel="prefetch" href="/record/assets/js/974.0da48822.js"><link rel="prefetch" href="/record/assets/js/975.35ace791.js"><link rel="prefetch" href="/record/assets/js/976.19a7fbf1.js"><link rel="prefetch" href="/record/assets/js/977.0f625ee0.js"><link rel="prefetch" href="/record/assets/js/978.d4233000.js"><link rel="prefetch" href="/record/assets/js/979.b90afbff.js"><link rel="prefetch" href="/record/assets/js/98.2d869380.js"><link rel="prefetch" href="/record/assets/js/980.040cd9e4.js"><link rel="prefetch" href="/record/assets/js/981.f5251614.js"><link rel="prefetch" href="/record/assets/js/982.06704947.js"><link rel="prefetch" href="/record/assets/js/983.b6ade6bb.js"><link rel="prefetch" href="/record/assets/js/984.73ed79e5.js"><link rel="prefetch" href="/record/assets/js/985.015e5283.js"><link rel="prefetch" href="/record/assets/js/986.ec097aed.js"><link rel="prefetch" href="/record/assets/js/987.ec049e73.js"><link rel="prefetch" href="/record/assets/js/988.b26fc8c6.js"><link rel="prefetch" href="/record/assets/js/989.e8646bed.js"><link rel="prefetch" href="/record/assets/js/99.bdcf796b.js"><link rel="prefetch" href="/record/assets/js/990.10b18e26.js"><link rel="prefetch" href="/record/assets/js/991.93ac0c49.js"><link rel="prefetch" href="/record/assets/js/992.1c539cf3.js"><link rel="prefetch" href="/record/assets/js/993.22910144.js"><link rel="prefetch" href="/record/assets/js/994.91c39bab.js"><link rel="prefetch" href="/record/assets/js/995.237d6b8c.js"><link rel="prefetch" href="/record/assets/js/996.eab54736.js"><link rel="prefetch" href="/record/assets/js/997.8831c27d.js"><link rel="prefetch" href="/record/assets/js/998.6c0f4360.js"><link rel="prefetch" href="/record/assets/js/999.47e1a369.js">
    <link rel="stylesheet" href="/record/assets/css/0.styles.0d67cf55.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/record/" class="home-link router-link-active"><img src="/record/mlogo.svg" alt="Record" class="logo"> <span class="site-name can-hide">Record</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://blog.csdn.net/maoyeqiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客（csdn）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/leetcode/daimasuixiang/" class="nav-link">
  代码随想
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/algorithms/" class="nav-link">
  剑指offer
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/algorithmsmore/" class="nav-link">
  常见算法
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/leetcodetop/" class="nav-link">
  针对算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="java" class="dropdown-title"><span class="title">java</span> <span class="arrow down"></span></button> <button type="button" aria-label="java" class="mobile-dropdown-title"><span class="title">java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/java/collection/" class="nav-link">
  集合
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/con/" class="nav-link">
  并发编程
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/jacoco/" class="nav-link">
  jacoco
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/Java8/" class="nav-link router-link-active">
  Java8
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/jvm/" class="nav-link">
  JVM一
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jvm/" class="nav-link">
  JVM二
</a></li><li class="dropdown-item"><!----> <a href="/record/java/source/" class="nav-link">
  源码
</a></li><li class="dropdown-item"><!----> <a href="/record/java/spring/" class="nav-link">
  spring
</a></li><li class="dropdown-item"><!----> <a href="/record/java/thread/" class="nav-link">
  线程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/middleware/cache/" class="nav-link">
  缓存
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/dubbo/" class="nav-link">
  dubbo
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/es/" class="nav-link">
  es
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/MyBatis/" class="nav-link">
  MyBatis
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/" class="nav-link">
  mysql1
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/database/" class="nav-link">
  mysql2
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/MySQL/" class="nav-link">
  mysql3
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/" class="nav-link">
  redis1
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/cache/" class="nav-link">
  redis2
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/Redis/" class="nav-link">
  redis3
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/zk/" class="nav-link">
  zk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="q&amp;a" class="dropdown-title"><span class="title">q&amp;a</span> <span class="arrow down"></span></button> <button type="button" aria-label="q&amp;a" class="mobile-dropdown-title"><span class="title">q&amp;a</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/q&amp;a/interview/" class="nav-link">
  问答
</a></li><li class="dropdown-item"><!----> <a href="/record/q&amp;a/self/" class="nav-link">
  详细
</a></li><li class="dropdown-item"><!----> <a href="/record/q&amp;a/tuji/" class="nav-link">
  突击
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程" class="dropdown-title"><span class="title">课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程" class="mobile-dropdown-title"><span class="title">课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/imocc/design_pattern/" class="nav-link">
  设计模式（慕课）
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/design_pattern_li/" class="nav-link">
  研磨设计模式（李兴华）
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/elasticsearch-core/" class="nav-link">
  ES核心知识篇
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/comdesign/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/elasticsearch-senior/" class="nav-link">
  ES高级知识篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="设计" class="mobile-dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/design/back-end-storage/" class="nav-link">
  后端存储实战
</a></li><li class="dropdown-item"><!----> <a href="/record/design/cache-pdp/" class="nav-link">
  复杂缓存架构
</a></li><li class="dropdown-item"><!----> <a href="/record/design/big-backEnd/" class="nav-link">
  大数据后端
</a></li><li class="dropdown-item"><!----> <a href="/record/design/ddd/" class="nav-link">
  ddd
</a></li><li class="dropdown-item"><!----> <a href="/record/design/distrubuted/" class="nav-link">
  分布式1
</a></li><li class="dropdown-item"><!----> <a href="/record/design/system/" class="nav-link">
  分布式2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="更多" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/important/" class="nav-link">
  重要入口
</a></li><li class="dropdown-item"><!----> <a href="/record/other/" class="nav-link">
  其他
</a></li><li class="dropdown-item"><!----> <a href="/record/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/record/introduce/" class="nav-link">
  本笔记介绍
</a></li></ul></div></div> <a href="https://github.com/txxs/record" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://blog.csdn.net/maoyeqiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客（csdn）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/leetcode/daimasuixiang/" class="nav-link">
  代码随想
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/algorithms/" class="nav-link">
  剑指offer
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/algorithmsmore/" class="nav-link">
  常见算法
</a></li><li class="dropdown-item"><!----> <a href="/record/leetcode/leetcodetop/" class="nav-link">
  针对算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="java" class="dropdown-title"><span class="title">java</span> <span class="arrow down"></span></button> <button type="button" aria-label="java" class="mobile-dropdown-title"><span class="title">java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/java/collection/" class="nav-link">
  集合
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/con/" class="nav-link">
  并发编程
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/jacoco/" class="nav-link">
  jacoco
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/Java8/" class="nav-link router-link-active">
  Java8
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jdk/jvm/" class="nav-link">
  JVM一
</a></li><li class="dropdown-item"><!----> <a href="/record/java/jvm/" class="nav-link">
  JVM二
</a></li><li class="dropdown-item"><!----> <a href="/record/java/source/" class="nav-link">
  源码
</a></li><li class="dropdown-item"><!----> <a href="/record/java/spring/" class="nav-link">
  spring
</a></li><li class="dropdown-item"><!----> <a href="/record/java/thread/" class="nav-link">
  线程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/middleware/cache/" class="nav-link">
  缓存
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/dubbo/" class="nav-link">
  dubbo
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/es/" class="nav-link">
  es
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/MyBatis/" class="nav-link">
  MyBatis
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/" class="nav-link">
  mysql1
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/database/" class="nav-link">
  mysql2
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/mysql/MySQL/" class="nav-link">
  mysql3
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/" class="nav-link">
  redis1
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/cache/" class="nav-link">
  redis2
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/redis/Redis/" class="nav-link">
  redis3
</a></li><li class="dropdown-item"><!----> <a href="/record/middleware/zk/" class="nav-link">
  zk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="q&amp;a" class="dropdown-title"><span class="title">q&amp;a</span> <span class="arrow down"></span></button> <button type="button" aria-label="q&amp;a" class="mobile-dropdown-title"><span class="title">q&amp;a</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/q&amp;a/interview/" class="nav-link">
  问答
</a></li><li class="dropdown-item"><!----> <a href="/record/q&amp;a/self/" class="nav-link">
  详细
</a></li><li class="dropdown-item"><!----> <a href="/record/q&amp;a/tuji/" class="nav-link">
  突击
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程" class="dropdown-title"><span class="title">课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程" class="mobile-dropdown-title"><span class="title">课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/imocc/design_pattern/" class="nav-link">
  设计模式（慕课）
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/design_pattern_li/" class="nav-link">
  研磨设计模式（李兴华）
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/elasticsearch-core/" class="nav-link">
  ES核心知识篇
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/comdesign/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/record/imocc/elasticsearch-senior/" class="nav-link">
  ES高级知识篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="设计" class="mobile-dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/design/back-end-storage/" class="nav-link">
  后端存储实战
</a></li><li class="dropdown-item"><!----> <a href="/record/design/cache-pdp/" class="nav-link">
  复杂缓存架构
</a></li><li class="dropdown-item"><!----> <a href="/record/design/big-backEnd/" class="nav-link">
  大数据后端
</a></li><li class="dropdown-item"><!----> <a href="/record/design/ddd/" class="nav-link">
  ddd
</a></li><li class="dropdown-item"><!----> <a href="/record/design/distrubuted/" class="nav-link">
  分布式1
</a></li><li class="dropdown-item"><!----> <a href="/record/design/system/" class="nav-link">
  分布式2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="更多" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/important/" class="nav-link">
  重要入口
</a></li><li class="dropdown-item"><!----> <a href="/record/other/" class="nav-link">
  其他
</a></li><li class="dropdown-item"><!----> <a href="/record/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/record/introduce/" class="nav-link">
  本笔记介绍
</a></li></ul></div></div> <a href="https://github.com/txxs/record" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>java8</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/record/java/jdk/Java8/Iterator迭代器到底是什么.html" class="sidebar-link">/java/jdk/Java8/Iterator迭代器到底是什么.html</a></li><li><a href="/record/java/jdk/Java8/Java8-原子弹类之LongAdder源码分析.html" class="sidebar-link">/java/jdk/Java8/Java8-原子弹类之LongAdder源码分析.html</a></li><li><a href="/record/java/jdk/Java8/Java8新特性之Lambda表达式&amp;Stream流&amp;方法引用.html" class="sidebar-link">/java/jdk/Java8/Java8新特性之Lambda表达式&amp;Stream流&amp;方法引用.html</a></li><li><a href="/record/java/jdk/Java8/Java8日期时间API.html" class="sidebar-link">1 背景</a></li><li><a href="/record/java/jdk/Java8/Java8的NIO新文件IO到底有多好用.html" class="sidebar-link">/java/jdk/Java8/Java8的NIO新文件IO到底有多好用.html</a></li><li><a href="/record/java/jdk/Java8/Java8的新日期API.html" class="sidebar-link">1 为什么需要新的日期和时间库？</a></li><li><a href="/record/java/jdk/Java8/Java8集合源码解析-Hashtable源码剖析.html" class="sidebar-link">1 概述</a></li><li><a href="/record/java/jdk/Java8/JAVA-Calendar.html" class="sidebar-link">/java/jdk/Java8/JAVA-Calendar.html</a></li><li><a href="/record/java/jdk/Java8/Java-Map的containsKey(Object-key)和containsValue(Object-value)方法.html" class="sidebar-link">/java/jdk/Java8/Java-Map的containsKey(Object-key)和containsValue(Object-value)方法.html</a></li><li><a href="/record/java/jdk/Java8/Java-泛型解惑之---extends-T-和---super-T-.html" class="sidebar-link">1 为什么要用通配符和边界？</a></li><li><a href="/record/java/jdk/Java8/Java-的注解.html" class="sidebar-link">/java/jdk/Java8/Java-的注解.html</a></li><li><a href="/record/java/jdk/Java8/Java与线程.html" class="sidebar-link">/java/jdk/Java8/Java与线程.html</a></li><li><a href="/record/java/jdk/Java8/Java中Collections-sort()方法的演变.html" class="sidebar-link">/java/jdk/Java8/Java中Collections-sort()方法的演变.html</a></li><li><a href="/record/java/jdk/Java8/Java中正则表达式.html" class="sidebar-link">/java/jdk/Java8/Java中正则表达式.html</a></li><li><a href="/record/java/jdk/Java8/Java中的BlockingQueue.html" class="sidebar-link">/java/jdk/Java8/Java中的BlockingQueue.html</a></li><li><a href="/record/java/jdk/Java8/Java中的VO,PO等.html" class="sidebar-link">/java/jdk/Java8/Java中的VO,PO等.html</a></li><li><a href="/record/java/jdk/Java8/Java中的锁优化.html" class="sidebar-link">/java/jdk/Java8/Java中的锁优化.html</a></li><li><a href="/record/java/jdk/Java8/Java中类型参数“-T-”和无界通配符“---”的区别.html" class="sidebar-link">/java/jdk/Java8/Java中类型参数“-T-”和无界通配符“---”的区别.html</a></li><li><a href="/record/java/jdk/Java8/Java动态代理模式之JDK和Cglib.html" class="sidebar-link">动态代理 V.S 静态代理</a></li><li><a href="/record/java/jdk/Java8/Java反射遇到泛型时的bug.html" class="sidebar-link">1 当反射遇见重载</a></li><li><a href="/record/java/jdk/Java8/Java多线程中join方法的理解.html" class="sidebar-link">/java/jdk/Java8/Java多线程中join方法的理解.html</a></li><li><a href="/record/java/jdk/Java8/Java对象序列化底层原理源码解析.html" class="sidebar-link">What</a></li><li><a href="/record/java/jdk/Java8/Java开发人员必备linux命令.html" class="sidebar-link">/java/jdk/Java8/Java开发人员必备linux命令.html</a></li><li><a href="/record/java/jdk/Java8/Java异常之IllegalMonitorStateException.html" class="sidebar-link">JavaDoc</a></li><li><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html" class="active sidebar-link">/java/jdk/Java8/Java异常机制的最佳实践.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_1-1-历史中所谓的-异常" class="sidebar-link">1.1 历史中所谓的“异常”</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#解决方案" class="sidebar-link">解决方案</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#简单的例子" class="sidebar-link">简单的例子</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#抛出异常后" class="sidebar-link">抛出异常后</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#抛出异常的简单例子" class="sidebar-link">抛出异常的简单例子</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常模型的观点" class="sidebar-link">异常模型的观点</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常参数" class="sidebar-link">异常参数</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_3-1-try-块" class="sidebar-link">3.1 try 块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#意义" class="sidebar-link">意义</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_3-2-异常处理程序-catch-块" class="sidebar-link">3.2 异常处理程序 - catch 块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#意义-2" class="sidebar-link">意义</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_3-3-终止与恢复" class="sidebar-link">3.3 终止与恢复</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_3-3-1-终止模型" class="sidebar-link">3.3.1 终止模型</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_3-3-2-恢复模型" class="sidebar-link">3.3.2 恢复模型</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#无参构造器" class="sidebar-link">无参构造器</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#字符串参数的构造器" class="sidebar-link">字符串参数的构造器</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_4-1-记录日志" class="sidebar-link">4.1 记录日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#捕获和记录其他人编写的异常" class="sidebar-link">捕获和记录其他人编写的异常</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#加入额外构造器和成员" class="sidebar-link">加入额外构造器和成员</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#作弊-的地方" class="sidebar-link">“作弊”的地方</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#_6-1-如何使用-exception-类型" class="sidebar-link">6.1  如何使用 Exception 类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#最佳实践" class="sidebar-link">最佳实践</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#从-throwable-继承的方法" class="sidebar-link">从 Throwable 继承的方法</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#使用案例" class="sidebar-link">使用案例</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#多重捕获" class="sidebar-link">多重捕获</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#栈轨迹" class="sidebar-link">栈轨迹</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#重新抛出异常" class="sidebar-link">重新抛出异常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#精准的重新抛出异常" class="sidebar-link">精准的重新抛出异常</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常链" class="sidebar-link">异常链</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#运行时动态地向-dymamicfields-对象添加字段" class="sidebar-link">运行时动态地向 DymamicFields 对象添加字段</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#特例-runtimeexception" class="sidebar-link">特例：RuntimeException</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#使用-finally-进行清理" class="sidebar-link">使用 finally 进行清理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#finally-用来做什么" class="sidebar-link">finally 用来做什么？</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#在-return-中使用-finally" class="sidebar-link">在 return 中使用 finally</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#缺憾-异常丢失" class="sidebar-link">缺憾：异常丢失</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常限制" class="sidebar-link">异常限制</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#构造器" class="sidebar-link">构造器</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#try-with-resources-用法" class="sidebar-link">Try-With-Resources 用法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#揭示细节" class="sidebar-link">揭示细节</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常匹配" class="sidebar-link">异常匹配</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#其他可选方式" class="sidebar-link">其他可选方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#历史" class="sidebar-link">历史</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#观点" class="sidebar-link">观点</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#把异常传递给控制台" class="sidebar-link">把异常传递给控制台</a></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#把-被检查的异常-转换为-不检查的异常" class="sidebar-link">把“被检查的异常”转换为“不检查的异常”</a></li></ul></li><li class="sidebar-sub-header"><a href="/record/java/jdk/Java8/Java异常机制的最佳实践.html#异常指南" class="sidebar-link">异常指南</a></li></ul></li><li><a href="/record/java/jdk/Java8/Java日志级别，重复记录、丢日志问题.html" class="sidebar-link">1 SLF4J</a></li><li><a href="/record/java/jdk/Java8/Java类的初始化和清理.html" class="sidebar-link">1  不安全的编程是造成编程代价昂贵的主因之一</a></li><li><a href="/record/java/jdk/Java8/Java线程状态.html" class="sidebar-link">/java/jdk/Java8/Java线程状态.html</a></li><li><a href="/record/java/jdk/Java8/Java语法糖之泛型与类型擦除.html" class="sidebar-link">1 泛型与类型擦除</a></li><li><a href="/record/java/jdk/Java8/Java集合源码解析---HashMap.html" class="sidebar-link">1 概述</a></li><li><a href="/record/java/jdk/Java8/一文搞懂Java的SPI机制.html" class="sidebar-link">1 简介</a></li><li><a href="/record/java/jdk/Java8/子类可以继承到父类上的注解吗.html" class="sidebar-link">/java/jdk/Java8/子类可以继承到父类上的注解吗.html</a></li><li><a href="/record/java/jdk/Java8/深入分析-Java-的枚举-enum.html" class="sidebar-link">1 定义</a></li><li><a href="/record/java/jdk/Java8/深入解析Java的注解机制.html" class="sidebar-link">/java/jdk/Java8/深入解析Java的注解机制.html</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><strong>Java 的基本理念是“结构不佳的代码不能运行”。</strong></p> <p>改进的错误恢复机制是提高代码健壮性的最强有力的方式。错误恢复在我们所编写的每一个程序中都是基本的要素，但是在 Java 中它显得格外重要，因为 Java 的主要目标之一就是创建供他人使用的程序构件。</p> <p>发现错误的理想时机是在编译期。然而，编译期并不能找出所有错误，余下问题必须在运行时解决。这就需要错误源能通过某种方式，把适当的信息传递给知道如何正确处理这个问题的接收者。</p> <blockquote><p>要想创建健壮的系统，它的每一个构件都必须是健壮的。</p></blockquote> <p>Java 使用异常来提供一致的错误报告模型，使得构件能够与客户端代码可靠地沟通问题。</p> <ul><li>Java 中的异常处理的目的
通过使用少于目前数量的代码来简化大型、可靠的程序的生成，并且通过这种方式可以使你更加确信你的应用中没有未处理的错误。异常的相关知识学起来并非艰涩难懂，并且它属于那种可以使你的项目受益明显、立竿见影的特性。</li></ul> <p>因为异常处理是 Java 中唯一官方的错误报告机制，并且通过编译器强制执行，所以不学习异常处理的话，也就只能写出那么些例子了。本章重在如何编写正确的异常处理程序，当方法出问题的时候，如何产生自定义的异常。</p> <h1 id="_1-异常概念"><a href="#_1-异常概念" class="header-anchor">#</a> 1 异常概念</h1> <h2 id="_1-1-历史中所谓的-异常"><a href="#_1-1-历史中所谓的-异常" class="header-anchor">#</a> 1.1 历史中所谓的“异常”</h2> <p>C 以及其他早期语言常常具有多种错误处理模式，这些模式往往建立在约定俗成的基础上，并不属于语言规范。</p> <p>通常是会返回某个特殊值或者设置某个标志，并且假定接收者将对这个返回值或标志进行检查，以判定是否发生了错误。
然而，随着时间的推移，人们发现，高傲的程序员们在使用程序库的时候更倾向于认为：“对，错误也许会发生，但那是别人造成的，不关我的事”。所以，程序员不去检查错误情形也就不足为奇了（对某些错误情形的检查确实无聊）。如果的确在每次调用方法的时候都彻底地进行错误检查，代码很可能会变得难以阅读。
正是由于程序员还仍然用这些方式拼凑系统，所以他们拒绝承认这样一个事实：对于构造大型、健壮、可维护的程序而言，这种错误处理模式已经成为了主要障碍。</p> <h2 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h2> <p>强制规定形式，来消除错误处理过程中的随心所欲。
这种做法由来已久，对异常处理的实现可以追溯到1960s的操作系统，甚至BASIC中的“on error goto”语句。C++的异常处理机制基于 Ada，Java 中的异常处理机制则建立在 C++ 的基础上。</p> <p>“异常”这个词有“我对此感到意外”的意思。问题出现你也许不清楚如何处理，但你知道不该置之不理，你要停下来看看是不是有地方能够处理这个问题。
只是在当前的环境中还没有足够的信息来解决这个问题，所以就把这个问题提交到一个更高级别的环境中，在那里将作出正确的决定。</p> <p>异常往往能降低错误处理代码的复杂度。
如果不使用异常，那么就必须检查特定的错误，并在程序中的许多地方去处理它。而如果使用异常，那就不必在方法调用处检查，因为异常机制将保证能够捕获这个错误。理想情况下，只需在一个地方处理错误，即所谓的异常处理程序。
这种方式不仅节省代码，而且把“描述在正常执行过程中做什么事”的代码和“出了问题怎么办”的代码相分离。总之，与以前的错误处理方法相比，异常机制使代码的阅读、编写和调试工作更加井井有条。</p> <h1 id="_2-基本异常"><a href="#_2-基本异常" class="header-anchor">#</a> 2 基本异常</h1> <p>注意把异常情形与普通问题相区分：</p> <ul><li>普通问题
在当前环境下能得到足够的信息，总能处理这个错误</li> <li>异常情形（exceptional condition）
阻止当前方法或作用域继续执行，就不能继续下去了，因为在当前环境下无法获得必要的信息来解决问题。你所能做的就是从当前环境跳出，并且把问题提交给上一级环境。这就是抛出异常时所发生的事情。</li></ul> <h2 id="简单的例子"><a href="#简单的例子" class="header-anchor">#</a> 简单的例子</h2> <p>除法就是一个除数有可能为 0，所以先进行检查很有必要。
但除数为 0 代表的究竟是什么意思呢？通过当前正在解决的问题环境，或许能知道该如何处理除数为 0 的情况。但如果这是一个意料之外的值，你也不清楚该如何处理，那就要抛出异常，而不是顺着原来的路径继续执行下去。</p> <h2 id="抛出异常后"><a href="#抛出异常后" class="header-anchor">#</a> 抛出异常后</h2> <ol><li>同 Java 中其他对象的创建一样，将使用 new 在堆上创建异常对象</li> <li>当前的执行路径（无法继续）被终止，并且从当前环境中弹出对异常对象的引用</li> <li>异常处理机制接管程序，并开始寻找一个恰当的地方来继续执行程序。这个恰当的地方就是异常处理程序，它的任务是将程序从错误状态中恢复，以使程序能要么换一种方式运行，要么继续运行下去。</li></ol> <h2 id="抛出异常的简单例子"><a href="#抛出异常的简单例子" class="header-anchor">#</a> 抛出异常的简单例子</h2> <p>对于对象引用 t，传给你可能尚未初始化。所以在使用这个对象引用调用其方法之前，会先对引用进行检查。可以创建一个代表错误信息的对象，并且将它从当前环境中“抛出”，这样就把错误信息传播到了“更大”的环境中。
这被称为<em>抛出一个异常</em>，看起来像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这就抛出了异常，于是在当前环境下就不必再为这个问题操心了，它将在别的地方得到处理。</p> <h2 id="异常模型的观点"><a href="#异常模型的观点" class="header-anchor">#</a> 异常模型的观点</h2> <ul><li>异常使得我们可以将每件事都当作一个事务来考虑，而异常可以看护着这些事务的底线，事务的基本保障是我们所需的在分布式计算中的异常处理。事务是计算机中的合同法，如果出了什么问题，我们只需要放弃整个计算</li> <li>我们还可以将异常看作是一种内建的撤销系统，因为（在细心使用的情况下）我们在程序中可以拥有各种不同的撤销点。如果程序的某部分失败了，异常将撤销到程序中某个已知的稳定点上。</li></ul> <p>异常最重要的方面之一就是如果发生问题，它们将不允许程序沿着其正常的路径继续走下去。在 C 和 C++ 这样的语言中，这可真是个问题，尤其是 C，它没有任何办法可以强制程序在出现问题时停止在某条路径上运行下去，因此我们有可能会较长时间地忽略问题，从而会陷入完全不恰当的状态中。异常允许我们（如果没有其他手段）强制程序停止运行，并告诉我们出现了什么问题，或者（理想状态下）强制程序处理问题，并返回到稳定状态。</p> <h2 id="异常参数"><a href="#异常参数" class="header-anchor">#</a> 异常参数</h2> <p>与使用 Java 中的其他对象一样，用 new 在堆上创建异常对象，这也伴随着存储空间的分配和构造器的调用。
所有标准异常类都有两个构造器：</p> <ul><li>无参构造器</li> <li>接受字符串作为参数，以便能把相关信息放入异常对象构造器</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;t = null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>关键字 <strong>throw</strong> 将产生许多有趣的结果。在使用 <strong>new</strong> 创建了异常对象之后，此对象的引用将传给 <strong>throw</strong>。
尽管异常对象的类型通常与方法设计的返回类型不同，但从效果上看，它就像是从方法“返回”的。可以简单地把异常处理看成一种不同的返回机制，当然若过分强调这种类比的话，就会有麻烦了。
另外还能用抛出异常的方式从当前的作用域退出。在这两种情况下，将会返回一个异常对象，然后退出方法或作用域。</p> <p>抛出异常与方法正常返回的相似之处到此为止。因为异常返回的“地点”与普通方法调用返回的“地点”完全不同。
异常将在一个恰当的异常处理程序中得到解决，它的位置可能离异常被抛出的地方很远，也可能会跨越方法调用栈的许多层级。</p> <p>此外，能够抛出任意类型的 <strong>Throwable</strong> 对象，它是异常类型的根类。通常，对于不同类型错误，要抛相应异常。错误信息可以保存在异常对象内部或者用异常类的名称来暗示。上一层环境通过这些信息来决定如何处理异常。</p> <blockquote><p>通常，唯一的信息只有异常的类型名，而在异常对象内部没有任何有意义的信息</p></blockquote> <h1 id="_3-异常捕获"><a href="#_3-异常捕获" class="header-anchor">#</a> 3 异常捕获</h1> <ul><li>首先要理解监控区域（guarded region）的概念
它是一段可能产生异常的代码，并且后面跟着处理这些异常的代码。</li></ul> <h2 id="_3-1-try-块"><a href="#_3-1-try-块" class="header-anchor">#</a> 3.1 try 块</h2> <p>如果在方法内部抛异常（或在方法内部调用的其他方法抛异常），该方法将在抛异常过程中结束。要是不希望方法就此结束，可在方法内设置一个特殊的块来捕获异常。因为在这个块里“尝试”各种（可能产生异常的）方法调用，所以称为 try 块。它是跟在 try 关键字之后的普通程序块：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Code that might generate exceptions</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="意义"><a href="#意义" class="header-anchor">#</a> 意义</h3> <p>对于不支持异常处理的程序语言，要想仔细检查错误，就得在每个方法调用的前后加上设置和错误检查的代码，甚至在每次调用同一方法时也得这么做。
有了异常处理机制，可以把所有动作都放在 try 块，然后只需在一个地方就可以捕获所有异常。这意味着你的代码将更容易编写和阅读，因为代码的意图和错误检查不是混淆在一起。</p> <h2 id="_3-2-异常处理程序-catch-块"><a href="#_3-2-异常处理程序-catch-块" class="header-anchor">#</a> 3.2 异常处理程序 - catch 块</h2> <p>抛出的异常必须在 异常处理程序 得到处理。针对每个要捕获的异常，得准备相应的处理程序。
异常处理程序紧跟在 try 块之后，以关键字 catch 表示：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Code that might generate exceptions</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Type1</span> id1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle exceptions of Type1</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Type2</span> id2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle exceptions of Type2</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Type3</span> id3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle exceptions of Type3</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>每个 catch （异常处理程序）看起来就像是接收且仅接收一个特殊类型的参数的方法。可以在处理程序的内部使用标识符（id1，id2 等等），这与方法参数的使用很相似。有时可能用不到标识符，因为异常的类型已经给了你足够的信息来对异常进行处理，但标识符并不可以省略。</p> <p>异常处理程序必须紧跟在 try 块后。当异常被抛出时，异常处理机制将负责搜寻参数与异常类型相匹配的第一个处理程序。然后进入 catch 子句执行，此时认为异常得到了处理。
一旦 catch 子句结束，则处理程序的查找过程结束。注意，只有匹配的 catch 子句才能得到执行。</p> <h3 id="意义-2"><a href="#意义-2" class="header-anchor">#</a> 意义</h3> <p>注意在 try 块的内部，许多不同的方法调用可能会产生类型相同的异常，而你只需要提供一个针对此类型的异常处理程序。</p> <h2 id="_3-3-终止与恢复"><a href="#_3-3-终止与恢复" class="header-anchor">#</a> 3.3 终止与恢复</h2> <p>异常处理理论上有两种基本模型。</p> <h3 id="_3-3-1-终止模型"><a href="#_3-3-1-终止模型" class="header-anchor">#</a> 3.3.1 终止模型</h3> <p>Java 和 C++所支持的模型。
将假设错误非常严重，以至于程序无法返回到异常发生的地方继续执行。一旦异常被抛出，就表明错误无法挽回。</p> <h3 id="_3-3-2-恢复模型"><a href="#_3-3-2-恢复模型" class="header-anchor">#</a> 3.3.2 恢复模型</h3> <p>异常处理程序的工作是修正错误，然后重新尝试调用出问题的方法，并认为第二次能成功。对于恢复模型，通常希望异常被处理之后能继续执行程序。
如果想要用 Java 实现类似恢复的行为</p> <ul><li>那么在遇见错误时就不能抛出异常，而是调用方法来修正该错误</li> <li>或者把 try 块放在 while 循环里，这样就不断地进入 try 块，直到得到满意的结果</li></ul> <h4 id="缺陷"><a href="#缺陷" class="header-anchor">#</a> 缺陷</h4> <p>在过去，使用支持恢复模型异常处理的操作系统的程序员们最终还是转向使用类似“终止模型”的代码，并且忽略恢复行为。所以虽然恢复模型开始显得很吸引人，但不是很实用。其中的主要原因可能是它所导致的耦合：恢复性的处理程序需要了解异常抛出的地点，这势必要包含依赖于抛出位置的非通用性代码。这增加了代码编写和维护的困难，对于异常可能会从许多地方抛出的大型程序来说，更是如此。</p> <h1 id="_4-自定义异常"><a href="#_4-自定义异常" class="header-anchor">#</a> 4 自定义异常</h1> <p>Java 提供的异常体系不可能预见所有的希望加以报告的错误，所以可自己定义异常类。</p> <p>必须从已有的异常类继承，最好是选择意思相近的异常类继承（不过并不容易找）。建立新的异常类型最简单的方法就是让编译器为你产生</p> <h2 id="无参构造器"><a href="#无参构造器" class="header-anchor">#</a> 无参构造器</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">SimpleException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InheritingExceptions</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SimpleException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Throw SimpleException from f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SimpleException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">InheritingExceptions</span> sed <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">InheritingExceptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            sed<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">SimpleException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught it!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Throw SimpleException from f()
Caught it!
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>编译器创建了无参构造器，它将自动调用基类的无参构造器。<strong>对异常来说，最重要的部分就是类名</strong>。</p> <h2 id="字符串参数的构造器"><a href="#字符串参数的构造器" class="header-anchor">#</a> 字符串参数的构造器</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FullConstructors</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MyException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Throwing MyException from f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MyException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Throwing MyException from g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token string">&quot;Originated in g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">MyException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">MyException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Throwing MyException from f()
MyException
    at FullConstructors.f(FullConstructors.java:11)
    at
FullConstructors.main(FullConstructors.java:19)
Throwing MyException from g()
MyException: Originated in g()
    at FullConstructors.g(FullConstructors.java:15)
    at
FullConstructors.main(FullConstructors.java:24)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>新增的代码非常简短：两个构造器定义了 MyException 类型对象的创建方式。对于第二个构造器，使用 super 关键字明确调用了其基类构造器，它接受一个字符串作为参数。</p> <p>在异常处理程序中，调用了在 Throwable 类声明（Exception 即从此类继承）的 printStackTrace() 方法。就像从输出中看到的，它将打印“从方法调用处直到异常抛出处”的方法调用序列。这里，信息被发送到了 System.out，并自动地被捕获和显示在输出中。但是，如果调用默认版本：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>信息就会被输出到标准错误流。</p> <h2 id="_4-1-记录日志"><a href="#_4-1-记录日志" class="header-anchor">#</a> 4.1 记录日志</h2> <ul><li>使用 java.util.logging 工具将输出记录到日志
<img src="https://img-blog.csdnimg.cn/20200601011616774.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""></li> <li>输出
<img src="https://img-blog.csdnimg.cn/20200601011710120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""></li></ul> <p>直接调用与日志记录消息的级别相关联的方法，这里是 severe()。
为了产生日志记录消息，要获取异常抛出处的栈轨迹，但是 printStackTrace() 不会默认地产生字符串。为了获取字符串，我们需要使用重载的 printStackTrace() 方法，它接受一个 java.io.PrintWriter 对象作为参数（PrintWriter 会在。如果我们将一个 java.io.StringWriter 对象传递给这个 PrintWriter 的构造器，那么通过调用 toString() 方法，就可以将输出抽取为一个 String。</p> <p>尽管由于 LoggingException 将所有记录日志的基础设施都构建在异常自身中，使得它所使用的方式非常方便，并因此不需要客户端程序员的干预就可以自动运行。</p> <h3 id="捕获和记录其他人编写的异常"><a href="#捕获和记录其他人编写的异常" class="header-anchor">#</a> 捕获和记录其他人编写的异常</h3> <p>必须在异常处理程序中生成日志消息
<img src="https://img-blog.csdnimg.cn/20200601012419331.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""></p> <ul><li>结果
<img src="https://img-blog.csdnimg.cn/20200601012506770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""></li></ul> <h3 id="加入额外构造器和成员"><a href="#加入额外构造器和成员" class="header-anchor">#</a> 加入额外构造器和成员</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyException2</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Detail Message: &quot;</span><span class="token operator">+</span> x
                <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token operator">+</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExtraFeatures</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MyException2</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Throwing MyException2 from f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MyException2</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Throwing MyException2 from g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token string">&quot;Originated in g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MyException2</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Throwing MyException2 from h()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException2</span><span class="token punctuation">(</span><span class="token string">&quot;Originated in h()&quot;</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">MyException2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">MyException2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">MyException2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;e.val() = &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Throwing MyException2 from f()
MyException2: Detail Message: 0 null
at ExtraFeatures.f(ExtraFeatures.java:24)
at ExtraFeatures.main(ExtraFeatures.java:38)
Throwing MyException2 from g()
MyException2: Detail Message: 0 Originated in g()
at ExtraFeatures.g(ExtraFeatures.java:29)
at ExtraFeatures.main(ExtraFeatures.java:43)
Throwing MyException2 from h()
MyException2: Detail Message: 47 Originated in h()
at ExtraFeatures.h(ExtraFeatures.java:34)
at ExtraFeatures.main(ExtraFeatures.java:48)
e.val() = 47
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>新的异常添加了字段 x 以及设定 x 值的构造器和读取数据的方法。此外，还覆盖了 Throwable.
getMessage() 方法，以产生更详细的信息。对于异常类来说，getMessage() 方法有点类似于 toString() 方法。</p> <blockquote><p>既然异常也是对象的一种，所以可以继续修改这个异常类，以得到更强的功能。但要记住，使用程序包的客户端程序员可能仅仅只是查看一下抛出的异常类型，其他的就不管了（大多数 Java 库里的异常都是这么用的），所以对异常所添加的其他功能也许根本用不上。</p></blockquote> <h1 id="_5-异常声明"><a href="#_5-异常声明" class="header-anchor">#</a> 5 异常声明</h1> <p>Java 鼓励把方法可能会抛出的异常告知使用此方法的客户端程序员。这是种优雅的做法，它使得调用者能确切知道写什么样的代码可以捕获所有潜在的异常。</p> <p>当然，如果提供了源代码，客户端程序员可以在源代码中查找 throw 语句来获知相关信息，然而程序库通常并不与源代码一起发布。为了预防这样的问题，Java 提供了相应的语法（并强制使用这个语法），使你能以礼貌的方式告知客户端程序员某个方法可能会抛出的异常类型，然后客户端程序员就可以进行相应的处理。这就是异常说明，它属于方法声明的一部分，紧跟在形式参数列表之后。</p> <p>异常说明使用了附加的关键字 throws，后面接一个所有潜在异常类型的列表，所以方法定义可能看起来像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TooBig</span><span class="token punctuation">,</span> <span class="token class-name">TooSmall</span><span class="token punctuation">,</span> <span class="token class-name">DivZero</span> <span class="token punctuation">{</span> <span class="token comment">// ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但要是这样写：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就表示此方法不会抛任何异常。</p> <p>代码必须与异常说明保持一致。如果方法里的代码产生了异常却没有进行处理，编译器会发现这个问题并提醒你：</p> <ul><li>要么处理这个异常</li> <li>要么就在异常说明中表明此方法将产生异常</li></ul> <p>通过这种自顶向下强制执行的异常说明机制，Java 在编译时就可以保证一定的异常正确性。</p> <h2 id="作弊-的地方"><a href="#作弊-的地方" class="header-anchor">#</a> “作弊”的地方</h2> <p>可以声明方法将抛异常，实际上却不抛出。编译器相信了这个声明，并强制此方法的用户像真的抛出异常那样使用这个方法。这样做的好处是，为异常先占个位子，以后就可以抛出这种异常而不用修改已有的代码。在定义抽象基类和接口时这种能力很重要，这样派生类或接口实现就能够抛出这些预先声明的异常。</p> <p><strong>这种在编译时被强制检查的异常称为被检查的异常。</strong></p> <h1 id="_6-捕获所有异常"><a href="#_6-捕获所有异常" class="header-anchor">#</a> 6 捕获所有异常</h1> <h2 id="_6-1-如何使用-exception-类型"><a href="#_6-1-如何使用-exception-类型" class="header-anchor">#</a> 6.1  如何使用 Exception 类型</h2> <p>可以只写一个异常处理程序来捕获所有类型的异常。
通过捕获异常类型的基类 Exception 即可：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught an exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践</h3> <p>它会捕获所有异常，所以最好把它<strong>放在处理程序列表的末尾</strong>，以防它抢在其他处理程序之前先把异常捕获了。</p> <h3 id="从-throwable-继承的方法"><a href="#从-throwable-继承的方法" class="header-anchor">#</a> 从 Throwable 继承的方法</h3> <p>因为 Exception 是与编程有关的所有异常类的基类，不含太多具体信息，但可以调用它从其基类 Throwable 继承的方法：</p> <ul><li>String getMessage()
<img src="https://img-blog.csdnimg.cn/20200601013145686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""> <img src="https://img-blog.csdnimg.cn/20200601013121753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt=""></li></ul> <p><img src="https://img-blog.csdnimg.cn/20200601013208907.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70" alt="">
用来获取详细信息，或用本地语言表示的详细信息。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回对 Throwable 的简单描述，要是有详细信息的话，也会把它包含在内。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">PrintStream</span><span class="token punctuation">)</span>
<span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>PrintWriter</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>打印 Throwable 和 Throwable 的调用栈轨迹。调用栈显示了“把你带到异常抛出地点”的方法调用序列。其中第一个版本输出到标准错误，后两个版本允许选择要输出的流。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Throwable</span> <span class="token function">fillInStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>用于在 Throwable 对象的内部记录栈帧的当前状态。这在程序重新抛出错误或异常时很有用。</p> <p>此外，也可以使用 Throwable 从其基类 Object（也是所有类的基类）继承的方法。对于异常来说，getClass）也许是个很好用的方法，它将返回一个表示此对象类型的对象。然后可以使用 getName）方法查询这个 Class 对象包含包信息的名称，或者使用只产生类名称的 getSimpleName() 方法。</p> <h3 id="使用案例"><a href="#使用案例" class="header-anchor">#</a> 使用案例</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExceptionMethods</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;My Exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught Exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;getMessage():&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getLocalizedMessage():&quot;</span> <span class="token operator">+</span>
                    e<span class="token punctuation">.</span><span class="token function">getLocalizedMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;toString():&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;printStackTrace():&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Caught</span> <span class="token class-name">Exception</span>
<span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name">My</span> <span class="token class-name">Exception</span>
<span class="token function">getLocalizedMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name">My</span> <span class="token class-name">Exception</span>
<span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> <span class="token class-name">My</span> <span class="token class-name">Exception</span>
<span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> <span class="token class-name">My</span> <span class="token class-name">Exception</span>
at
<span class="token class-name">ExceptionMethods</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">ExceptionMethods</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>可以发现每个方法都比前一个提供了更多的信息一一实际上它们每一个都是前一个的超集。</p> <h2 id="多重捕获"><a href="#多重捕获" class="header-anchor">#</a> 多重捕获</h2> <p>如果有一组具有相同基类的异常，你想使用同一方式进行捕获，那你直接 catch 它们的基类型。但是，如果这些异常没有共同的基类型，在 Java 7 之前，你必须为每一个类型编写一个 catch：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/SameHandler.java</span>
<span class="token keyword">class</span> <span class="token class-name">EBase1</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Except1</span> <span class="token keyword">extends</span> <span class="token class-name">EBase1</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">EBase2</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Except2</span> <span class="token keyword">extends</span> <span class="token class-name">EBase2</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">EBase3</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Except3</span> <span class="token keyword">extends</span> <span class="token class-name">EBase3</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">EBase4</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Except4</span> <span class="token keyword">extends</span> <span class="token class-name">EBase4</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SameHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Except1</span><span class="token punctuation">,</span> <span class="token class-name">Except2</span><span class="token punctuation">,</span> <span class="token class-name">Except3</span><span class="token punctuation">,</span> <span class="token class-name">Except4</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except1</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except3</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except4</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>通过 Java 7 的多重捕获机制，你可以使用“或”将不同类型的异常组合起来，只需要一行 catch 语句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/MultiCatch.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MultiCatch</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Except1</span><span class="token punctuation">,</span> <span class="token class-name">Except2</span><span class="token punctuation">,</span> <span class="token class-name">Except3</span><span class="token punctuation">,</span> <span class="token class-name">Except4</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except1</span> <span class="token operator">|</span> <span class="token class-name">Except2</span> <span class="token operator">|</span> <span class="token class-name">Except3</span> <span class="token operator">|</span> <span class="token class-name">Except4</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>或者以其他的组合方式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/MultiCatch2.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MultiCatch2</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Except1</span><span class="token punctuation">,</span> <span class="token class-name">Except2</span><span class="token punctuation">,</span> <span class="token class-name">Except3</span><span class="token punctuation">,</span> <span class="token class-name">Except4</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">process1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">process2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except1</span> <span class="token operator">|</span> <span class="token class-name">Except2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Except3</span> <span class="token operator">|</span> <span class="token class-name">Except4</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">process2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>这对书写更整洁的代码很有帮助。</p> <h2 id="栈轨迹"><a href="#栈轨迹" class="header-anchor">#</a> 栈轨迹</h2> <p>printStackTrace() 方法所提供的信息可以通过 getStackTrace() 方法来直接访问，这个方法将返回一个由栈轨迹中的元素所构成的数组，其中每一个元素都表示栈中的一桢。元素 0 是栈顶元素，并且是调用序列中的最后一个方法调用（这个 Throwable 被创建和抛出之处）。数组中的最后一个元素和栈底是调用序列中的第一个方法调用。下面的程序是一个简单的演示示例：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/WhoCalled.java</span>
<span class="token comment">// Programmatic access to stack trace information</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WhoCalled</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Generate an exception to fill in the stack trace</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">StackTraceElement</span> ste <span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token function">getStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ste<span class="token punctuation">.</span><span class="token function">getMethodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*******&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*******&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>f
main
*******
f
g
main
*******
f
g
h
main
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这里，我们只打印了方法名，但实际上还可以打印整个 StackTraceElement，它包含其他附加的信息。</p> <h2 id="重新抛出异常"><a href="#重新抛出异常" class="header-anchor">#</a> 重新抛出异常</h2> <p>有时希望把刚捕获的异常重新抛出，尤其是在使用 Exception 捕获所有异常的时候。既然已经得到了对当前异常对象的引用，可以直接把它重新抛出：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;An exception was thrown&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>重抛异常会把异常抛给上一级环境中的异常处理程序，同一个 <code>try</code> 块的后续 <code>catch</code> 子句将被忽略。此外，异常对象的所有信息都得以保持，所以较高一级环境中捕获此异常的处理程序可以从这个异常对象中得到所有信息。</p> <p>若只是把当前异常对象重新抛出，那么</p> <ul><li><code>printStackTrace()</code> 方法显示的将是原来异常抛出点的调用栈信息，而非重新抛出点的信息。
<img src="https://img-blog.csdnimg.cn/20201112135659805.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70#pic_center" alt="">
要想更新该信息，可调用 <code>filInStackTrace()</code> 方法，这将返回一个 Throwable 对象，它是通过把当前调用栈信息填入原来那个异常对象而建立的。
<img src="https://img-blog.csdnimg.cn/20201112135854256.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70#pic_center" alt=""></li></ul> <p>就像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rethrowing</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;originating the exception in f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;thrown from f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Inside g(), e.printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Inside h(), e.printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span><span class="token function">fillInStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main: printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main: printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>originating the exception in <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Inside</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> thrown from <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">32</span><span class="token punctuation">)</span>
main<span class="token operator">:</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> thrown from <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">32</span><span class="token punctuation">)</span>
originating the exception in <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Inside</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> thrown from <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">38</span><span class="token punctuation">)</span>
main<span class="token operator">:</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Exception</span><span class="token operator">:</span> thrown from <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">27</span><span class="token punctuation">)</span>
at <span class="token class-name">Rethrowing</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">Rethrowing</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">38</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>调用 <code>fillInStackTrace</code> 的那一行就成了异常的新发生地。</p> <p>有可能在捕获异常之后抛出另一种异常。这么做的话，得到的效果类似于使用 filInStackTrace()，有关原来异常发生点的信息会丢失，剩下的是与新的抛出点有关的信息：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/RethrowNew.java</span>
<span class="token comment">// Rethrow a different object from the one you caught</span>
<span class="token keyword">class</span> <span class="token class-name">OneException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">OneException</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">TwoException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">TwoException</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RethrowNew</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">OneException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;originating the exception in f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OneException</span><span class="token punctuation">(</span><span class="token string">&quot;thrown from f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">OneException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                        <span class="token string">&quot;Caught in inner try, e.printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TwoException</span><span class="token punctuation">(</span><span class="token string">&quot;from inner try&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">TwoException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Caught in outer try, e.printStackTrace()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>originating the exception in <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Caught</span> in inner <span class="token keyword">try</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">OneException</span><span class="token operator">:</span> thrown from <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">RethrowNew</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token class-name">RethrowNew</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span>
at <span class="token class-name">RethrowNew</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">RethrowNew</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">)</span>
<span class="token class-name">Caught</span> in outer <span class="token keyword">try</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">TwoException</span><span class="token operator">:</span> from inner <span class="token keyword">try</span>
at <span class="token class-name">RethrowNew</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">RethrowNew</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>最后那个异常仅知道自己来自 main()，而对 f() 一无所知。</p> <p>永远不必为清理前一个异常对象而担心，或者说为异常对象的清理而担心。它们都是用 new 在堆上创建的对象，所以垃圾回收器会自动把它们清理掉。</p> <h3 id="精准的重新抛出异常"><a href="#精准的重新抛出异常" class="header-anchor">#</a> 精准的重新抛出异常</h3> <p>在 Java 7 前，若遇到异常，则只能重新抛出该类型的异常。这导致在 Java 7 中修复的代码不精确。所以在 Java 7 前，这无法编译：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">BaseException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">DerivedException</span> <span class="token keyword">extends</span> <span class="token class-name">BaseException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PreciseRethrow</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">catcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DerivedException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">DerivedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">BaseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>因为 catch 捕获了一个 BaseException，编译器强迫你声明 catcher() 抛出 BaseException，即使它实际上抛出了更具体的 DerivedException。从 Java 7 开始，这段代码就可以编译，这是一个很小但很有用的修复。</p> <h3 id="异常链"><a href="#异常链" class="header-anchor">#</a> 异常链</h3> <p>想要在捕获一个异常后抛出另一个异常，并且希望把原始异常的信息保存下来，这被称为异常链。
JDK1.4 前，程序员必须自己编写代码保存原始异常的信息。现在所有 Throwable 的子类在构造器中都可接收一个 cause 对象作为参数，表示原始异常，这样通过把原始异常传递给新的异常，使得即使在当前位置创建并抛出了新的异常，也能通过这个异常链追踪到异常最初发生的位置。</p> <p>在 Throwable 的子类中，只有三种基本的异常类提供了带 cause 参数的构造器：</p> <ul><li>Error（用于 Java 虚拟机报告系统错误）</li> <li>Exception</li> <li>RuntimeException</li></ul> <p>如果要把其他类型的异常链接起来，应该使用 initCause() 而非构造器。</p> <h3 id="运行时动态地向-dymamicfields-对象添加字段"><a href="#运行时动态地向-dymamicfields-对象添加字段" class="header-anchor">#</a> 运行时动态地向 DymamicFields 对象添加字段</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// A Class that dynamically adds fields to itself to</span>
<span class="token comment">// demonstrate exception chaining</span>
<span class="token keyword">class</span> <span class="token class-name">DynamicFieldsException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicFields</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">DynamicFields</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fields <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>initialSize<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> initialSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> obj <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">hasField</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getFieldNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">NoSuchFieldException</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> fieldNum <span class="token operator">=</span> <span class="token function">hasField</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>fieldNum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchFieldException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fieldNum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">makeField</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> id<span class="token punctuation">;</span>
                <span class="token keyword">return</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token comment">// No empty fields. Add one:</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>fields<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tmp<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        fields <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
<span class="token comment">// Recursive call with expanded fields:</span>
        <span class="token keyword">return</span> <span class="token function">makeField</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span>
    <span class="token function">getField</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchFieldException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fields<span class="token punctuation">[</span><span class="token function">getFieldNumber</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">setField</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">DynamicFieldsException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Most exceptions don't have a &quot;cause&quot;</span>
<span class="token comment">// constructor. In these cases you must use</span>
<span class="token comment">// initCause(), available in all</span>
<span class="token comment">// Throwable subclasses.</span>
            <span class="token class-name">DynamicFieldsException</span> dfe <span class="token operator">=</span>
                    <span class="token keyword">new</span> <span class="token class-name">DynamicFieldsException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dfe<span class="token punctuation">.</span><span class="token function">initCause</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> dfe<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> fieldNumber <span class="token operator">=</span> <span class="token function">hasField</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>fieldNumber <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            fieldNumber <span class="token operator">=</span> <span class="token function">makeField</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token function">getField</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get old value</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NoSuchFieldException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Use constructor that takes &quot;cause&quot;:</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        fields<span class="token punctuation">[</span>fieldNumber<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DynamicFields</span> df <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DynamicFields</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A value for d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;number2&quot;</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">;</span>
            df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A new value for d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;number3&quot;</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;df: &quot;</span> <span class="token operator">+</span> df<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;df.getField(\&quot;d\&quot;) : &quot;</span>
                    <span class="token operator">+</span> df<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> field <span class="token operator">=</span>
                    df<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Exception</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NoSuchFieldException</span> <span class="token operator">|</span>
                <span class="token class-name">DynamicFieldsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">null</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token keyword">null</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token keyword">null</span><span class="token operator">:</span> <span class="token keyword">null</span>
d<span class="token operator">:</span> <span class="token class-name">A</span> value <span class="token keyword">for</span> d
number<span class="token operator">:</span> <span class="token number">47</span>
number2<span class="token operator">:</span> <span class="token number">48</span>
df<span class="token operator">:</span> d<span class="token operator">:</span> <span class="token class-name">A</span> <span class="token keyword">new</span> value <span class="token keyword">for</span> d
number<span class="token operator">:</span> <span class="token number">47</span>
number2<span class="token operator">:</span> <span class="token number">48</span>
number3<span class="token operator">:</span> <span class="token number">11</span>
df<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">A</span> <span class="token keyword">new</span> value <span class="token keyword">for</span> d
<span class="token class-name">DynamicFieldsException</span>
at
<span class="token class-name">DynamicFields</span><span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token class-name">DynamicFields</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">65</span><span class="token punctuation">)</span>
at <span class="token class-name">DynamicFields</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">DynamicFields</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">97</span><span class="token punctuation">)</span>
<span class="token class-name">Caused</span> by<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>NullPointerException</span>
at
<span class="token class-name">DynamicFields</span><span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span><span class="token class-name">DynamicFields</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">67</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1</span> more
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>每个 DynamicFields 对象都含有一个数组，其元素是“成对的对象”。第一个对象表示字段标识符（一个字符串），第二个表示字段值，值的类型可以是除基本类型外的任意类型。当创建对象的时候，要合理估计一下需要多少字段。当调用 setField() 方法的时候，它将试图通过标识修改已有字段值，否则就建一个新的字段，并把值放入。如果空间不够了，将建立一个更长的数组，并把原来数组的元素复制进去。如果你试图为字段设置一个空值，将抛出一个 DynamicFieldsException 异常，它是通过使用 initCause() 方法把 NullPointerException 对象插入而建立的。</p> <p>至于返回值，setField() 将用 getField() 方法把此位置的旧值取出，这个操作可能会抛出 NoSuchFieldException 异常。如果客户端程序员调用了 getField() 方法，那么他就有责任处理这个可能抛出的 NoSuchFieldException 异常，但如果异常是从 setField0 方法抛出，这种情况将被视为编程错误，所以就使用接受 cause 参数的构造器把 NoSuchFieldException 异常转换为 RuntimeException 异常。</p> <p>主方法中的 catch 子句看起来不同 - 它使用相同的子句处理两种不同类型的异常，并结合“或（|）”符号。此 Java 7 功能有助于减少代码重复，并使你更容易指定要捕获的确切类型，而不是简单地捕获基本类型。你可以通过这种方式组合多种异常类型。</p> <h1 id="java-标准异常"><a href="#java-标准异常" class="header-anchor">#</a> Java 标准异常</h1> <p>Throwable 这个 Java 类被用来表示任何可以作为异常被抛出的类。Throwable 对象可分为两种类型（指从 Throwable 继承而得到的类型）：Error 用来表示编译时和系统错误（除特殊情况外，一般不用你关心）；Exception 是可以被抛出的基本类型，在 Java 类库、用户方法以及运行时故障中都可能抛出 Exception 型异常。所以 Java 程序员关心的基类型通常是 Exception。要想对异常有全面的了解，最好去浏览一下 HTML 格式的 Java 文档（可以从 java.sun.com 下载）。为了对不同的异常有个感性的认识，这么做是值得的。但很快你就会发现，这些异常除了名称外其实都差不多。同时，Java 中异常的数目在持续增加，所以在书中简单罗列它们毫无意义。所使用的第三方类库也可能会有自己的异常。对异常来说，关键是理解概念以及如何使用。</p> <p>异常的基本的概念是用名称代表发生的问题，并且异常的名称应该可以望文知意。异常并非全是在 java.lang 包里定义的；有些异常是用来支持其他像 util、net 和 io 这样的程序包，这些异常可以通过它们的完整名称或者从它们的父类中看出端倪。比如，所有的输入/输出异常都是从 java.io.IOException 继承而来的。</p> <h3 id="特例-runtimeexception"><a href="#特例-runtimeexception" class="header-anchor">#</a> 特例：RuntimeException</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果必须对传递给方法的每个引用都检查其是否为 null（因为无法确定调用者是否传入了非法引用），这听起来着实吓人。幸运的是，这不必由你亲自来做，它属于 Java 的标准运行时检测的一部分。如果对 null 引用进行调用，Java 会自动抛出 NullPointerException 异常，所以上述代码是多余的。</p> <p>属于运行时异常的类型有很多，它们会自动被 JVM 抛出，所以不必在异常说明中列出来。这些异常都是继承自 RuntimeException 。这构成了一组具有相同特征和行为的异常类型。并且，也不再需要在异常说明中声明方法将抛出 RuntimeException 类型的异常（或者任何从 RuntimeException 继承的异常），它们也被称为“不受检查异常”。这种异常属于错误，将被自动捕获，就不用你亲自动手了。要是自己去检查 RuntimeException 的话，代码就显得太混乱了。不过尽管通常不用捕获 RuntimeException 异常，但还是可以在代码中抛出 RuntimeException 类型的异常。</p> <p>RuntimeException 代表的是编程错误：</p> <ol><li>无法预料的错误
比如从你控制范围之外传递进来的 null 引用</li> <li>作为程序员，应该在代码中进行检查错误
比如 ArrayIndexOutOfBoundsException，就得注意一下数组大小。在一个地方发生的异常，常常会在另一个地方导致错误。</li></ol> <p>在这些情况下使用异常很有好处，它们能给调试带来便利。
如果不捕获这种异常会发生什么事？
因为编译器没有在这个问题上对异常说明进行强制检查，RuntimeException 类型的异常也许会穿越所有的执行路径直达 main() 方法，而不会被捕获。
要明白到底发生了什么，可以试试下面的例子：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NeverCaught</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;From f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>输出结果为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>___<span class="token punctuation">[</span> <span class="token class-name">Error</span> <span class="token class-name">Output</span> <span class="token punctuation">]</span>___
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>RuntimeException</span><span class="token operator">:</span>
<span class="token class-name">From</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
at <span class="token class-name">NeverCaught</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token class-name">NeverCaught</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
at <span class="token class-name">NeverCaught</span><span class="token punctuation">.</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token class-name">NeverCaught</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
at <span class="token class-name">NeverCaught</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">NeverCaught</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>如果 RuntimeException 没有被捕获而直达 main()，那么在程序退出前将调用异常的 printStackTrace() 方法。</p> <p>你会发现，RuntimeException 是个特例。对于这种异常，编译器无需异常说明，其输出被报告给了 System.err。</p> <p>只能在代码中忽略 RuntimeException 类型的异常，因为所有受检查类型异常的处理都是由编译器强制实施的。</p> <p>不应把 Java 的异常处理机制当成是单一用途的工具。它被设计用来处理一些烦人的运行时错误，这些错误往往是由代码控制能力之外的因素导致的；然而，它对于发现某些编译器无法检测到的编程错误，也是非常重要的。</p> <h2 id="使用-finally-进行清理"><a href="#使用-finally-进行清理" class="header-anchor">#</a> 使用 finally 进行清理</h2> <p>有一些代码片段，可能会希望无论 try 块中的异常是否抛出，它们都能得到执行。这通常适用于内存回收之外的情况（因为回收由垃圾回收器完成），为了达到这个效果，可以在异常处理程序后面加上 finally 子句。完整的异常处理程序看起来像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">// The guarded region: Dangerous activities</span>
<span class="token comment">// that might throw A, B, or C</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">A</span> a1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Handler for situation A</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">B</span> b1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Handler for situation B</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">C</span> c1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Handler for situation C</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
<span class="token comment">// Activities that happen every time</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>为了证明 finally 子句总能运行，可以试试下面这个程序：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/FinallyWorks.java</span>
<span class="token comment">// The finally clause is always executed</span>
<span class="token keyword">class</span> <span class="token class-name">ThreeException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FinallyWorks</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token comment">// Post-increment is zero first time:</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">++</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ThreeException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ThreeException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ThreeException&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;In finally clause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// out of &quot;while&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ThreeException
In finally clause
No exception
In finally clause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>可以从输出中发现，无论异常是否被抛出，finally 子句总能被执行。这个程序也给了我们一些思路，当 Java 中的异常不允许我们回到异常抛出的地点时，那么该如何应对呢？如果把 try 块放在循环里，就建立了一个“程序继续执行之前必须要达到”的条件。还可以加入一个 static 类型的计数器或者别的装置，使循环在放弃以前能尝试一定的次数。这将使程序的健壮性更上一个台阶。</p> <h3 id="finally-用来做什么"><a href="#finally-用来做什么" class="header-anchor">#</a> finally 用来做什么？</h3> <p>对于没有垃圾回收和析构函数自动调用机制的语言来说，finally 非常重要。它能使程序员保证：无论 try 块里发生了什么，内存总能得到释放。但 Java 有垃圾回收机制，所以内存释放不再是问题。而且，Java 也没有析构函数可供调用。那么，Java 在什么情况下才能用到 finally 呢？</p> <p>当要把除内存之外的资源恢复到它们的初始状态时，就要用到 finally 子句。这种需要清理的资源包括：已经打开的文件或网络连接，在屏幕上画的图形，甚至可以是外部世界的某个开关，如下面例子所示：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/Switch.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Switch</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> state <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> state <span class="token operator">?</span> <span class="token string">&quot;on&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// exceptions/OnOffException1.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OnOffException1</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// exceptions/OnOffException2.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OnOffException2</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// exceptions/OnOffSwitch.java</span>
<span class="token comment">// Why use finally?</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OnOffSwitch</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Switch</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">OnOffException1</span><span class="token punctuation">,</span> <span class="token class-name">OnOffException2</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            sw<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// Code that can throw exceptions...</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sw<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">OnOffException1</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OnOffException1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sw<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">OnOffException2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OnOffException2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sw<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>on
off
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>程序的目的是要确保 main() 结束的时候开关必须是关闭的，所以在每个 try 块和异常处理程序的末尾都加入了对 sw.offo 方法的调用。但也可能有这种情况：异常被抛出，但没被处理程序捕获，这时 sw.off() 就得不到调用。但是有了 finally，只要把 try 块中的清理代码移放在一处即可：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/WithFinally.java</span>
<span class="token comment">// Finally Guarantees cleanup</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WithFinally</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">Switch</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            sw<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// Code that can throw exceptions...</span>
            <span class="token class-name">OnOffSwitch</span><span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">OnOffException1</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OnOffException1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">OnOffException2</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OnOffException2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            sw<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>on
off
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这里 sw.off() 被移到一处，并且保证在任何情况下都能得到执行。</p> <p>甚至在异常没有被当前的异常处理程序捕获的情况下，异常处理机制也会在跳到更高一层的异常处理程序之前，执行 finally 子句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/AlwaysFinally.java</span>
<span class="token comment">// Finally is always executed</span>
<span class="token keyword">class</span> <span class="token class-name">FourException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AlwaysFinally</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Entering first try block&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Entering second try block&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">FourException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;finally in 2nd try block&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FourException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Caught FourException in 1st try block&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;finally in 1st try block&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Entering</span> first <span class="token keyword">try</span> block
<span class="token class-name">Entering</span> second <span class="token keyword">try</span> block
<span class="token keyword">finally</span> in <span class="token number">2</span>nd <span class="token keyword">try</span> block
<span class="token class-name">Caught</span> <span class="token class-name">FourException</span> in <span class="token number">1</span>st <span class="token keyword">try</span> block
<span class="token keyword">finally</span> in <span class="token number">1</span>st <span class="token keyword">try</span> block
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>当涉及 break 和 continue 语句的时候，finally 子句也会得到执行。请注意，如果把 finally 子句和带标签的 break 及 continue 配合使用，在 Java 里就没必要使用 goto 语句了。</p> <h3 id="在-return-中使用-finally"><a href="#在-return-中使用-finally" class="header-anchor">#</a> 在 return 中使用 finally</h3> <p>因为 finally 子句总是会执行，所以可以从一个方法内的多个点返回，仍然能保证重要的清理工作会执行：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/MultipleReturns.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MultipleReturns</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Initialization that requires cleanup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Point 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Point 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Point 3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;End&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Performing cleanup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token function">f</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Initialization</span> that <span class="token keyword">requires</span> <span class="token namespace">cleanup</span>
<span class="token class-name">Point</span> <span class="token number">1</span>
<span class="token class-name">Performing</span> cleanup
<span class="token class-name">Initialization</span> that <span class="token keyword">requires</span> <span class="token namespace">cleanup</span>
<span class="token class-name">Point</span> <span class="token number">1</span>
<span class="token class-name">Point</span> <span class="token number">2</span>
<span class="token class-name">Performing</span> cleanup
<span class="token class-name">Initialization</span> that <span class="token keyword">requires</span> <span class="token namespace">cleanup</span>
<span class="token class-name">Point</span> <span class="token number">1</span>
<span class="token class-name">Point</span> <span class="token number">2</span>
<span class="token class-name">Point</span> <span class="token number">3</span>
<span class="token class-name">Performing</span> cleanup
<span class="token class-name">Initialization</span> that <span class="token keyword">requires</span> <span class="token namespace">cleanup</span>
<span class="token class-name">Point</span> <span class="token number">1</span>
<span class="token class-name">Point</span> <span class="token number">2</span>
<span class="token class-name">Point</span> <span class="token number">3</span>
<span class="token class-name">End</span>
<span class="token class-name">Performing</span> cleanup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>从输出中可以看出，从何处返回无关紧要，finally 子句永远会执行。</p> <h3 id="缺憾-异常丢失"><a href="#缺憾-异常丢失" class="header-anchor">#</a> 缺憾：异常丢失</h3> <p>遗憾的是，Java 的异常实现也有瑕疵。异常作为程序出错的标志，决不应该被忽略，但它还是有可能被轻易地忽略。用某些特殊的方式使用 finally 子句，就会发生这种情况：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/LostMessage.java</span>
<span class="token comment">// How an exception can be lost</span>
<span class="token keyword">class</span> <span class="token class-name">VeryImportantException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;A very important exception!&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">HoHumException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;A trivial exception&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LostMessage</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">VeryImportantException</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">VeryImportantException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">HoHumException</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HoHumException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">LostMessage</span> lm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LostMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                lm<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                lm<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">VeryImportantException</span> <span class="token operator">|</span> <span class="token class-name">HoHumException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>A trivial exception
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>从输出中可以看到，VeryImportantException 不见了，它被 finally 子句里的 HoHumException 所取代。这是相当严重的缺陷，因为异常可能会以一种比前面例子所示更微妙和难以察党的方式完全丢失。相比之下，C++把“前一个异常还没处理就抛出下一个异常”的情形看成是糟糕的编程错误。也许在 Java 的未来版本中会修正这个问题（另一方面，要把所有抛出异常的方法，如上例中的 dispose() 方法，全部打包放到 try-catch 子句里面）。</p> <p>一种更加简单的丢失异常的方式是从 finally 子句中返回：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/ExceptionSilencer.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExceptionSilencer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">// Using 'return' inside the finally block</span>
            <span class="token comment">// will silence any thrown exception.</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>如果运行这个程序，就会看到即使方法里抛出了异常，它也不会产生任何输出。</p> <h2 id="异常限制"><a href="#异常限制" class="header-anchor">#</a> 异常限制</h2> <p>当覆盖方法的时候，只能抛出在基类方法的异常说明里列出的那些异常。这个限制很有用，因为这意味着，若当基类使用的代码应用到其派生类对象的时候，一样能够工作（当然，这是面向对象的基本概念），异常也不例外。</p> <p>下面例子演示了这种（在编译时）施加在异常上面的限制：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/StormyInning.java</span>
<span class="token comment">// Overridden methods can throw only the exceptions</span>
<span class="token comment">// specified in their base-class versions, or exceptions</span>
<span class="token comment">// derived from the base-class exceptions</span>
<span class="token keyword">class</span> <span class="token class-name">BaseballException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Foul</span> <span class="token keyword">extends</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Strike</span> <span class="token keyword">extends</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Inning</span> <span class="token punctuation">{</span>
    <span class="token class-name">Inning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span>
<span class="token comment">// Doesn't actually have to throw anything</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">atBat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Strike</span><span class="token punctuation">,</span> <span class="token class-name">Foul</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Throws no checked exceptions</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">StormException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">RainedOut</span> <span class="token keyword">extends</span> <span class="token class-name">StormException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">PopFoul</span> <span class="token keyword">extends</span> <span class="token class-name">Foul</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Storm</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RainedOut</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">rainHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RainedOut</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StormyInning</span> <span class="token keyword">extends</span> <span class="token class-name">Inning</span> <span class="token keyword">implements</span> <span class="token class-name">Storm</span> <span class="token punctuation">{</span>
    <span class="token comment">// OK to add new exceptions for constructors, but you</span>
<span class="token comment">// must deal with the base constructor exceptions:</span>
    <span class="token keyword">public</span> <span class="token class-name">StormyInning</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">RainedOut</span><span class="token punctuation">,</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">StormyInning</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">BaseballException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// Regular methods must conform to base class:</span>
<span class="token comment">//- void walk() throws PopFoul {} //Compile error</span>
<span class="token comment">// Interface CANNOT add exceptions to existing</span>
<span class="token comment">// methods from the base class:</span>
<span class="token comment">//- public void event() throws RainedOut {}</span>
<span class="token comment">// If the method doesn't already exist in the</span>
<span class="token comment">// base class, the exception is OK:</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rainHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RainedOut</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// You can choose to not throw any exceptions,</span>
<span class="token comment">// even if the base version does:</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// Overridden methods can throw inherited exceptions:</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">atBat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">PopFoul</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">StormyInning</span> si <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StormyInning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            si<span class="token punctuation">.</span><span class="token function">atBat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">PopFoul</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Pop foul&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">RainedOut</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Rained out&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">BaseballException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Generic baseball exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">// Strike not thrown in derived version.</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">// What happens if you upcast?</span>
            <span class="token class-name">Inning</span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StormyInning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            i<span class="token punctuation">.</span><span class="token function">atBat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// You must catch the exceptions from the</span>
<span class="token comment">// base-class version of the method:</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Strike</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Strike&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Foul</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Foul&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">RainedOut</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Rained out&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">BaseballException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Generic baseball exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br></div></div><p>在 Inning 类中，可以看到构造器和 event() 方法都声明将抛出异常，但实际上没有抛出。这种方式使你能强制用户去捕获可能在覆盖后的 event() 版本中增加的异常，所以它很合理。这对于抽象方法同样成立，比如 atBat()。</p> <p>接口 Storm 包含了一个在 Inning 中定义的方法 event() 和一个不在 Inning 中定义的方法 rainHard()。这两个方法都抛出新的异常 RainedOut，如果 StormyInning 类在扩展 Inning 类的同时又实现了 Storm 接口，那么 Storm 里的 event() 方法就不能改变在 Inning 中的 event（方法的异常接口。否则的话，在使用基类的时候就不能判断是否捕获了正确的异常，所以这也很合理。当然，如果接口里定义的方法不是来自于基类，比如 rainHard()，那么此方法抛出什么样的异常都没有问题。</p> <p>异常限制对构造器不起作用。你会发现 StormyInning 的构造器可以抛出任何异常，而不必理会基类构造器所抛出的异常。然而，因为基类构造器必须以这样或那样的方式被调用（这里默认构造器将自动被调用），派生类构造器的异常说明必须包含基类构造器的异常说明。</p> <p>派生类构造器不能捕获基类构造器抛出的异常。</p> <p>StormyInning.walk() 不能通过编译是因为它抛出了异常，而 Inning.walk() 并没有声明此异常。如果编译器允许这么做的话，就可以在调用 Inning.walk() 的时候不用做异常处理了，而且当把它替换成 Inning 的派生类的对象时，这个方法就有可能会抛出异常，于是程序就失灵了。通过强制派生类遵守基类方法的异常说明，对象的可替换性得到了保证。</p> <p>覆盖后的 event() 方法表明，派生类方法可以不抛出任何异常，即使它是基类所定义的异常。同样这是因为，假使基类的方法会抛出异常，这样做也不会破坏已有的程序，所以也没有问题。类似的情况出现在 atBat() 身上，它抛出的是 PopFoul，这个异常是继承自“会被基类的 atBat() 抛出”的 Foul，这样，如果你写的代码是同 Inning 打交道，并且调用了它的 atBat() 的话，那么肯定能捕获 Foul，而 PopFoul 是由 Foul 派生出来的，因此异常处理程序也能捕获 PopFoul。</p> <p>最后一个值得注意的地方是 main()。这里可以看到，如果处理的刚好是 Stormylnning 对象的话，编译器只会强制要求你捕获这个类所抛出的异常。但是如果将它向上转型成基类型，那么编译器就会（正确地）要求你捕获基类的异常。所有这些限制都是为了能产生更为强壮的异常处理代码。</p> <p>尽管在继承过程中，编译器会对异常说明做强制要求，但异常说明本身并不属于方法类型的一部分，方法类型是由方法的名字与参数的类型组成的。因此，不能基于异常说明来重载方法。此外，一个出现在基类方法的异常说明中的异常，不一定会出现在派生类方法的异常说明里。这点同继承的规则明显不同，在继承中，基类的方法必须出现在派生类里，换句话说，在继承和覆盖的过程中，某个特定方法的“异常说明的接口”不是变大了而是变小了——这恰好和类接口在继承时的情形相反。</p> <h2 id="构造器"><a href="#构造器" class="header-anchor">#</a> 构造器</h2> <p>有一点很重要，即你要时刻询问自己“如果异常发生了，所有东西能被正确的清理吗？&quot;尽管大多数情况下是非常安全的，但涉及构造器时，问题就出现了。构造器会把对象设置成安全的初始状态，但还会有别的动作，比如打开一个文件，这样的动作只有在对象使用完毕并且用户调用了特殊的清理方法之后才能得以清理。如果在构造器内抛出了异常，这些清理行为也许就不能正常工作了。这意味着在编写构造器时要格外细心。</p> <p>你也许会认为使用 finally 就可以解决问题。但问题并非如此简单，因为 finally 会每次都执行清理代码。如果构造器在其执行过程中半途而废，也许该对象的某些部分还没有被成功创建，而这些部分在 finaly 子句中却是要被清理的。</p> <p>在下面的例子中，建立了一个 InputFile 类，它能打开一个文件并且每次读取其中的一行。这里使用了 Java 标准输入/输出库中的 FileReader 和 BufferedReader 类（将在 <a href="/record/java/jdk/Java8/Appendix-IO-Streams.html">附录：I/O 流 </a> 中讨论），这些类的基本用法很简单，你应该很容易明白：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/InputFile.java</span>
<span class="token comment">// Paying attention to exceptions in constructors</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputFile</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">BufferedReader</span> in<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">InputFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> fname<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Other code that might throw exceptions</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Could not open &quot;</span> <span class="token operator">+</span> fname<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Wasn't open, so don't close it</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// All other exceptions must close it</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;in.close() unsuccessful&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span> <span class="token comment">// Rethrow</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment">// Don't close it here!!!</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> s<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            s <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;readLine() failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dispose() successful&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;in.close() failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>InputFile 的构造器接受字符串作为参数，该字符串表示所要打开的文件名。在 try 块中，会使用此文件名建立 FileReader 对象。FileReader 对象本身用处并不大，但可以用它来建立 BufferedReader 对象。注意，使用 InputFile 的好处之一是把两步操作合而为一。</p> <p>如果 FileReader 的构造器失败了，将抛出 FileNotFoundException 异常。对于这个异常，并不需要关闭文件，因为这个文件还没有被打开。而任何其他捕获异常的 catch 子句必须关闭文件，因为在它们捕获到异常之时，文件已经打开了（当然，如果还有其他方法能抛出 FileNotFoundException，这个方法就显得有些投机取巧了。这时，通常必须把这些方法分别放到各自的 try 块里），close() 方法也可能会抛出异常，所以尽管它已经在另一个 catch 子句块里了，还是要再用一层 try-catch，这对 Java 编译器而言只不过是多了一对花括号。在本地做完处理之后，异常被重新抛出，对于构造器而言这么做是很合适的，因为你总不希望去误导调用方，让他认为“这个对象已经创建完毕，可以使用了”。</p> <p>在本例中，由于 finally 会在每次完成构造器之后都执行一遍，因此它实在不该是调用 close() 关闭文件的地方。我们希望文件在 InputFlle 对象的整个生命周期内都处于打开状态。</p> <p>getLine() 方法会返回表示文件下一行内容的字符串。它调用了能抛出异常的 readLine()，但是这个异常已经在方法内得到处理，因此 getLine() 不会抛出任何异常。在设计异常时有一个问题：应该把异常全部放在这一层处理；还是先处理一部分，然后再向上层抛出相同的（或新的）异常；又或者是不做任何处理直接向上层抛出。如果用法恰当的话，直接向上层抛出的确能简化编程。在这里，getLine() 方法将异常转换为 RuntimeException，表示一个编程错误。</p> <p>用户在不再需要 InputFile 对象时，就必须调用 dispose() 方法，这将释放 BufferedReader 和/或 FileReader 对象所占用的系统资源（比如文件句柄），在使用完 InputFile 对象之前是不会调用它的。可能你会考虑把上述功能放到 finalize() 里面，但我在 <a href="/record/java/jdk/Java8/Housekeeping.html">封装</a> 讲过，你不知道 finalize() 会不会被调用（即使能确定它将被调用，也不知道在什么时候调用），这也是 Java 的缺陷：除了内存的清理之外，所有的清理都不会自动发生。所以必须告诉客户端程序员，这是他们的责任。</p> <p>对于在构造阶段可能会抛出异常，并且要求清理的类，最安全的使用方式是使用嵌套的 try 子句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/Cleanup.java</span>
<span class="token comment">// Guaranteeing proper cleanup of a resource</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cleanup</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">InputFile</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputFile</span><span class="token punctuation">(</span><span class="token string">&quot;Cleanup.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> s<span class="token punctuation">;</span>
                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">getLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                    <span class="token punctuation">;</span> <span class="token comment">// Perform line-by-line processing here...</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught Exception in main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                in<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;InputFile construction failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dispose() successful
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>请仔细观察这里的逻辑：对 InputFile 对象的构造在其自己的 try 语句块中有效，如果构造失败，将进入外部的 catch 子句，而 dispose() 方法不会被调用。但是，如果构造成功，我们肯定想确保对象能够被清理，因此在构造之后立即创建了一个新的 try 语句块。执行清理的 finally 与内部的 try 语句块相关联。在这种方式中，finally 子句在构造失败时是不会执行的，而在构造成功时将总是执行。</p> <p>这种通用的清理惯用法在构造器不抛出任何异常时也应该运用，其基本规则是：在创建需要清理的对象之后，立即进入一个 try-finally 语句块：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/CleanupIdiom.java</span>
<span class="token comment">// Disposable objects must be followed by a try-finally</span>
<span class="token keyword">class</span> <span class="token class-name">NeedsCleanup</span> <span class="token punctuation">{</span> <span class="token comment">// Construction can't fail</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> counter <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">long</span> id <span class="token operator">=</span> counter<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;NeedsCleanup &quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot; disposed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ConstructionException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">NeedsCleanup2</span> <span class="token keyword">extends</span> <span class="token class-name">NeedsCleanup</span> <span class="token punctuation">{</span>
    <span class="token comment">// Construction can fail:</span>
    <span class="token class-name">NeedsCleanup2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ConstructionException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CleanupIdiom</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// [1]:</span>
        <span class="token class-name">NeedsCleanup</span> nc1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeedsCleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            nc1<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// [2]:</span>
        <span class="token comment">// If construction cannot fail,</span>
        <span class="token comment">// you can group objects:</span>
        <span class="token class-name">NeedsCleanup</span> nc2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeedsCleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">NeedsCleanup</span> nc3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeedsCleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            nc3<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Reverse order of construction</span>
            nc2<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// [3]:</span>
        <span class="token comment">// If construction can fail you must guard each one:</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">NeedsCleanup2</span> nc4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeedsCleanup2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">NeedsCleanup2</span> nc5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeedsCleanup2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// ...</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    nc5<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ConstructionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// nc5 const.</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                nc4<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ConstructionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// nc4 const.</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>NeedsCleanup 1 disposed
NeedsCleanup 3 disposed
NeedsCleanup 2 disposed
NeedsCleanup 5 disposed
NeedsCleanup 4 disposed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>[1] 相当简单，遵循了在可去除对象之后紧跟 try-finally 的原则。如果对象构造不会失败，就不需要任何 catch。</li> <li>[2] 为了构造和清理，可以看到将具有不能失败的构造器的对象分组在一起。</li> <li>[3] 展示了如何处理那些具有可以失败的构造器，且需要清理的对象。为了正确处理这种情况，事情变得很棘手，因为对于每一个构造，都必须包含在其自己的 try-finally 语句块中，并且每一个对象构造必须都跟随一个 try-finally 语句块以确保清理。</li></ul> <p>本例中的异常处理的棘手程度，对于应该创建不能失败的构造器是一个有力的论据，尽管这么做并非总是可行。</p> <p>注意，如果 dispose() 可以抛出异常，那么你可能需要额外的 try 语句块。基本上，你应该仔细考虑所有的可能性，并确保正确处理每一种情况。</p> <h2 id="try-with-resources-用法"><a href="#try-with-resources-用法" class="header-anchor">#</a> Try-With-Resources 用法</h2> <p>上一节的内容可能让你有些头疼。在考虑所有可能失败的方法时，找出放置所有 try-catch-finally 块的位置变得令人生畏。确保没有任何故障路径，使系统远离不稳定状态，这非常具有挑战性。</p> <p>InputFile.java 是一个特别棘手的情况，因为文件被打开（包含所有可能的异常），然后它在对象的生命周期中保持打开状态。每次调用 getLine() 都会导致异常，因此可以调用 dispose() 方法。这是一个很好的例子，因为它显示了事物的混乱程度。它还表明你应该尝试最好不要那样设计代码（当然，你经常会遇到这种你无法选择的代码设计的情况，因此你必须仍然理解它）。</p> <p>InputFile.java 一个更好的实现方式是如果构造函数读取文件并在内部缓冲它 —— 这样，文件的打开，读取和关闭都发生在构造函数中。或者，如果读取和存储文件不切实际，你可以改为生成 Stream。理想情况下，你可以设计成如下的样子：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/InputFile2.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputFile2</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> fname<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">InputFile2</span><span class="token punctuation">(</span><span class="token class-name">String</span> fname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fname <span class="token operator">=</span> fname<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">InputFile2</span><span class="token punctuation">(</span><span class="token string">&quot;InputFile2.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>main(String[] args) throws IOException {
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在，getLines() 全权负责打开文件并创建 Stream。</p> <p>你不能总是轻易地回避这个问题。有时会有以下问题：</p> <ol><li>需要资源清理</li> <li>需要在特定的时刻进行资源清理，比如你离开作用域的时候（在通常情况下意味着通过异常进行清理）。</li></ol> <p>一个常见的例子是 jav.io.FileInputstream（将会在 <a href="/record/java/jdk/Java8/Appendix-IO-Streams.html">附录：I/O 流 </a> 中提到）。要正确使用它，你必须编写一些棘手的样板代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/MessyExceptions.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessyExceptions</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>
                    <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;MessyExceptions.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> contents <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Process contents</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Handle the error</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>in <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// Handle the close() error</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>当 finally 子句有自己的 try 块时，感觉事情变得过于复杂。</p> <p>幸运的是，Java 7 引入了 try-with-resources 语法，它可以非常清楚地简化上面的代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/TryWithResources.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TryWithResources</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;TryWithResources.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> contents <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Process contents</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Handle the error</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>在 Java 7 之前，try 总是后面跟着一个 {，但是现在可以跟一个带括号的定义 - 这里是我们创建的 FileInputStream 对象。括号内的部分称为资源规范头（resource specification header）。现在可用于整个 try 块的其余部分。更重要的是，无论你如何退出 try 块（正常或异常），都会执行前一个 finally 子句的等价物，但不会编写那些杂乱而棘手的代码。这是一项重要的改进。</p> <p>它是如何工作的？在 try-with-resources 定义子句中创建的对象（在括号内）必须实现 java.lang.AutoCloseable 接口，这个接口有一个方法：close()。当在 Java 7 中引入 AutoCloseable 时，许多接口和类被修改以实现它；查看 Javadocs 中的 AutoCloseable，可以找到所有实现该接口的类列表，其中包括 Stream 对象：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/StreamsAreAutoCloseable.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamsAreAutoCloseable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> in <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span>
                        <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;StreamsAreAutoCloseable.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">PrintWriter</span> outfile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>
                        <span class="token string">&quot;Results.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1]</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            in<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">toLowerCase</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">forEachOrdered</span><span class="token punctuation">(</span>outfile<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token comment">// [2]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>[1] 你在这里可以看到其他的特性：资源规范头中可以包含多个定义，并且通过分号进行分割（最后一个分号是可选的）。规范头中定义的每个对象都会在 try 语句块运行结束之后调用 close() 方法。</li> <li>[2] try-with-resources 里面的 try 语句块可以不包含 catch 或者 finally 语句而独立存在。在这里，IOException 被 main() 方法抛出，所以这里并不需要在 try 后面跟着一个 catch 语句块。</li></ul> <p>Java 5 中的 Closeable 已经被修改，修改之后的接口继承了 AutoCloseable 接口。所以所有实现了 Closeable 接口的对象，都支持了  try-with-resources 特性。</p> <h3 id="揭示细节"><a href="#揭示细节" class="header-anchor">#</a> 揭示细节</h3> <p>为了研究 try-with-resources 的基本机制，我们将创建自己的 AutoCloseable 类：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/AutoCloseableDetails.java</span>
<span class="token keyword">class</span> <span class="token class-name">Reporter</span> <span class="token keyword">implements</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Reporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Creating &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Closing &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">First</span> <span class="token keyword">extends</span> <span class="token class-name">Reporter</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Second</span> <span class="token keyword">extends</span> <span class="token class-name">Reporter</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AutoCloseableDetails</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">First</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Second</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Second</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Creating First
Creating Second
Closing Second
Closing First
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>退出 try 块会调用两个对象的 close() 方法，并以与创建顺序相反的顺序关闭它们。顺序很重要，因为在此配置中，Second 对象可能依赖于 First 对象，因此如果 First 在第 Second 关闭时已经关闭。 Second 的 close() 方法可能会尝试访问 First 中不再可用的某些功能。</p> <p>假设我们在资源规范头中定义了一个不是 AutoCloseable 的对象</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/TryAnything.java</span>
<span class="token comment">// {WillNotCompile}</span>
<span class="token keyword">class</span> <span class="token class-name">Anything</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TryAnything</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">Anything</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Anything</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>正如我们所希望和期望的那样，Java 不会让我们这样做，并且出现编译时错误。</p> <p>如果其中一个构造函数抛出异常怎么办？</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/ConstructorException.java</span>
<span class="token keyword">class</span> CE <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">SecondExcept</span> <span class="token keyword">extends</span> <span class="token class-name">Reporter</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecondExcept</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> CE <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token function">CE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstructorException</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">First</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">SecondExcept</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecondExcept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Second</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Second</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;In body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CE</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Creating First
Creating SecondExcept
Closing First
Caught: CE
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>现在资源规范头中定义了 3 个对象，中间的对象抛出异常。因此，编译器强制我们使用 catch 子句来捕获构造函数异常。这意味着资源规范头实际上被 try 块包围。</p> <p>正如预期的那样，First 创建时没有发生意外，SecondExcept 在创建期间抛出异常。请注意，不会为 SecondExcept 调用 close()，因为如果构造函数失败，则无法假设你可以安全地对该对象执行任何操作，包括关闭它。由于 SecondExcept 的异常，Second 对象实例 s2 不会被创建，因此也不会有清除事件发生。</p> <p>如果没有构造函数抛出异常，但你可能会在 try 的主体中获取它们，则再次强制你实现 catch 子句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/BodyException.java</span>
<span class="token keyword">class</span> <span class="token class-name">Third</span> <span class="token keyword">extends</span> <span class="token class-name">Reporter</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BodyException</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">First</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Second</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Second</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;In body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Third</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Third</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">SecondExcept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;End of body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CE</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Creating</span> <span class="token class-name">First</span>
<span class="token class-name">Creating</span> <span class="token class-name">Second</span>
<span class="token class-name">In</span> body
<span class="token class-name">Creating</span> <span class="token class-name">Third</span>
<span class="token class-name">Creating</span> <span class="token class-name">SecondExcept</span>
<span class="token class-name">Closing</span> <span class="token class-name">Second</span>
<span class="token class-name">Closing</span> <span class="token class-name">First</span>
<span class="token class-name">Caught</span><span class="token operator">:</span> CE
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>请注意，第 3 个对象永远不会被清除。那是因为它不是在资源规范头中创建的，所以它没有被保护。这很重要，因为 Java 在这里没有以警告或错误的形式提供指导，因此像这样的错误很容易漏掉。实际上，如果依赖某些集成开发环境来自动重写代码，以使用 try-with-resources 特性，那么它们（在撰写本文时）通常只会保护它们遇到的第一个对象，而忽略其余的对象。</p> <p>最后，让我们看一下抛出异常的 close() 方法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/CloseExceptions.java</span>
<span class="token keyword">class</span> <span class="token class-name">CloseException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Reporter2</span> <span class="token keyword">implements</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Reporter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Creating &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">CloseException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Closing &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Closer</span> <span class="token keyword">extends</span> <span class="token class-name">Reporter2</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">CloseException</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CloseException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CloseExceptions</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span>
                <span class="token class-name">First</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Closer</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Closer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Second</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Second</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;In body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CloseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Creating First
Creating Closer
Creating Second
In body
Closing Second
Closing Closer
Closing First
Caught: CloseException
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>从技术上讲，我们并没有被迫在这里提供一个 catch 子句；你可以通过 <strong>main() throws CloseException</strong> 的方式来报告异常。但 catch 子句是放置错误处理代码的典型位置。</p> <p>请注意，因为所有三个对象都已创建，所以它们都以相反的顺序关闭 - 即使 Closer 也是如此。 close() 抛出异常。当你想到它时，这就是你想要发生的事情，但是如果你必须自己编写所有这些逻辑，那么你可能会错过一些错误。想象一下所有代码都在那里，程序员没有考虑清理的所有含义，并且做错了。因此，应始终尽可能使用 try-with-resources。它有助于实现该功能，使得生成的代码更清晰，更易于理解。</p> <h2 id="异常匹配"><a href="#异常匹配" class="header-anchor">#</a> 异常匹配</h2> <p>抛出异常的时候，异常处理系统会按照代码的书写顺序找出“最近”的处理程序。找到匹配的处理程序之后，它就认为异常将得到处理，然后就不再继续查找。</p> <p>查找的时候并不要求抛出的异常同处理程序所声明的异常完全匹配。派生类的对象也可以匹配其基类的处理程序，就像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/Human.java</span>
<span class="token comment">// Catching exception hierarchies</span>
<span class="token keyword">class</span> <span class="token class-name">Annoyance</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Sneeze</span> <span class="token keyword">extends</span> <span class="token class-name">Annoyance</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Human</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Catch the exact type:</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Sneeze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Sneeze</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught Sneeze&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Annoyance</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught Annoyance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Catch the base type:</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Sneeze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Annoyance</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Caught Annoyance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>输出为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Caught</span> <span class="token class-name">Sneeze</span>
<span class="token class-name">Caught</span> <span class="token class-name">Annoyance</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Sneeze 异常会被第一个匹配的 catch 子句捕获，也就是程序里的第一个。然而如果将这个 catch 子句删掉，只留下 Annoyance 的 catch 子句，该程序仍然能运行，因为这次捕获的是 Sneeze 的基类。换句话说，catch（Annoyance a）会捕获 Annoyance 以及所有从它派生的异常。这一点非常有用，因为如果决定在方法里加上更多派生异常的话，只要客户程序员捕获的是基类异常，那么它们的代码就无需更改。</p> <p>如果把捕获基类的 catch 子句放在最前面，以此想把派生类的异常全给“屏蔽”掉，就像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Sneeze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Annoyance</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Sneeze</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>此时，编译器会发现 Sneeze 的 catch 子句永远得不到执行，因此它会向你报告错误。</p> <h2 id="其他可选方式"><a href="#其他可选方式" class="header-anchor">#</a> 其他可选方式</h2> <p>异常处理系统就像一个活门（trap door），使你能放弃程序的正常执行序列。当“异常情形”
发生的时候，正常的执行已变得不可能或者不需要了，这时就要用到这个“活门&quot;。异常代表了当前方法不能继续执行的情形。开发异常处理系统的原因是，如果为每个方法所有可能发生的错误都进行处理的话，任务就显得过于繁重了，程序员也不愿意这么做。结果常常是将错误忽格。应该注意到，开发异常处理的初衷是为了方便程序员处理错误。</p> <p>异常处理的一个重要原则是“只有在你知道如何处理的情况下才捕获异常&quot;。实际上，异常处理的一个重要目标就是把错误处理的代码同错误发生的地点相分离。这使你能在一段代码中专注于要完成的事情，至于如何处理错误，则放在另一段代码中完成。这样一来，主要代码就不会与错误处理逻辑混在一起，也更容易理解和维护。通过允许一个处理程序去处理多个出错点，异常处理还使得错误处理代码的数量趋于减少。</p> <p>“被检查的异常”使这个问题变得有些复杂，因为它们强制你在可能还没准备好处理错误的时候被迫加上 catch 子句，这就导致了吞食则有害（harmful if swallowed）的问题：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... to do something useful</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ObligatoryException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Gulp!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>程序员们只做最简单的事情（包括我自己，在本书第 1 版中也有这个问题），常常是无意中&quot;吞食”了异常，然而一旦这么做，虽然能通过编译，但除非你记得复查并改正代码，否则异常将会丢失。异常确实发生了，但“吞食”后它却完全消失了。因为编译器强迫你立刻写代码来处理异常，所以这种看起来最简单的方法，却可能是最糟糕的做法。</p> <p>当我意识到犯了这么大一个错误时，简直吓了一大跳，在本书第 2 版中，我在处理程序里通过打印栈轨迹的方法“修补”了这个问题（本章中的很多例子还是使用了这种方法，看起来还是比较合适的），虽然这样可以跟踪异常的行为，但是仍旧不知道该如何处理异常。这一节，我们来研究一下“被检查的异常”及其并发症，以及采用什么方法来解决这些问题。</p> <p>这个话题看起来简单，但实际上它不仅复杂，更重要的是还非常多变。总有人会顽固地坚持自己的立场，声称正确答案（也是他们的答案）是显而易见的。我觉得之所以会有这种观点，是因为我们使用的工具已经不是 ANS1 标准出台前的像 C 那样的弱类型语言，而是像 C++ 和 Java 这样的“强静态类型语言”（也就是编译时就做类型检查的语言），这是前者所无法比拟的。当刚开始这种转变的时候（就像我一样），会觉得它带来的好处是那样明显，好像类型检查总能解决所有的问题。在此，我想结合我自己的认识过程，告诉读者我是怎样从对类型检查的绝对迷信变成持怀疑态度的，当然，很多时候它还是非常有用的，但是当它挡住我们的去路并成为障碍的时候，我们就得跨过去。只是这条界限往往并不是很清晰（我最喜欢的一句格言是：所有模型都是错误的，但有些是能用的）。</p> <h3 id="历史"><a href="#历史" class="header-anchor">#</a> 历史</h3> <p>异常处理起源于 PL/1 和 Mesa 之类的系统中，后来又出现在 CLU、Smalltalk、Modula-3、Ada、Eiffel、C++、Python、Java 以及后 Java 语言 Ruby 和 C# 中。Java 的设计和 C++ 很相似，只是 Java 的设计者去掉了一些他们认为 C++设计得不好的东西。</p> <p>为了能向程序员提供一个他们更愿意使用的错误处理和恢复的框架，异常处理机制很晚才被加入 C++ 标准化过程中，这是由 C++ 的设计者 Bjarne Stroustrup 所倡议。C++ 的异常模型主要借鉴了 CLU 的做法。然而，当时其他语言已经支持异常处理了：包括 Ada、Smalltalk（两者都有异常处理，但是都没有异常说明），以及 Modula-3（它既有异常处理也有异常说明）。</p> <p>Liskov 和 Snyder 在他们的一篇讨论该主题的独创性论文中指出，用瞬时风格（transient fashion）报告错误的语言（如 C 中）有一个主要缺陷，那就是：</p> <blockquote><p>“....每次调用的时候都必须执行条件测试，以确定会产生何种结果。这使程序难以阅读并且有可能降低运行效率，因此程序员们既不愿意指出，也不愿意处理异常。”</p></blockquote> <p>因此，异常处理的初衷是要消除这种限制，但是我们又从 Java 的“被检查的异常”中看到了这种代码。他们继续写道：</p> <blockquote><p>“....要求程序员把异常处理程序的代码文本附接到会引发异常的调用上，这会降低程序的可读性，使得程序的正常思路被异常处理给破坏了。”</p></blockquote> <p>C++ 中异常的设计参考了 CLU 方式。Stroustrup 声称其目标是减少恢复错误所需的代码。我想他这话是说给那些通常情况下都不写 C 的错误处理的程序员们听的，因为要把那么多代码放到那么多地方实在不是什么好差事。所以他们写 C 程序的习惯是，忽略所有的错误，然后使用调试器来跟踪错误。这些程序员知道，使用异常就意味着他们要写一些通常不用写的、“多出来的”代码。因此，要把他们拉到“使用错误处理”的正轨上，“多出来的”代码决不能太多。我认为，评价 Java 的“被检查的异常”的时候，这一点是很重要的。</p> <p>C++ 从 CLU 那里还带来另一种思想：异常说明。这样，就可以用编程的方式在方法签名中声明这个方法将会抛出异常。异常说明有两个目的：一个是“我的代码会产生这种异常，这由你来处理”。另一个是“我的代码忽略了这些异常，这由你来处理”。学习异常处理的机制和语法的时候，我们一直在关注“你来处理”部分，但这里特别值得注意的事实是，我们通常都忽略了异常说明所表达的完整含义。</p> <p>C++ 的异常说明不属于函数的类型信息。编译时唯一要检查的是异常说明是不是前后一致；比如，如果函数或方法会抛出某些异常，那么它的重载版本或者派生版本也必须抛出同样的异常。与 Java 不同，C++ 不会在编译时进行检查以确定函数或方法是不是真的抛出异常，或者异常说明是不是完整（也就是说，异常说明有没有精确描述所有可能被抛出的异常）。这样的检查只发生在运行期间。如果抛出的异常与异常说明不符，C++ 会调用标准类库的 unexpected() 函数。</p> <p>值得注意的是，由于使用了模板，C++ 的标准类库实现里根本没有使用异常说明。在 Java 中，对于泛型用于异常说明的方式存在着一些限制。</p> <h3 id="观点"><a href="#观点" class="header-anchor">#</a> 观点</h3> <p>首先，Java 无谓地发明了“被检查的异常”（很明显是受 C++ 异常说明的启发，以及受 C++ 程序员们一般对此无动于衷的事实的影响），但是，这还只是一次尝试，目前为止还没有别的语言采用这种做法。</p> <p>其次，仅从示意性的例子和小程序来看，“被检查的异常”的好处很明显。但是当程序开始变大的时候，就会带来一些微妙的问题。当然，程序不是一下就变大的，这有个过程。如果把不适用于大项目的语言用于小项目，当这些项目不断膨胀时，突然有一天你会发现，原来可以管理的东西，现在已经变得无法管理了。这就是我所说的过多的类型检查，特别是“被检查的异常&quot;所造成的问题。</p> <p>看来程序的规模是个重要因素。由于很多讨论都用小程序来做演示，因此这并不足以说明问题。一名 C# 的设计人员发现：</p> <blockquote><p>“仅从小程序来看，会认为异常说明能增加开发人员的效率，并提高代码的质量；但考察大项目的时候，结论就不同了-开发效率下降了，而代码质量只有微不足道的提高，甚至毫无提高”。</p></blockquote> <p>谈到未被捕获的异常的时候，CLU 的设计师们认为：</p> <blockquote><p>“我们觉得强迫程序员在不知道该采取什么措施的时候提供处理程序，是不现实的。”</p></blockquote> <p>在解释为什么“函数没有异常说明就表示可以抛出任何异常”的时候，Stroustrup 这样认为：</p> <blockquote><p>“但是，这样一来几乎所有的函数都得提供异常说明了，也就都得重新编译，而且还会妨碍它同其他语言的交互。这样会迫使程序员违反异常处理机制的约束，他们会写欺骗程序来掩盖异常。这将给没有注意到这些异常的人造成一种虚假的安全感。”</p></blockquote> <p>我们已经看到这种破坏异常机制的行为了-就在 Java 的“被检查的异常”里。</p> <p>Martin Fowler（UML Distilled，Refactoring 和 Analysis Patterns 的作者）给我写了下面这段话：</p> <blockquote><p>“...总体来说，我觉得异常很不错，但是 Java 的”被检查的异常“带来的麻烦比好处要多。”</p></blockquote> <p>过去，我曾坚定地认为“被检查的异常”和强静态类型检查对开发健壮的程序是非常必要的。但是，我看到的以及我使用一些动态（类型检查）语言的亲身经历告诉我，这些好处实际上是来自于：</p> <ol><li>不在于编译器是否会强制程序员去处理错误，而是要有一致的、使用异常来报告错误的模型。</li> <li>不在于什么时候进行检查，而是一定要有类型检查。也就是说，必须强制程序使用正确的类型，至于这种强制施加于编译时还是运行时，那倒没关系。</li></ol> <p>此外，减少编译时施加的约束能显著提高程序员的编程效率。事实上，反射和泛型就是用来补偿静态类型检查所带来的过多限制，在本书很多例子中都会见到这种情形。</p> <p>我已经听到有人在指责了，他们认为这种言论会令我名誉扫地，会让文明堕落，会导致更高比例的项目失败。他们的信念是应该在编译时指出所有错误，这样才能挽救项目，这种信念可以说是无比坚定的；其实更重要的是要理解编译器的能力限制。在 http://MindView.net/Books/BetterJava 上的补充材料中，我强调了自动构建过程和单元测试的重要性，比起把所有的东西都说成是语法错误，它们的效果可以说是事半功倍。下面这段话是至理名言：</p> <blockquote><p>好的程序设计语言能帮助程序员写出好程序，但无论哪种语言都避免不了程序员用它写出坏程序。</p></blockquote> <p>不管怎么说，要让 Java 把“被检查的异常”从语言中去除，这种可能性看来非常渺茫。对语言来说，这个变化可能太激进了点，况且 Sun 的支持者们也非常强大。Sun 有完全向后兼容的历史和策略，实际上所有 Sun 的软件都能在 Sun 的硬件上运行，无论它们有多么古老。然而，如果发现有些“被检查的异常”挡住了路，尤其是发现你不得不去对付那些不知道该如何处理的异常，还是有些办法的。</p> <h3 id="把异常传递给控制台"><a href="#把异常传递给控制台" class="header-anchor">#</a> 把异常传递给控制台</h3> <p>对于简单的程序，比如本书中的许多例子，最简单而又不用写多少代码就能保护异常信息的方法，就是把它们从 main() 传递到控制台。例如，为了读取信息而打开一个文件（在第 12 章将详细介绍），必须对 FilelnputStream 进行打开和关闭操作，这就可能会产生异常。对于简单的程序，可以像这样做（本书中很多地方采用了这种方法）：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// exceptions/MainException.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainException</span> <span class="token punctuation">{</span>
    <span class="token comment">// Pass exceptions to the console:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// Open the file:</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> lines <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">readAllLines</span><span class="token punctuation">(</span>
                <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;MainException.java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Use the file ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>注意，main() 作为一个方法也可以有异常说明，这里异常的类型是 Exception，它也是所有“被检查的异常”的基类。通过把它传递到控制台，就不必在 main() 里写 try-catch 子句了。（不过，实际的文件输人输出操作比这个例子要复杂得多。你将会在 <a href="/record/java/jdk/Java8/Files.html">文件</a> 和 <a href="/record/java/jdk/Java8/Appendix-IO-Streams.html">附录：I/O 流</a> 章节中学到更多）</p> <h3 id="把-被检查的异常-转换为-不检查的异常"><a href="#把-被检查的异常-转换为-不检查的异常" class="header-anchor">#</a> 把“被检查的异常”转换为“不检查的异常”</h3> <p>在编写你自己使用的简单程序时，从主方法中抛出异常是很方便的，但这不是通用的方法。</p> <p>问题的实质是，当在一个普通方法里调用别的方法时，要考虑到“我不知道该这样处理这个异常，但是也不想把它‘吞’了，或若打印一些无用的消息”。异常链提供了一种新的思路来解决这个问题。
可以直接把“被检查的异常”包装进 RuntimeException 里面：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IDontKnowWhatToDoWithThisCheckedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果想把“被检查的异常”这种功能“屏蔽”掉的话，这看上去像是一个好办法。不用“吞下”异常，也不必把它放到方法的异常说明里面，而异常链还能保证你不会丢失任何原始异常的信息。</p> <p>这种技巧给了你一种选择，可以不写 try-catch 子句和/或异常说明，直接忽略异常，让它自己沿着调用栈往上“冒泡”，同时，还可以用 getCause() 捕获并处理特定的异常，就像这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// &quot;Turning off&quot; Checked exceptions</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">WrapCheckedException</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">throwRuntimeException</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">FileNotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span>
                        <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;Where am I?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">RuntimeException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Adapt to unchecked:</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">SomeOtherException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TurnOffChecking</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WrapCheckedException</span> wce <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">WrapCheckedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// You can call throwRuntimeException() without</span>
        <span class="token comment">// a try block, and let RuntimeExceptions</span>
        <span class="token comment">// leave the method:</span>
        wce<span class="token punctuation">.</span><span class="token function">throwRuntimeException</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Or you can choose to catch exceptions:</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
                    wce<span class="token punctuation">.</span><span class="token function">throwRuntimeException</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SomeOtherException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">SomeOtherException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                        <span class="token string">&quot;SomeOtherException: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> re<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">throw</span> re<span class="token punctuation">.</span><span class="token function">getCause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                            <span class="token string">&quot;FileNotFoundException: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;IOException: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Throwable: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>输出为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>FileNotFoundException: java.io.FileNotFoundException
IOException: java.io.IOException
Throwable: java.lang.RuntimeException: Where am I?
SomeOtherException: SomeOtherException
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>WrapCheckedException.throwRuntimeException() 的代码可以生成不同类型的异常。这些异常被捕获并包装进了 RuntimeException 对象，所以它们成了这些运行时异常的&quot;cause&quot;了。</p> <p>在 TurnOfChecking 里，可以不用 try 块就调用 throwRuntimeException()，因为它没有抛出“被检查的异常”。但是，当你准备好去捕获异常的时候，还是可以用 try 块来捕获任何你想捕获的异常的。应该捕获 try 块肯定会抛出的异常，这里就是 SomeOtherException，RuntimeException 要放到最后去捕获。然后把 getCause() 的结果（也就是被包装的那个原始异常）抛出来。这样就把原先的那个异常给提取出来了，然后就可以用它们自己的 catch 子句进行处理。</p> <p>另一种解决方案是创建自己的 RuntimeException 的子类。在这种方式中，不必捕获它，但是希望得到它的其他代码都可以捕获它。</p> <h2 id="异常指南"><a href="#异常指南" class="header-anchor">#</a> 异常指南</h2> <p>应该在下列情况下使用异常：</p> <ol><li>尽可能使用 try-with-resource。</li> <li>在恰当的级别处理问题。（在知道该如何处理的情况下才捕获异常。）</li> <li>解决问题并且重新调用产生异常的方法。</li> <li>进行少许修补，然后绕过异常发生的地方继续执行。</li> <li>用别的数据进行计算，以代替方法预计会返回的值。</li> <li>把当前运行环境下能做的事情尽量做完，然后把相同的异常重抛到更高层。</li> <li>把当前运行环境下能做的事情尽量做完，然后把不同的异常抛到更高层。</li> <li>终止程序。</li> <li>进行简化。（如果你的异常模式使问题变得太复杂，那用起来会非常痛苦也很烦人。）</li> <li>让类库和程序更安全。（这既是在为调试做短期投资，也是在为程序的健壮性做长期投资。）</li></ol> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <p>异常是 Java 程序设计不可分割的一部分，如果不了解如何使用它们，那你只能完成很有限的工作。正因为如此，本书专门在此介绍了异常——对于许多类库（例如提到过的 I/O 库），如果不处理异常，你就无法使用它们。</p> <p>优点之一就是它使得你可以在某处集中精力处理你要解决的问题，而在另一处处理你编写的这段代码中产生的错误。尽管异常通常被认为是一种工具，使得你可以在运行时报告错误并从错误中恢复，但是我一直怀疑到底有多少时候“恢复”真正得以实现了，或者能够得以实现。我认为这种情况少于 10%，并且即便是这 10%，也只是将栈展开到某个已知的稳定状态，而并没有实际执行任何种类的恢复性行为。无论这是否正确，我一直相信“报告”功能是异常的精髓所在. Java 坚定地强调将所有的错误都以异常形式报告的这一事实，正是它远远超过语如 C++ 这类语言的长处之一，因为在 C++ 这类语言中，需要以大量不同的方式来报告错误，或者根本就没有提供错误报告功能。一致的错误报告系统意味着，你再也不必对所写的每一段代码，都质问自己“错误是否正在成为漏网之鱼？”（只要你没有“吞咽”异常，这是关键所在！）。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/txxs/record/edit/master/docs/java/jdk/Java8/Java异常机制的最佳实践.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022-01-03 03:59:58</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/record/java/jdk/Java8/Java异常之IllegalMonitorStateException.html" class="prev">
        JavaDoc
      </a></span> <span class="next"><a href="/record/java/jdk/Java8/Java日志级别，重复记录、丢日志问题.html">
        1 SLF4J
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/record/assets/js/app.b3b2136c.js" defer></script><script src="/record/assets/js/2.8ec10a4b.js" defer></script><script src="/record/assets/js/652.20ff4afc.js" defer></script><script src="/record/assets/js/5.82344924.js" defer></script>
  </body>
</html>
