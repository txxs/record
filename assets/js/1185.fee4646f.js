(window.webpackJsonp=window.webpackJsonp||[]).push([[1185],{1576:function(t,s,n){"use strict";n.r(s);var a=n(13),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[t._v("为统计记录数，由SELECT返回。假如有如下数据：")]),t._v(" "),n("ul",[n("li",[t._v("所有记录\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/bdc833650ffa00c374d040b6a3645fab.png",alt:""}})]),t._v(" "),n("li",[t._v("统计行的总数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/45f4593176cfd0f35a4214394690d6b7.png",alt:""}})]),t._v(" "),n("li",[t._v("计算 Zara 的记录数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/e04db05f173e28beac8991188a9ecff8.png",alt:""}})])]),t._v(" "),n("p",[t._v("count(1)、count("),n("em",[t._v(") 都是检索表中所有记录行的数目，不论其是否包含null值。\ncount(1)比count(")]),t._v(")效率高。")]),t._v(" "),n("p",[t._v("count(字段)是检索表中的该字段的"),n("strong",[t._v("非空")]),t._v("行数，不统计这个字段值为null的记录。")]),t._v(" "),n("p",[t._v("任何情况下最优选择")]),t._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" tablename\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("尽量减少类似：")]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" FROM tablename "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WHERE")]),t._v(" COL "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),t._v(" \n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("杜绝：")]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("COL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" FROM tablename "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WHERE")]),t._v(" COL2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),t._v(" \n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("如果表没有主键，那么count（1）比count（"),n("em",[t._v("）快\n如果有主键，那么count（主键，联合主键）比count（")]),t._v("）快\n如果表只有一个字段，count（*）最快")]),t._v(" "),n("p",[t._v("count(1)跟count(主键)一样，只扫描主键。\ncount(*)跟count(非主键)一样，扫描整个表\n明显前者更快一些。")]),t._v(" "),n("h1",{attrs:{id:"执行效果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#执行效果"}},[t._v("#")]),t._v(" 执行效果")]),t._v(" "),n("h2",{attrs:{id:"count-1-v-s-count"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#count-1-v-s-count"}},[t._v("#")]),t._v(" count(1) V.S count(*)")]),t._v(" "),n("p",[t._v("当表的数据量大些时，对表作分析之后，使用count(1)还要比使用count(*)用时多！")]),t._v(" "),n("p",[t._v("从执行计划来看，count(1)和count("),n("em",[t._v(")的效果是一样的。 但是在表做过分析之后，count(1)会比count(")]),t._v(")的用时少些（1w以内数据量），不过差不了多少。")]),t._v(" "),n("p",[t._v("如果count(1)是聚索引,id,那肯定是count(1)快。但是差的很小的。\n因为count("),n("em",[t._v(") 会自动优化指定到那一个字段。所以没必要去count(1)，用count(")]),t._v(")，sql会帮你完成优化的 因此：count(1)和count(*)基本没有差别！")]),t._v(" "),n("h2",{attrs:{id:"count-1-and-count-字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#count-1-and-count-字段"}},[t._v("#")]),t._v(" count(1) and count(字段)")]),t._v(" "),n("ul",[n("li",[t._v("count(1) 会统计表中的所有的记录数，包含字段为null 的记录")]),t._v(" "),n("li",[t._v("count(字段) 会统计该字段在表中出现的次数，忽略字段为null 的情况。即不统计字段为null 的记录。")])]),t._v(" "),n("h2",{attrs:{id:"count-和-count-1-和count-列名-区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#count-和-count-1-和count-列名-区别"}},[t._v("#")]),t._v(" count(*) 和 count(1)和count(列名)区别")]),t._v(" "),n("p",[t._v("执行效果上："),n("br"),t._v("\ncount(*)包括了所有的列，相当于行数，在统计结果的时候，不会忽略列值为NULL"),n("br"),t._v("\ncount(1)包括了忽略所有列，用1代表代码行，在统计结果的时候，不会忽略列值为NULL"),n("br"),t._v("\ncount(列名)只包括列名那一列，在统计结果的时候，会忽略列值为空（这里的空不是只空字符串或者0，而是表示null）的计数，即某个字段值为NULL时，不统计。")]),t._v(" "),n("h1",{attrs:{id:"执行效率"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#执行效率"}},[t._v("#")]),t._v(" 执行效率")]),t._v(" "),n("p",[t._v("列名为主键，count(列名)会比count(1)快"),n("br"),t._v("\n列名不为主键，count(1)会比count(列名)快"),n("br"),t._v("\n如果表多个列并且没有主键，则 count（1） 的执行效率优于 count（"),n("em",[t._v("）"),n("br"),t._v("\n如果有主键，则 select count（主键）的执行效率是最优的"),n("br"),t._v("\n如果表只有一个字段，则 select count（")]),t._v("）最优。")]),t._v(" "),n("h1",{attrs:{id:"实例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/bb6fd75177d9428abfaa837ef5879604.png",alt:""}}),t._v(" "),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/fda1c0fe3b09444a80c138d1806bea59.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" counttest\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/9f7da59b31ad4ae78c41efcbfaf303c7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),n("p",[t._v("MyISAM有表元数据的缓存，例如行，即COUNT("),n("em",[t._v(")值，对于MyISAM表的COUNT(")]),t._v(")无需消耗太多资源，但对于Innodb，就没有这种元数据，CONUT（*）执行较慢。")])])}),[],!1,null,null,null);s.default=e.exports}}]);