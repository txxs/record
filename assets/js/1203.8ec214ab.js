(window.webpackJsonp=window.webpackJsonp||[]).push([[1203],{1596:function(t,s,a){"use strict";a.r(s);var _=a(13),r=Object(_.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("全是干货的技术号：\n本文已收录在github，欢迎 star/fork：\nhttps://github.com/Wasabi1234/Java-Interview-Tutorial")])]),t._v(" "),a("h1",{attrs:{id:"_1-第一范式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-第一范式"}},[t._v("#")]),t._v(" 1 第一范式")]),t._v(" "),a("p",[t._v("该范式是为了排除 重复组 的出现，因此要求数据库的每个列的值域都由原子值组成；每个字段的值都只能是单一值。1971年埃德加·科德提出了第一范式。即表中所有字段都是不可再分的。")]),t._v(" "),a("h2",{attrs:{id:"_1-1-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-实例"}},[t._v("#")]),t._v(" 1.1 实例")]),t._v(" "),a("p",[t._v("重复组通常会出现在会计账上，每一笔记录可能有不定个数的值。")]),t._v(" "),a("ul",[a("li",[t._v("举例来说：\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200823233919133.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70#pic_center",alt:""}})])]),t._v(" "),a("blockquote",[a("p",[t._v("“数量”就是所谓的重复组了，而在这种情况下这份资料就不符合第一范式。")])]),t._v(" "),a("ul",[a("li",[t._v("再比如，如下联系方式是一个复合属性，就违反了该范式，在数据库中是无法分离出来的。\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623130240462.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),a("h2",{attrs:{id:"_1-2-解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-解决方案"}},[t._v("#")]),t._v(" 1.2 解决方案")]),t._v(" "),a("ul",[a("li",[t._v("想要消除重复组的话，只要把每笔记录都转化为单一记录即可：\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200823233954666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70#pic_center",alt:""}})]),t._v(" "),a("li",[t._v("简单改动即可\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623130520502.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),a("p",[t._v("即标准的二维表结构。")]),t._v(" "),a("h1",{attrs:{id:"_2-第二范式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-第二范式"}},[t._v("#")]),t._v(" 2 第二范式")]),t._v(" "),a("blockquote",[a("p",[t._v("前提：标准的二维表，即第一范式成立")])]),t._v(" "),a("p",[t._v("表中必须存在业务主键，并且非主键依赖于"),a("code",[t._v("全部")]),t._v("业务主键。")]),t._v(" "),a("h2",{attrs:{id:"_2-1-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-实例"}},[t._v("#")]),t._v(" 2.1 实例")]),t._v(" "),a("p",[t._v("如下博客表\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623215600583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("ul",[a("li",[a("p",[t._v("用户字段作为PK是否可行?\n一个用户会对应多个博客记录，且章节标题也能为多个用户所编辑，所以单列字段PK失效")])]),t._v(" "),a("li",[a("p",[t._v("<用户,章节,标题>的联合PK\n用户积分字段只和用户字段依赖，并不依赖整体的PK，依旧不符第二范式")])])]),t._v(" "),a("h2",{attrs:{id:"_2-2-解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-解决方案"}},[t._v("#")]),t._v(" 2.2 解决方案")]),t._v(" "),a("p",[a("code",[t._v("拆分将依赖的字段单独成表")]),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623225502387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70",alt:""}}),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623225600676.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("p",[t._v("从上面可发现:")]),t._v(" "),a("ul",[a("li",[t._v("若表的PK只有一个字段，那么它本就符合第二范式")]),t._v(" "),a("li",[t._v("若是多个字段组成，则需考虑是否符合第二范式")])]),t._v(" "),a("h1",{attrs:{id:"_3-第三范式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-第三范式"}},[t._v("#")]),t._v(" 3 第三范式")]),t._v(" "),a("p",[a("code",[t._v("表中的非主键列之间不能相互依赖")])]),t._v(" "),a("h2",{attrs:{id:"_3-1-实例-课程表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-实例-课程表"}},[t._v("#")]),t._v(" 3.1 实例 - 课程表")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623230022400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("p",[t._v("一个字段的PK显然符合第二范式，大部分字段也只依赖PK。然而对于职位字段其实依赖讲师名，所以不符合第三范式。")]),t._v(" "),a("h2",{attrs:{id:"_3-2-解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-解决方案"}},[t._v("#")]),t._v(" 3.2 解决方案")]),t._v(" "),a("ul",[a("li",[t._v("将不与PK形成依赖关系的字段直接提出单独成表即可：\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623231040782.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}}),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190623232055504.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),a("h1",{attrs:{id:"_4-三范式评价"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-三范式评价"}},[t._v("#")]),t._v(" 4 三范式评价")]),t._v(" "),a("h2",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),a("ul",[a("li",[t._v("范式化的更新通常比反范式快")]),t._v(" "),a("li",[t._v("当数据较好的范式化后，很少或者没有冗余数据")]),t._v(" "),a("li",[t._v("范式化的数据比较小，放在内存中操作较快")])]),t._v(" "),a("h2",{attrs:{id:"缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),a("ul",[a("li",[t._v("通常需要进行关联\n毕竟阿里规范提到\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200825025806918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70#pic_center",alt:""}})])]),t._v(" "),a("h1",{attrs:{id:"_5-反范式-空间换时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-反范式-空间换时间"}},[t._v("#")]),t._v(" 5 反范式（空间换时间）")]),t._v(" "),a("p",[t._v("反范式的过程就是通过冗余数据来提高查询性能，但冗余数据会牺牲数据一致性")]),t._v(" "),a("h2",{attrs:{id:"优点-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点-2"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),a("ul",[a("li",[t._v("所有的数据都在同一张表中，可以减少表关联")]),t._v(" "),a("li",[t._v("更好进行索引优化")])]),t._v(" "),a("h2",{attrs:{id:"缺点-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缺点-2"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),a("ul",[a("li",[t._v("存在大量冗余数据")]),t._v(" "),a("li",[t._v("数据维护成本更高（删除异常，插入异常，更新异常）")])]),t._v(" "),a("p",[t._v("在企业中很好能做到严格意义上的范式成者反范式，一般需混合使用。")]),t._v(" "),a("h1",{attrs:{id:"_6-综合案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-综合案例"}},[t._v("#")]),t._v(" 6 综合案例")]),t._v(" "),a("ol",[a("li",[t._v("在一个网站实例中， 这个网站允许用户发送消息，井且一些用户是付费用户。现在想查看付费用户最近的10条信息。在user表 和message表中都存储用户类型(account type)，而不用完全的反范式化。这避免了完全反范式化的插入和删除问题，因为即使没有消息的时候也不会丢失用户信息。这样也不会把user_message表搞得太大，有助高效获取数据")]),t._v(" "),a("li",[t._v("另一个从父表冗余些数据到子表的理由是排序的需要")]),t._v(" "),a("li",[t._v("缓存衍生值也是有用的。如果需要显示每个用户发了多少消息(类似论坛)，可以每次执行一个昂贵的子查询来计算并显示它；也可以在user表中建个num_messages列，每当用户发新消息时更新这个值。")])]),t._v(" "),a("h2",{attrs:{id:"范式设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#范式设计"}},[t._v("#")]),t._v(" 范式设计")]),t._v(" "),a("ul",[a("li",[t._v("用户表\n用户ID、姓名、电话、地址、邮箱")]),t._v(" "),a("li",[t._v("订单表\n订单ID、用户ID、下单时间、支付类型、订单状态")]),t._v(" "),a("li",[t._v("订单商品表\n订单ID、商品 ID、商品价格")]),t._v(" "),a("li",[t._v("商品表\n商品ID、名称、描述、过期时间")])]),t._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("用户名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("电话"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("地址"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SUM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("商品价价"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("C"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("商品数量"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" 订单价格\n\t   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 上面这就需要三张表的关联了,可能效率就很低了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("‘订单表"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" a\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("‘用户表’b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" a用户ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("用户ID\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("订单商品表"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" C "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单ID\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("用户名，b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("电话b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("地址"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单ID\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h2",{attrs:{id:"反范式设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反范式设计"}},[t._v("#")]),t._v(" 反范式设计")]),t._v(" "),a("ul",[a("li",[t._v("用户表\n用户ID、姓名、电话、地址、邮箱")]),t._v(" "),a("li",[t._v("订单表\n订单ID、用户ID、下单时间、支付类型、订单状态、订单价格、用户名、电话、地址")]),t._v(" "),a("li",[t._v("订单商品表\n订单ID、商品 ID、商品数量、商品价格")]),t._v(" "),a("li",[t._v("商品表\n商品ID、名称、描述、过期时间")])]),t._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("用户名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("电话"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("地址\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单ID\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("订单价格\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("订单表"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" a\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("把用户表的地址加到了订单表，这样查询地址时，就不需要把用户表和订单表关联")]),t._v(" "),a("p",[t._v("参考")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E7%AC%AC%E4%B8%80%E6%AD%A3%E8%A6%8F%E5%8C%96",target:"_blank",rel:"noopener noreferrer"}},[t._v("第一范式"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200729215420194.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SmF2YUVkZ2U=,size_1,color_FFFFFF,t_70",alt:""}})])])}),[],!1,null,null,null);s.default=r.exports}}]);