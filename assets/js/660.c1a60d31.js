(window.webpackJsonp=window.webpackJsonp||[]).push([[660],{1051:function(t,e,s){"use strict";s.r(e);var a=s(13),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703161507167.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("子类重写父类方法后，可以继承方法上的注解吗？")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703161525416.png",alt:""}}),t._v("\n这个不急，让我来分析一下，假设有如下注解：\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703172456417.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("定义被注解的类\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/2021070316221838.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("子类直接继承父类\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703162259213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("获取父子类和方法的注解信息，并输出注解的value属性的值\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703164459591.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("日志输出\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703172622900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})])])]),t._v(" "),s("p",[t._v("可见"),s("strong",[t._v("子类及子类的方法，无法自动继承父类和父类方法上的注解")]),t._v("。")]),t._v(" "),s("p",[t._v("不对呀，你得使用"),s("code",[t._v("@Inherited")]),t._v("元注解才能实现注解的继承！行，那咱就加上"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703173231671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("再看一遍控制台信息\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210703173317381.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}}),t._v("\n可见使用"),s("code",[t._v("@Inherited")]),t._v("只能实现类上的注解继承。")])]),t._v(" "),s("blockquote",[s("p",[t._v("那么如何实现方法上注解的继承呢？")])]),t._v(" "),s("p",[t._v("最简单暴力地，可通过反射技术，在继承链找到对应方法上的注解。但这样很麻烦，还需要考虑桥接方法。幸好Spring足够强大，提供了"),s("strong",[t._v("AnnotatedElementUtils")]),t._v("类。")]),t._v(" "),s("h3",{attrs:{id:"对-inherited的支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对-inherited的支持"}},[t._v("#")]),t._v(" 对"),s("code",[t._v("@Inherited")]),t._v("的支持")]),t._v(" "),s("p",[t._v("遵循get语义的方法将遵循Java的"),s("code",[t._v("@Inherited")]),t._v("注解的约定，除了在本地声明的批注（包括自定义组成的注解）优于继承的注解之外。相反，遵循find语义的方法将完全忽略"),s("code",[t._v("@Inherited")]),t._v("的存在，因为find搜索算法手动遍历类型和方法层次结构，从而隐式支持注解继承，而无需"),s("code",[t._v("@Inherited")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"find-v-s-get-semantics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#find-v-s-get-semantics"}},[t._v("#")]),t._v(" Find V.S Get Semantics")]),t._v(" "),s("p",[t._v("此类中的方法使用的搜索算法遵循find或get语义。")]),t._v(" "),s("h4",{attrs:{id:"get-语义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-语义"}},[t._v("#")]),t._v(" Get 语义")]),t._v(" "),s("p",[t._v("仅限于搜索存在于"),s("code",[t._v("AnnotatedElement")]),t._v("上的注解（即在本地声明或继承）或在AnnotatedElement上方的注解层次结构中声明的注释。")]),t._v(" "),s("h4",{attrs:{id:"find-语义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#find-语义"}},[t._v("#")]),t._v(" Find 语义")]),t._v(" "),s("p",[t._v("更加详尽，提供了获取语义以及对以下内容的支持：")]),t._v(" "),s("ul",[s("li",[t._v("搜索接口（如果带注释的元素是类）")]),t._v(" "),s("li",[t._v("搜索超类（如果带注释的元素是一个类）")]),t._v(" "),s("li",[t._v("解析桥接方法（如果带注释的元素是方法）")]),t._v(" "),s("li",[t._v("如果带注解的元素是方法，则在接口中搜索方法")]),t._v(" "),s("li",[t._v("如果带注解的元素是方法，则在超类中搜索方法")])]),t._v(" "),s("p",[t._v("如下俩方法其实也很相像，有何区别呢？")]),t._v(" "),s("h5",{attrs:{id:"findallmergedannotations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#findallmergedannotations"}},[t._v("#")]),t._v(" findAllMergedAnnotations")]),t._v(" "),s("p",[t._v("Find 对应 "),s("code",[t._v("SearchStrategy.TYPE_HIERARCHY")]),t._v(" "),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201120223339913.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70#pic_center",alt:""}}),t._v(" "),s("strong",[t._v("findMergedAnnotation")]),t._v("方法可一次性找出父类和接口、父类方法和接口方法上的注解\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/2021070317413821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),s("h5",{attrs:{id:"getallmergedannotations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getallmergedannotations"}},[t._v("#")]),t._v(" getAllMergedAnnotations")]),t._v(" "),s("p",[t._v("Get对应 "),s("code",[t._v("SearchStrategy.INHERITED_ANNOTATIONS")]),t._v("：\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201120223435146.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNTg5NTEw,size_1,color_FFFFFF,t_70#pic_center",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("想想 Spring 的@Service、@Controller 等注解支持继承吗？")])]),t._v(" "),s("p",[t._v("我们通常的controller类，都会使用controller注解，如果可以被继承的话，Spring就不会只让我们使用Controller注解了，会提供另一种方式注入Controller组件，就是继承BaseController类。\nSpring 官方对此也有回应：继承的问题在于那些注解真的应该应用于特定的具体类。")]),t._v(" "),s("blockquote",[s("p",[t._v("参考")]),t._v(" "),s("ul",[s("li",[t._v("https://github.com/spring-projects/spring-framework/issues/8859")]),t._v(" "),s("li",[t._v("https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Inherited.html\nhttps://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/annotation/AnnotatedElementUtils.html\nhttps://docs.oracle.com/javase/8/docs/api/java/lang/Class.html")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);