{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{580:function(s,a,e){\"use strict\";e.r(a);var n=e(13),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"_183-商品详情页动态渲染系统-通过-jenkins-docker-部署-eureka-服务\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_183-商品详情页动态渲染系统-通过-jenkins-docker-部署-eureka-服务\"}},[s._v(\"#\")]),s._v(\" 183. 商品详情页动态渲染系统：通过 jenkins+docker 部署 eureka 服务\")]),s._v(\" \"),e(\"ol\",[e(\"li\",[e(\"p\",[s._v(\"开始创建一个新任务。\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[s._v(\"任务信息\")])])]),s._v(\" \"),e(\"ul\",[e(\"li\",[s._v(\"任务名称：eshop-eureka-server\")]),s._v(\" \"),e(\"li\",[s._v(\"选择：构建一个自由风格的软件项目\")])]),s._v(\" \"),e(\"ol\",{attrs:{start:\"3\"}},[e(\"li\",[s._v(\"General -> 源码管理\")])]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"assets/markdown-img-paste-20190923221253134.png\",alt:\"\"}}),s._v(\" \"),e(\"img\",{attrs:{src:\"assets/markdown-img-paste-20190923221446197.png\",alt:\"\"}}),s._v(\"\\n4. 添加构建步骤\")]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"assets/markdown-img-paste-20190923230045106.png\",alt:\"\"}})]),s._v(\" \"),e(\"p\",[s._v(\"说明，由于我们这里的仓库只有一个，所以需要手动进入到服务注册中心这个目录，来构建。\\n就无法使用 jenkins 自带的，gradle 或者 maven 来构建了。\")]),s._v(\" \"),e(\"ul\",[e(\"li\",[s._v(\"pwd: 显示当前在那个目录下，可以看到当前目录在 \"),e(\"code\",[s._v(\"/var/lib/jenkins/workspace/eshop-eureka-server\")]),s._v(\" 下，注意这里的 eshop-eureka-server 是任务名称。而这个目录下就是我们的 git 源代码了。\")]),s._v(\" \"),e(\"li\",[e(\"code\",[s._v(\"echo $PATH\")]),s._v(\"：显示当前的环境变量，当遇到执行系统中的某些命令提示 command not found 时，对比本机上的环境变量信息（后面有解决方案）\")])]),s._v(\" \"),e(\"p\",[s._v(\"上面是尝试和解决 command not found 的测试，下面是 gradle build 构建步骤的完整 shell 脚本\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token shebang important\"}},[s._v(\"#!/bin/bash\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" eshop-eureka-server\\ngradle build\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\")])]),e(\"p\",[s._v(\"保存之后，可以点击立即构建，\")]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"assets/markdown-img-paste-20190923231738574.png\",alt:\"\"}})]),s._v(\" \"),e(\"p\",[s._v(\"构建成功之后，会在 \"),e(\"code\",[s._v(\"/var/lib/jenkins/workspace/eshop-eureka-server/eshop-eureka-server/build/libs\")]),s._v(\" 中生成 eshop-eureka-server-1.0.0.jar 包。构建成功\")]),s._v(\" \"),e(\"ol\",{attrs:{start:\"5\"}},[e(\"li\",[s._v(\"给项目添加 DockerFile\")])]),s._v(\" \"),e(\"p\",[s._v(\"在 \"),e(\"code\",[s._v(\"H:\\\\dev\\\\project\\\\mrcode\\\\cache-eshop\\\\eshop-eureka-server\")]),s._v(\" 也就是服务注册中心的项目根目录下添加一个名为 Dockerfile 的文件，\\n内容如下，有关 docker 的使用这里没有深入讲解，\"),e(\"a\",{attrs:{href:\"https://github.com/zq99299/essay-note/blob/master/chapter/container/index.md\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"可以参考这个入门教程 \"),e(\"OutboundLink\")],1),s._v(\" 和这个\"),e(\"a\",{attrs:{href:\"https://github.com/zq99299/essay-note/blob/master/chapter/imooc/spring_cloud/container_deployment/first.md\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"第一个 docker jar\"),e(\"OutboundLink\")],1)]),s._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v('# 从这个地址获取一个 doker 镜像\\nFROM frolvlad/alpine-oraclejdk8:slim\\nVOLUME /tmp\\n# 使用 gradle build 打包好那个 jar\\nADD build/libs/eshop-eureka-server-1.0.0.jar app.jar\\n#RUN bash -c \\'touch /app.jar\\'\\n\\n# 运行这个 jar 包\\nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/app.jar\"]\\n\\n# 暴露端口\\nEXPOSE 8761\\n')])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),e(\"br\")])]),e(\"ol\",{attrs:{start:\"6\"}},[e(\"li\",[s._v(\"添加构建步骤 - docker\")])]),s._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token shebang important\"}},[s._v(\"#!/bin/bash\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# doker 地址\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"REGISTRY_URL\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".99.20:2375\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 选择一个目录进行打包，这里写 /var/lib/jenkins 是为了简化 linux 权限相关，执行命令是用 jenkins 用户执行的\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 所以这里直接写在 jenkins 目录下，跳过了目录权限等问题\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"WORK_DIR\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/var/lib/jenkins/work_build\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"PROJECT_NAME\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"eshop-eureka-server\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"PROJECT_VERSION\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1.0\")]),s._v(\".0\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 如果这个目录不存在则创建它\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\" -e \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\" -d \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"mkdir\")]),s._v(\" -p \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"Create Dir: '),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v('\"')]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 如果 Dockerfile 这个文件存在，则删除它\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" -e \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"/Dockerfile \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" -rf \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"/Dockerfile\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"Remove File: '),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v('/Dockerfile\"')]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 把项目中的 Dockerfile 与 打好包的 boot jar 包 复制到目录下\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"cp\")]),s._v(\" /var/lib/jenkins/workspace/eshop-eureka-server/eshop-eureka-server/Dockerfile \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"/\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"cp\")]),s._v(\" /var/lib/jenkins/workspace/eshop-eureka-server/eshop-eureka-server/build/libs/*.jar \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"/\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${WORK_DIR}\")]),s._v(\"/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"/\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# docker 构建\")]),s._v(\"\\ndocker build -t \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${REGISTRY_URL}\")]),s._v(\"/eshop-detail/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_VERSION}\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 仓库 192.168.99.20:2375/eshop-detail/eshop-eureka-server\")]),s._v(\"\\ndocker push \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${REGISTRY_URL}\")]),s._v(\"/eshop-detail/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_VERSION}\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 查看是否有这个服务运行\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# docker ps -a | grep eshop-eureka-server\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" docker \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\" -a \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"grep\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 移除正在运行的镜像\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# docker rm -f eshop-eureka-server\")]),s._v(\"\\ndocker \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rm\")]),s._v(\" -f \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"Remove Docker Container: '),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v('\"')]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 使用 docker 运行镜像\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 在运行时可能报错端口等问题，可参考后面的 重置 docker 网络 解决\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 把 docker 中的 8761 与宿主机的 8761 相关联，\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 运行 192.168.99.20:2375/eshop-detail/eshop-eureka-server:1.0.0 并取名 eshop-eureka-server\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# docker run -d -p 8761:8761 --name eshop-eureka-server 192.168.99.20:2375/eshop-detail/eshop-eureka-server:1.0.0\")]),s._v(\"\\ndocker run -d -p \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"8761\")]),s._v(\":8761 --name \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${REGISTRY_URL}\")]),s._v(\"/eshop-detail/\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_NAME}\")]),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${PROJECT_VERSION}\")]),s._v(\"\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),e(\"br\")])]),e(\"p\",[s._v(\"添加好之后，就可以尝试立即构建了，构建成功之后可以访问：http://192.168.99.20:8761/ 看到注册中心界面\")]),s._v(\" \"),e(\"p\",[s._v(\"后面的是这个实验过程中的各种错误解决。\")]),s._v(\" \"),e(\"h2\",{attrs:{id:\"jenkins-shell-command-not-found\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jenkins-shell-command-not-found\"}},[s._v(\"#\")]),s._v(\" jenkins shell command not found\")]),s._v(\" \"),e(\"p\",[s._v(\"在 jenkins 中执行 shell 脚本提示 command not found，比如上面我们用到了 gradle，\\n居然报错：gradle command not found；\")]),s._v(\" \"),e(\"p\",[s._v(\"解决方案：\")]),s._v(\" \"),e(\"p\",[s._v(\"在终端上查看当前 path 信息\")]),s._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v(\"[root@localhost eshop-eureka-server]# echo $PATH\\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin:/usr/local/gradle/gradle-4.8.1/bin\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\")])]),e(\"p\",[s._v(\"覆盖 jenkins 中的 path 变量：jenkins -> 系统管理 -> 系统设置\")]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"assets/markdown-img-paste-20190923230940699.png\",alt:\"\"}})]),s._v(\" \"),e(\"p\",[s._v(\"如上图，使用终端上的 path 信息覆盖之后，就可以正常使用了\")]),s._v(\" \"),e(\"h2\",{attrs:{id:\"dial-unix-var-run-docker-sock-connect-permission-denied\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#dial-unix-var-run-docker-sock-connect-permission-denied\"}},[s._v(\"#\")]),s._v(\" dial unix /var/run/docker.sock: connect: permission denied\")]),s._v(\" \"),e(\"p\",[s._v(\"使用 jenkins 中执行 shell 出现权限不足的提示，这里还是让 jenkins 用 root 身份执行执行把，\\n不然要修改的脚本太多了。\")]),s._v(\" \"),e(\"p\",[s._v(\"让 jenkins 使用 root 身份执行设置如下：\")]),s._v(\" \"),e(\"h2\",{attrs:{id:\"让-jenkins-使用-root-用户\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#让-jenkins-使用-root-用户\"}},[s._v(\"#\")]),s._v(\" 让 jenkins 使用 root 用户\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v('# 将配置中的 JENKINS_USER=\"jenkins\" 修改为 root')]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vi\")]),s._v(\" /etc/sysconfig/jenkins\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 并将相关几个目录修改为 root 所有\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chown\")]),s._v(\" -R root:root /var/lib/jenkins\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chown\")]),s._v(\" -R root:root /var/cache/jenkins\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chown\")]),s._v(\" -R root:root /var/log/jenkins\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 重启Jenkins（若是其他方式安装的jenkins则重启方式略不同）\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" jenkins restart\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 查看Jenkins进程所属用户\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 若显示为 root 用户，则表示修改完成\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\" -ef \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"|\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"grep\")]),s._v(\" jenkins\\n\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),e(\"br\")])]),e(\"h2\",{attrs:{id:\"docker-run-报错-docker0-重置-docker-网络\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-run-报错-docker0-重置-docker-网络\"}},[s._v(\"#\")]),s._v(\" docker run 报错 docker0，重置 docker 网络\")]),s._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v(\"[root@localhost eshop-eureka-server]# docker ps -a | grep eshop-eureka-server\\n[root@localhost eshop-eureka-server]# docker run -d -p 8761:8761 --name eshop-eureka-server  192.168.99.20:2375/eshop-detail/eshop-eureka-server:1.0.0\\n0fbb1b660dede294593a540bb6c5d64ea55517572e5f6fa49deeae4077f65238\\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint eshop-eureka-server (4f4111c8f21f1d4c29c14aeb4e5775b065e9e955819861f2a34ef23652ea6238):  (iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 8761 -j DNAT --to-destination 172.17.0.2:8761 ! -i docker0: iptables: No chain/target/match by that name.\\n (exit status 1)).\\n\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\")])]),e(\"p\",[s._v(\"重置 docker 网络\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"pkill\")]),s._v(\" docker\\niptables -t nat -F\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# yum install net-tools  安装后可用 ifconfig 命令\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ifconfig\")]),s._v(\" docker0 down\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# yum install bridge-utils 安装后可用 brctl\")]),s._v(\"\\nbrctl delbr docker0\\ndocker -d\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" docker restart\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),e(\"br\")])])])}),[],!1,null,null,null);a.default=t.exports}}]);","extractedComments":[]}